/* first few virial coefficients of the 3D hard spheres system
 * by direct Monte Carlo integration of Ree-Hoover diagrams
 * Copyright (C) 2013 Cheng Zhang */
/* #define `D' here to simulate dimensions other than D = 3 */
#define ZCOM_PICK
#define ZCOM_UTIL
#define ZCOM_RVN
#include "zcom.h"



/* third-order virial coefficients */
double vir3(long nsteps)
{
  long t, acc = 0;
  rvn_t v, u;
  double x;

  for (t = 1; t <= nsteps; t++) {
    rvn_rndball0(u);
    rvn_inc(u, rvn_rndball0(v));
    if (rvn_sqr(u) < 1) acc++;
  }
  x = -2 * (-acc/6.) / nsteps;
  printf("vir3: %.8f, %.7f, %.9f, acc %g\n",
      x, x * pow(2, 2), x * pow(8, 2), 1. * acc / nsteps);
  return x;
}



/* fourth-order virial coefficients */
double vir4(long nsteps)
{
  long t, acc44 = 0, acc46 = 0;
  int i, lnk02, lnk13;
  rvn_t u, v[4];
  double x;

  for (t = 1; t <= nsteps; t++) {
    rvn_zero(v[0]);
    for (i = 0; i < 3; i++)
      rvn_add(v[i+1], v[i], rvn_rndball0(u));
    if (rvn_sqr(v[3]) < 1) {
      lnk02 = ( rvn_sqr(v[2]) < 1 );
      lnk13 = ( rvn_dist2(v[1], v[3]) < 1 );
      if (lnk02 && lnk13) acc46++;
      else if (!lnk02 && !lnk13) acc44++;
    }
  }
  printf("acc44 %g, acc46 %g\n", 1.*acc44/nsteps, 1.*acc46/nsteps);
  x = -3./24 * (3 * acc44 - 2 * acc46) / nsteps;
  printf("vir4: %.8f, %.7f, %.9f\n", x, x * pow(2, 3), x * pow(8, 3));
  return x;
}



/* fifth-order virial coefficients */
double vir5(long nsteps)
{
  rvn_t u, v[5];
  double x, y, tot, norm1, norm2;
  long t, acc[6] = {0}; /* acc[5] is reserved for invalid diagrams */
  int sc[5] = {-6, 3, -2, 1, 1}, degen[5] = {1, 15, -30, 10, -12};
  int i, mul[5], dup[5] = {1, 6, 7, 1, 1}, map[64];
  char *names[5] = {"A5_10", "A5_8", "A5_7", "A5_6", "A5_5"};
  unsigned code;

  for (i = 0; i < 5; i++)
    mul[i] = sc[i] * degen[i];

  for (i = 0; i < 64; i++)
    map[i] = 5; /* `5' means invalid or un-biconnected diagrams */
  map[0x3f] = 0; /* fully connected */
  map[0x01] = 4; /* ring 0-4 */
  map[0x14] = 3; /* house 0-3, 1-4 */

  /* one wiggly line (L), one wiggly angle (A) */
  /* edge: ij (hex): 04(1) 02(2) 03(4) 13(8) 14(10) 24(20) */
  map[0x25] = 2; /*     #     L     #     A     A      #   */
  map[0x0b] = 2; /*     #     #     L     #     A      A   */
  map[0x15] = 2; /*     #     A     #     L     #      A   */
  map[0x34] = 2; /*     A     A     #     L     #      #   */
  map[0x16] = 2; /*     A     #     #     L     #      A   */
  map[0x29] = 2; /*     #     A     A     #     L      #   */
  map[0x13] = 2; /*     #     #     A     A     #      L   */

  /* two parallel wiggly lines */
  /* edge: ij (hex): 04(1) 02(2) 03(4) 13(8) 14(10) 24(20) */
  map[0x36] = 1; /*           #     #           #      #   */
  map[0x35] = 1; /*     #           #           #      #   */
  map[0x2d] = 1; /*     #           #     #            #   */
  map[0x2b] = 1; /*     #     #           #            #   */
  map[0x1b] = 1; /*     #     #           #     #          */
  map[0x17] = 1; /*     #     #     #           #          */

  rvn_zero(v[0]);
  for (t = 1; t <= nsteps; t++) {
    rvn_add(v[1], v[0], rvn_rndball0(u));
    rvn_add(v[2], v[1], rvn_rndball0(u));
    rvn_add(v[3], v[2], rvn_rndball0(u));
    rvn_add(v[4], v[3], rvn_rndball0(u));

#define CNT(i, j) (rvn_dist2(v[i], v[j]) < 1)
    code = CNT(0, 4)       | (CNT(0, 2) << 1) | (CNT(0, 3) << 2)
        | (CNT(1, 3) << 3) | (CNT(1, 4) << 4) | (CNT(2, 4) << 5);

    acc[ map[code] ]++;
  }

  norm1 = -4./120 * pow(2, 4);
  norm2 = -4./120 * pow(8, 4);
  for (tot = 0, i = 0; i < 5; i++) {
    x = 1. * acc[i] / nsteps / dup[i];
    tot += y = x * mul[i];

    printf("%2d %-5s acc %9.7f dup %d sc %+2d mul %+3d "
        "x*mul %10.7f (%9.6f,%10.5f) tot %10.7f (%9.6f,%10.5f)\n",
        i, names[i], x, dup[i], sc[i], mul[i], y, norm1 * y, norm2 * y,
        tot, norm1 * tot, norm2 * tot);
  }
  tot *= -4./120;
  printf("vir5: %.8f, %.7f, %.6f\n", tot, tot * pow(2, 4), tot * pow(8, 4));
  return tot;
}



typedef struct {
  int dgid; /* diagram id */
  int npr; /* number of edges */
  int id[16][2]; /* edges */
} draw_t;



/* add diagrams specified by wiggly lines */
static void draw_addwiggly(draw_t *d, int n, int *map, int *dup)
{
  int npr = n * (n - 1) / 2, k, l, ipr;
  unsigned lnk;

  for (l = 0; (k = d[l].dgid) >= 0; l++) {
    lnk = (1u << npr) - 1;
    for (ipr = 0; ipr < d[l].npr; ipr++) {
      if (d[l].id[ipr][0] == 0 && d[l].id[ipr][1] == 0) {
        printf("k %d, l %d, ipr %d\n", k, l, ipr);
        for (ipr = 0; ipr < d[l].npr; ipr++)
          printf("(%d, %d) ", d[l].id[ipr][0], d[l].id[ipr][1]);
        exit(1);
      }
      lnk &= ~(1u << getpairindex(d[l].id[ipr][0], d[l].id[ipr][1], 6));
    }
    if (map[lnk] >= 0) {
      printf("addwiggly error: list item %d, diagram k %d, lnk %#x "
          "already exists, map %d\n", l, k, lnk, map[lnk]);
      for (ipr = 0; ipr < d[l].npr; ipr++)
        printf("%2d (%d-%d)\n", ipr, d[l].id[ipr][0], d[l].id[ipr][1]);
      exit(1);
    } else {
      map[lnk] = k;
      dup[k]++;
    }
  }
}



/* six-order virial coefficients */
double vir6(long nsteps)
{
#define NDG6 23 /* number of diagrams */
  long t, acc[NDG6 + 1] = {0};
  rvn_t u, v[6], vb[6];
  double x, y, tot, norm1, norm2;
  int i, j, k, ipr, npr, map[1<<15], mapb[1<<15], dup[NDG6] = {0}, mul[NDG6] = {0};
  unsigned lnk, lnkb, mask;
  struct {
    int sc;    /* star content */
    int degen; /* n! / degen is the symmetry number */
    int npr;   /* number of wiggly edges */
    const char name[16];
  } db[NDG6] = {
    /* cf. Reformulation of the Virial Series for Classical Fluids, Fig. 2
     * F. H. Ree and W. G. Hoover, J. Chem. Phys. 41, 6, 1635-1645
     * The diagrams have been reordered according to Table II. in
     * Virial Coefficients for hard spheres and hard disks,
     * F. H. Ree and W. G. Hoover, J. Chem. Phys. 40, 4 939-950 */
    /*  0 */ {  24,   1,  0, "15"},
    /*  1 */ { -12,  45,  2, "13"},

    /*  2 */ {  16,  15,  3, "12a"},
    /*  3 */ {   8, 180,  3, "12b"},

    /*  4 */ {  -4,  90,  4, "11a"},
    /*  5 */ {  -5, 180,  4, "11b"},
    /*  6 */ {  -4,  60,  4, "11c"},
    /*  7 */ {  -6,  60,  4, "11d"},

    /*  8 */ {  -1, 360,  5, "10a"},
    /*  9 */ {   4,  45,  5, "10b"},
    /* 10 */ {  -4,  72,  5, "10c"}, /* 5-ring: 0-1-2-3-4-0 */
    /* 11 */ {   3, 180,  5, "10d"},

    /* 12 */ {   4,  10,  6, "9a"},
    /* 13 */ {   4,  60,  6, "9b"}, /* 6-ring */
    /* 14 */ {   1, 360,  6, "9c"},
    /* 15 */ {   3, 360,  6, "9d"}, /* 5-ring with a tail */
    /* 16 */ {  -2,  90,  6, "9e"},

    /* 17 */ {  -2, 360,  7, "8a"},
    /* 18 */ {  -1,  90,  7, "8b"},
    /* 19 */ {  -2, 180,  7, "8c"},

    /* 20 */ {   1,  15,  7, "8d"},
    /* the above diagram does not use the chain topology,
     * 1-3-4-5 is fully-connected by wiggly lines */

    /* 21 */ {   1, 180,  8, "7"},
    /* 22 */ {   1,  60,  9, "6"},
  };

  /* chain backbone */
  draw_t gchn[] = { /* edges to be excluded from the chain backbone 0-1-2-3-4-5 */
    { 0,  0, {{0, 0}}}, /* fully connected */

    /* two parallel wiggly lines */
    { 1, 2, {{0, 2}, {1, 3}}},
    { 1, 2, {{0, 2}, {1, 4}}},
    { 1, 2, {{0, 2}, {1, 5}}},
    { 1, 2, {{0, 2}, {3, 5}}},
    { 1, 2, {{0, 3}, {1, 4}}},
    { 1, 2, {{0, 3}, {1, 5}}},
    { 1, 2, {{0, 3}, {2, 4}}},
    { 1, 2, {{0, 3}, {2, 5}}},
    { 1, 2, {{0, 4}, {1, 3}}},
    { 1, 2, {{0, 4}, {1, 5}}},
    { 1, 2, {{0, 4}, {2, 5}}},
    { 1, 2, {{0, 4}, {3, 5}}},
    { 1, 2, {{0, 5}, {1, 3}}},
    { 1, 2, {{0, 5}, {1, 4}}},
    { 1, 2, {{0, 5}, {2, 4}}},
    { 1, 2, {{1, 3}, {2, 4}}},
    { 1, 2, {{1, 3}, {2, 5}}},
    { 1, 2, {{1, 4}, {2, 5}}},
    { 1, 2, {{1, 4}, {3, 5}}},
    { 1, 2, {{1, 5}, {2, 4}}},
    { 1, 2, {{2, 4}, {3, 5}}},

    /* three isolated wiggly lines */
    { 2, 3, {{0, 2}, {1, 4}, {3, 4}}},
    { 2, 3, {{0, 3}, {1, 4}, {2, 5}}},
    { 2, 3, {{0, 3}, {1, 5}, {2, 4}}},
    { 2, 3, {{0, 4}, {2, 5}, {1, 3}}},
    { 2, 3, {{0, 5}, {1, 3}, {2, 4}}},

    /* one isolated wiggly line, and an isolated wiggly-line hat */
    { 3, 3, {{0, 2}, {1, 3}, {1, 4}}},
    { 3, 3, {{0, 2}, {1, 3}, {1, 5}}},
    { 3, 3, {{0, 2}, {1, 4}, {1, 5}}},
    { 3, 3, {{0, 2}, {1, 3}, {3, 5}}},
    { 3, 3, {{0, 2}, {1, 5}, {3, 5}}},
    { 3, 3, {{0, 3}, {1, 4}, {1, 5}}},
    { 3, 3, {{0, 3}, {2, 4}, {2, 5}}},
    { 3, 3, {{0, 3}, {4, 1}, {4, 2}}},
    { 3, 3, {{0, 3}, {5, 1}, {5, 2}}},
    { 3, 3, {{0, 4}, {1, 3}, {3, 5}}},
    { 3, 3, {{0, 4}, {1, 5}, {5, 2}}},
    { 3, 3, {{0, 4}, {1, 5}, {5, 3}}},
    { 3, 3, {{0, 4}, {2, 5}, {5, 3}}},
    { 3, 3, {{0, 4}, {3, 1}, {1, 5}}},
    { 3, 3, {{0, 5}, {1, 3}, {1, 4}}},
    { 3, 3, {{0, 5}, {1, 4}, {2, 4}}},
    { 3, 3, {{1, 3}, {0, 2}, {0, 4}}},
    { 3, 3, {{1, 3}, {0, 2}, {2, 4}}},
    { 3, 3, {{1, 3}, {0, 2}, {2, 5}}},
    { 3, 3, {{1, 3}, {2, 4}, {2, 5}}},
    { 3, 3, {{1, 3}, {0, 4}, {2, 4}}},
    { 3, 3, {{1, 3}, {0, 2}, {0, 5}}},
    { 3, 3, {{1, 3}, {0, 4}, {0, 5}}},
    { 3, 3, {{1, 3}, {0, 5}, {2, 5}}},
    { 3, 3, {{1, 4}, {0, 2}, {0, 3}}},
    { 3, 3, {{1, 4}, {0, 2}, {2, 5}}},
    { 3, 3, {{1, 4}, {0, 3}, {3, 5}}},
    { 3, 3, {{1, 4}, {2, 5}, {3, 5}}},
    { 3, 3, {{1, 4}, {0, 2}, {0, 5}}},
    { 3, 3, {{1, 4}, {0, 3}, {0, 5}}},
    { 3, 3, {{1, 4}, {0, 5}, {2, 5}}},
    { 3, 3, {{1, 4}, {0, 5}, {3, 5}}},
    { 3, 3, {{1, 5}, {0, 2}, {0, 3}}},
    { 3, 3, {{1, 5}, {0, 3}, {0, 4}}},
    { 3, 3, {{1, 5}, {0, 2}, {0, 4}}},
    { 3, 3, {{1, 5}, {0, 2}, {2, 4}}},
    { 3, 3, {{1, 5}, {0, 4}, {2, 4}}},
    { 3, 3, {{2, 4}, {1, 3}, {1, 5}}},
    { 3, 3, {{2, 4}, {1, 3}, {3, 5}}},
    { 3, 3, {{2, 4}, {0, 3}, {3, 5}}},
    { 3, 3, {{2, 4}, {0, 3}, {1, 3}}},
    { 3, 3, {{2, 4}, {1, 5}, {3, 5}}},
    { 3, 3, {{2, 4}, {0, 5}, {0, 3}}},
    { 3, 3, {{2, 4}, {0, 5}, {1, 5}}},
    { 3, 3, {{2, 4}, {0, 5}, {3, 5}}},
    { 3, 3, {{2, 5}, {0, 3}, {0, 4}}},
    { 3, 3, {{2, 5}, {1, 3}, {1, 4}}},
    { 3, 3, {{2, 5}, {0, 3}, {1, 3}}},
    { 3, 3, {{2, 5}, {0, 4}, {1, 4}}},
    { 3, 3, {{3, 5}, {0, 2}, {0, 4}}},
    { 3, 3, {{3, 5}, {0, 2}, {2, 4}}},
    { 3, 3, {{3, 5}, {0, 4}, {1, 4}}},
    { 3, 3, {{3, 5}, {0, 4}, {2, 4}}},
    { 3, 3, {{3, 5}, {1, 4}, {2, 4}}},

    /* two isolated wiggly hats, each hat is a-b-c */
    { 4, 4, {{0, 2}, {2, 4}, {1, 3}, {3, 5}}},
    { 4, 4, {{0, 2}, {2, 4}, {3, 5}, {5, 1}}},
    { 4, 4, {{0, 2}, {2, 4}, {5, 1}, {1, 3}}},
    { 4, 4, {{2, 4}, {4, 0}, {1, 3}, {3, 5}}},
    { 4, 4, {{2, 4}, {4, 0}, {3, 5}, {5, 1}}},
    { 4, 4, {{2, 4}, {4, 0}, {5, 1}, {1, 3}}},
    { 4, 4, {{4, 0}, {0, 2}, {1, 3}, {3, 5}}},
    { 4, 4, {{4, 0}, {0, 2}, {3, 5}, {5, 1}}},
    { 4, 4, {{4, 0}, {0, 2}, {5, 1}, {1, 3}}},
    { 4, 4, {{2, 0}, {0, 3}, {4, 1}, {1, 5}}},
    { 4, 4, {{3, 0}, {0, 4}, {1, 5}, {5, 2}}},
    { 4, 4, {{3, 1}, {1, 4}, {0, 2}, {2, 5}}},
    { 4, 4, {{4, 2}, {2, 5}, {0, 3}, {3, 1}}},
    { 4, 4, {{0, 3}, {3, 5}, {1, 4}, {4, 2}}},
    { 4, 4, {{0, 4}, {4, 1}, {2, 5}, {5, 3}}},
    { 4, 4, {{2, 0}, {0, 5}, {3, 1}, {1, 4}}},
    { 4, 4, {{3, 0}, {0, 5}, {1, 4}, {4, 2}}},
    { 4, 4, {{0, 5}, {5, 2}, {3, 1}, {1, 4}}},
    { 4, 4, {{0, 5}, {5, 3}, {1, 4}, {4, 2}}},
    /* { 4, 4, {{4, 0}, {0, 5}, 1-2-3 are connected }}, */

    /* the first is the isolated wiggly line, the last three connnected */
    { 5, 4, {{0, 2}, {3, 5}, {5, 1}, {1, 4}}},
    { 5, 4, {{0, 2}, {4, 1}, {1, 3}, {3, 5}}},
    { 5, 4, {{0, 3}, {1, 4}, {4, 2}, {2, 5}}},
    { 5, 4, {{0, 3}, {1, 5}, {5, 2}, {2, 4}}},
    { 5, 4, {{0, 3}, {2, 4}, {4, 1}, {1, 5}}},
    { 5, 4, {{0, 3}, {2, 5}, {5, 1}, {1, 4}}},
    { 5, 4, {{0, 4}, {1, 3}, {3, 5}, {5, 2}}},
    { 5, 4, {{0, 4}, {2, 5}, {5, 1}, {1, 3}}},
    { 5, 4, {{0, 5}, {2, 4}, {4, 1}, {1, 3}}},
    { 5, 4, {{1, 3}, {4, 2}, {2, 0}, {0, 5}}},
    { 5, 4, {{1, 3}, {4, 0}, {0, 2}, {2, 5}}},
    { 5, 4, {{1, 3}, {2, 4}, {4, 0}, {0, 5}}},
    { 5, 4, {{1, 3}, {2, 5}, {5, 0}, {0, 4}}},
    { 5, 4, {{1, 3}, {0, 4}, {4, 2}, {2, 5}}},
    { 5, 4, {{1, 3}, {0, 5}, {5, 2}, {2, 4}}},
    { 5, 4, {{1, 4}, {3, 0}, {0, 2}, {2, 5}}},
    { 5, 4, {{1, 4}, {2, 0}, {0, 3}, {3, 5}}},
    { 5, 4, {{1, 4}, {2, 0}, {0, 5}, {5, 3}}},
    { 5, 4, {{1, 4}, {3, 0}, {0, 5}, {5, 2}}},
    { 5, 4, {{1, 4}, {0, 2}, {2, 5}, {5, 3}}},
    { 5, 4, {{1, 4}, {0, 3}, {3, 5}, {5, 2}}},
    { 5, 4, {{1, 5}, {3, 0}, {0, 2}, {2, 4}}},
    { 5, 4, {{1, 5}, {3, 0}, {0, 4}, {4, 2}}},
    { 5, 4, {{2, 4}, {5, 0}, {0, 3}, {3, 1}}},
    { 5, 4, {{2, 4}, {3, 0}, {0, 5}, {5, 1}}},
    { 5, 4, {{2, 4}, {5, 1}, {1, 3}, {3, 0}}},
    { 5, 4, {{2, 4}, {3, 1}, {1, 5}, {5, 0}}},
    { 5, 4, {{2, 4}, {0, 3}, {3, 5}, {5, 1}}},
    { 5, 4, {{2, 4}, {1, 3}, {3, 5}, {5, 0}}},
    { 5, 4, {{2, 5}, {0, 3}, {3, 1}, {1, 4}}},
    { 5, 4, {{2, 5}, {0, 4}, {4, 1}, {1, 3}}},
    { 5, 4, {{2, 5}, {1, 3}, {3, 0}, {0, 4}}},
    { 5, 4, {{2, 5}, {1, 4}, {4, 0}, {0, 3}}},
    { 5, 4, {{3, 5}, {0, 2}, {2, 4}, {4, 1}}},
    { 5, 4, {{3, 5}, {2, 0}, {0, 4}, {4, 1}}},

    /* isolated wiggly line, and isolated wiggle triangle */
    { 6, 4, {{0, 2}, {1, 3}, {3, 5}, {5, 1}}},
    { 6, 4, {{0, 4}, {1, 3}, {3, 5}, {5, 1}}},
    { 6, 4, {{1, 3}, {0, 2}, {2, 4}, {4, 0}}},
    { 6, 4, {{1, 3}, {0, 2}, {2, 5}, {5, 0}}},
    { 6, 4, {{1, 4}, {0, 2}, {2, 5}, {5, 0}}},
    { 6, 4, {{1, 4}, {0, 3}, {3, 5}, {5, 0}}},
    { 6, 4, {{1, 5}, {0, 2}, {2, 4}, {4, 0}}},
    { 6, 4, {{2, 4}, {0, 3}, {3, 5}, {5, 0}}},
    { 6, 4, {{2, 4}, {1, 3}, {3, 5}, {5, 1}}},
    { 6, 4, {{3, 5}, {0, 2}, {2, 4}, {4, 0}}},

    { 7, 4, {{0, 2}, {0, 3}, {0, 4}, {1, 5}}},
    { 7, 4, {{0, 2}, {0, 4}, {0, 5}, {1, 3}}},
    { 7, 4, {{0, 2}, {0, 3}, {0, 5}, {1, 4}}},
    { 7, 4, {{5, 3}, {5, 2}, {5, 1}, {4, 0}}},
    { 7, 4, {{5, 3}, {5, 1}, {5, 0}, {4, 2}}},
    { 7, 4, {{5, 3}, {5, 2}, {5, 0}, {4, 1}}},
    { 7, 4, {{1, 3}, {1, 4}, {1, 5}, {0, 2}}},
    { 7, 4, {{4, 2}, {4, 1}, {4, 0}, {5, 3}}},
    { 7, 4, {{2, 0}, {2, 4}, {2, 5}, {1, 3}}},
    { 7, 4, {{3, 5}, {3, 1}, {3, 0}, {4, 2}}},

    /* an open wiggly 6-point 5-edge chain */
    { 8, 5, {{0, 2}, {2, 4}, {4, 1}, {1, 3}, {3, 5}}}, /* 0-2-4 */
    { 8, 5, {{0, 2}, {2, 4}, {4, 1}, {1, 5}, {5, 3}}}, /* 0-2-4 */
    { 8, 5, {{0, 2}, {2, 5}, {5, 3}, {3, 1}, {1, 4}}}, /* 0-2-5 */
    { 8, 5, {{0, 3}, {3, 1}, {1, 4}, {4, 2}, {2, 5}}}, /* 0-3-1-4 */
    { 8, 5, {{0, 3}, {3, 1}, {1, 5}, {5, 2}, {2, 4}}}, /* 0-3-1-5 */
    { 8, 5, {{0, 3}, {3, 5}, {5, 1}, {1, 4}, {4, 2}}}, /* 0-3-5-1 */
    { 8, 5, {{0, 3}, {3, 5}, {5, 2}, {2, 4}, {4, 1}}}, /* 0-3-5-2 */
    { 8, 5, {{0, 4}, {4, 1}, {1, 3}, {3, 5}, {5, 2}}}, /* 0-4-1 */
    { 8, 5, {{0, 4}, {4, 2}, {2, 5}, {5, 1}, {1, 3}}}, /* 0-4-2-5-1 */
    { 8, 5, {{0, 4}, {4, 2}, {2, 5}, {5, 3}, {3, 1}}}, /* 0-4-2-5-3 */
    { 8, 5, {{0, 5}, {5, 2}, {2, 4}, {4, 1}, {1, 3}}}, /* 0-5-2 */
    { 8, 5, {{0, 5}, {5, 3}, {3, 1}, {1, 4}, {4, 2}}}, /* 0-5-3 */
    { 8, 5, {{1, 3}, {3, 0}, {0, 4}, {4, 2}, {2, 5}}}, /* 1-3-0-4 */
    { 8, 5, {{1, 3}, {3, 0}, {0, 5}, {5, 2}, {2, 4}}}, /* 1-3-0-5 */
    { 8, 5, {{1, 3}, {3, 5}, {5, 0}, {0, 2}, {2, 4}}}, /* 1-3-5-0-2 */
    { 8, 5, {{1, 3}, {3, 5}, {5, 0}, {0, 4}, {4, 2}}}, /* 1-3-5-0-4 */
    { 8, 5, {{1, 3}, {3, 5}, {5, 2}, {2, 0}, {0, 4}}}, /* 1-3-5-2-0 */
    { 8, 5, {{1, 4}, {4, 0}, {0, 2}, {2, 5}, {5, 3}}}, /* 1-4-0-2 */
    { 8, 5, {{1, 4}, {4, 0}, {0, 3}, {3, 5}, {5, 2}}}, /* 1-4-0-3 */
    { 8, 5, {{1, 4}, {4, 2}, {2, 0}, {0, 3}, {3, 5}}}, /* 1-4-2-0 */
    { 8, 5, {{1, 4}, {4, 2}, {2, 0}, {0, 5}, {5, 3}}}, /* 1-4-2-0 */
    { 8, 5, {{1, 4}, {4, 2}, {2, 5}, {5, 0}, {0, 3}}}, /* 1-4-2-5 */
    { 8, 5, {{1, 5}, {5, 2}, {2, 4}, {4, 0}, {0, 3}}}, /* 1-5-2 */
    { 8, 5, {{1, 5}, {5, 3}, {3, 0}, {0, 2}, {2, 4}}}, /* 1-5-3 */
    { 8, 5, {{1, 5}, {5, 3}, {3, 0}, {0, 4}, {4, 2}}}, /* 1-5-3 */
    { 8, 5, {{2, 0}, {0, 3}, {3, 5}, {5, 1}, {1, 4}}}, /* 2-0-3 */
    { 8, 5, {{2, 0}, {0, 4}, {4, 1}, {1, 3}, {3, 5}}}, /* 2-0-4 */
    { 8, 5, {{2, 0}, {0, 4}, {4, 1}, {1, 5}, {5, 3}}}, /* 2-0-4 */
    { 8, 5, {{2, 0}, {0, 5}, {5, 3}, {3, 1}, {1, 4}}}, /* 2-0-5 */
    { 8, 5, {{2, 4}, {4, 0}, {0, 3}, {3, 1}, {1, 5}}}, /* 2-4-0-3 */
    { 8, 5, {{2, 4}, {4, 0}, {0, 5}, {5, 1}, {1, 3}}}, /* 2-4-0-5 */
    { 8, 5, {{2, 4}, {4, 1}, {1, 3}, {3, 0}, {0, 5}}}, /* 2-4-1-3 */
    { 8, 5, {{2, 4}, {4, 1}, {1, 5}, {5, 0}, {0, 3}}}, /* 2-4-1-5 */
    { 8, 5, {{2, 5}, {5, 0}, {0, 3}, {3, 1}, {1, 4}}}, /* 2-5-0-3 */
    { 8, 5, {{2, 5}, {5, 0}, {0, 4}, {4, 1}, {1, 3}}}, /* 2-5-0-4 */
    { 8, 5, {{2, 5}, {5, 1}, {1, 3}, {3, 0}, {0, 4}}}, /* 2-5-1-3 */
    { 8, 5, {{2, 5}, {5, 1}, {1, 4}, {4, 0}, {0, 3}}}, /* 2-5-1-4 */
    { 8, 5, {{3, 0}, {0, 2}, {2, 4}, {4, 1}, {1, 5}}}, /* 3-0-2-4 */
    { 8, 5, {{3, 0}, {0, 2}, {2, 5}, {5, 1}, {1, 4}}}, /* 3-0-2-5 */
    { 8, 5, {{3, 1}, {1, 4}, {4, 0}, {0, 2}, {2, 5}}}, /* 3-1-4-0 */
    { 8, 5, {{3, 1}, {1, 4}, {4, 2}, {2, 0}, {0, 5}}}, /* 3-1-4-2 */
    { 8, 5, {{3, 1}, {1, 5}, {5, 0}, {0, 2}, {2, 5}}}, /* 3-1-5-0 */
    { 8, 5, {{3, 1}, {1, 5}, {5, 2}, {2, 0}, {0, 4}}}, /* 3-1-5-2 */
    { 8, 5, {{4, 1}, {1, 3}, {3, 0}, {0, 2}, {2, 5}}}, /* 4-1-3-0 */
    { 8, 5, {{4, 2}, {2, 0}, {0, 3}, {3, 1}, {1, 5}}}, /* 4-2-0-3 */

    /* an isolated wiggly line and an isolated square */
    { 9, 5, {{0, 3}, {1, 4}, {4, 2}, {2, 5}, {5, 1}}},
    { 9, 5, {{1, 3}, {0, 4}, {4, 2}, {2, 5}, {5, 0}}},
    { 9, 5, {{1, 4}, {0, 2}, {2, 5}, {5, 3}, {3, 0}}},
    { 9, 5, {{2, 4}, {0, 3}, {3, 1}, {1, 5}, {5, 0}}},
    { 9, 5, {{2, 5}, {0, 3}, {3, 1}, {1, 4}, {4, 0}}},

    /* closed wiggly 5-ring */
    {10, 5, {{0, 2}, {2, 4}, {4, 1}, {1, 3}, {3, 0}}}, /* 0-1-2-3-4-0 */
    {10, 5, {{0, 3}, {3, 5}, {5, 2}, {2, 4}, {4, 0}}}, /* 0-2-3-4-5-0 */
    {10, 5, {{0, 3}, {3, 5}, {5, 1}, {1, 4}, {4, 0}}}, /* 0-1-3-4-5-0 */
    {10, 5, {{0, 2}, {2, 5}, {5, 1}, {1, 4}, {4, 0}}}, /* 0-1-2-4-5-0 */
    {10, 5, {{0, 2}, {2, 5}, {5, 1}, {1, 3}, {3, 0}}}, /* 0-1-2-3-5-0 */
    {10, 5, {{5, 2}, {2, 4}, {4, 1}, {1, 3}, {3, 5}}}, /* 5-1-2-3-4-5 */
    {10, 5, {{0, 5}, {5, 1}, {1, 4}, {4, 2}, {2, 0}}}, /* 0-5-1-4-2-0 */
    {10, 5, {{5, 0}, {0, 4}, {4, 1}, {1, 3}, {3, 5}}}, /* 5-0-4-1-3-5 */

    /* isolated wiggly line and isolated wiggly umbrella */
    {11, 5, {{0, 2}, {1, 3}, {3, 5}, {5, 1}, {1, 4}}},
    {11, 5, {{0, 4}, {1, 3}, {3, 5}, {5, 1}, {2, 5}}},
    {11, 5, {{1, 3}, {0, 2}, {2, 4}, {4, 0}, {0, 5}}},
    {11, 5, {{1, 3}, {0, 2}, {2, 4}, {4, 0}, {2, 5}}},
    {11, 5, {{1, 3}, {0, 2}, {2, 5}, {5, 0}, {0, 4}}},
    {11, 5, {{1, 3}, {0, 2}, {2, 5}, {5, 0}, {2, 4}}},
    {11, 5, {{1, 4}, {0, 2}, {2, 5}, {5, 0}, {0, 3}}},
    {11, 5, {{1, 4}, {0, 2}, {2, 5}, {5, 0}, {5, 3}}},
    {11, 5, {{1, 4}, {0, 3}, {3, 5}, {5, 0}, {0, 2}}},
    {11, 5, {{1, 4}, {0, 3}, {3, 5}, {5, 0}, {2, 5}}},
    {11, 5, {{1, 5}, {0, 2}, {2, 4}, {4, 0}, {0, 3}}},
    {11, 5, {{2, 4}, {0, 3}, {3, 5}, {5, 0}, {1, 3}}},
    {11, 5, {{2, 4}, {0, 3}, {3, 5}, {5, 0}, {1, 5}}},
    {11, 5, {{2, 4}, {1, 3}, {3, 5}, {5, 1}, {0, 3}}},
    {11, 5, {{2, 4}, {1, 3}, {3, 5}, {5, 1}, {0, 5}}},
    {11, 5, {{3, 5}, {0, 2}, {2, 4}, {4, 0}, {1, 4}}},

    /* two isolated wiggly triangles */
    {12, 6, {{0, 2}, {0, 4}, {2, 4}, {1, 3}, {3, 5}, {5, 1}}},

    /* 6-ring: 0-1-2-3-4-5-0 */
    {13, 6, {{0, 2}, {2, 4}, {4, 1}, {1, 3}, {3, 5}, {5, 0}}},
    {13, 6, {{0, 2}, {2, 4}, {4, 1}, {1, 5}, {5, 3}, {3, 0}}},
    {13, 6, {{0, 2}, {2, 5}, {5, 3}, {3, 1}, {1, 4}, {4, 0}}},
    {13, 6, {{0, 3}, {3, 1}, {1, 4}, {4, 2}, {2, 5}, {5, 0}}},
    {13, 6, {{0, 3}, {3, 1}, {1, 5}, {5, 2}, {2, 4}, {4, 0}}},

    /* wiggly triangle with a length-3 tail */
    {14, 6, {{0, 2}, {2, 4}, {4, 0}, {0, 3}, {3, 1}, {1, 5}}},
    {14, 6, {{0, 2}, {2, 4}, {4, 0}, {0, 3}, {3, 5}, {5, 1}}},
    {14, 6, {{0, 2}, {2, 4}, {4, 0}, {0, 5}, {5, 1}, {1, 3}}},
    {14, 6, {{0, 2}, {2, 4}, {4, 0}, {0, 5}, {5, 3}, {3, 1}}},
    {14, 6, {{0, 2}, {2, 4}, {4, 0}, {2, 5}, {5, 1}, {1, 3}}},
    {14, 6, {{0, 2}, {2, 4}, {4, 0}, {2, 5}, {5, 3}, {3, 1}}},
    {14, 6, {{0, 2}, {2, 4}, {4, 0}, {4, 1}, {1, 3}, {3, 5}}},
    {14, 6, {{0, 2}, {2, 4}, {4, 0}, {4, 1}, {1, 5}, {5, 3}}},
    {14, 6, {{0, 2}, {2, 5}, {5, 0}, {0, 3}, {3, 1}, {1, 4}}},
    {14, 6, {{0, 2}, {2, 5}, {5, 0}, {0, 4}, {4, 1}, {1, 3}}},
    {14, 6, {{0, 2}, {2, 5}, {5, 0}, {2, 4}, {4, 1}, {1, 3}}},
    {14, 6, {{0, 2}, {2, 5}, {5, 0}, {5, 3}, {3, 1}, {1, 4}}},
    {14, 6, {{0, 3}, {3, 5}, {5, 0}, {0, 2}, {2, 4}, {4, 1}}},
    {14, 6, {{0, 3}, {3, 5}, {5, 0}, {3, 1}, {1, 4}, {4, 2}}},
    {14, 6, {{0, 3}, {3, 5}, {5, 0}, {5, 1}, {1, 4}, {4, 2}}},
    {14, 6, {{0, 3}, {3, 5}, {5, 0}, {5, 2}, {2, 4}, {4, 1}}},
    {14, 6, {{1, 3}, {3, 5}, {5, 1}, {1, 4}, {4, 0}, {0, 2}}},
    {14, 6, {{1, 3}, {3, 5}, {5, 1}, {1, 4}, {4, 2}, {2, 0}}},
    {14, 6, {{1, 3}, {3, 5}, {5, 1}, {3, 0}, {0, 2}, {2, 4}}},
    {14, 6, {{1, 3}, {3, 5}, {5, 1}, {3, 0}, {0, 4}, {4, 2}}},
    {14, 6, {{1, 3}, {3, 5}, {5, 1}, {5, 0}, {0, 2}, {2, 4}}},
    {14, 6, {{1, 3}, {3, 5}, {5, 1}, {5, 0}, {0, 4}, {4, 2}}},
    {14, 6, {{1, 3}, {3, 5}, {5, 1}, {5, 2}, {2, 0}, {0, 4}}},
    {14, 6, {{1, 3}, {3, 5}, {5, 1}, {5, 2}, {2, 4}, {4, 0}}},

    /* 5-ring with a tail */
    {15, 6, {{0, 2}, {2, 4}, {4, 1}, {1, 3}, {3, 0}, {0, 5}}}, /* 0-1-2-3-4-0, 5 */
    {15, 6, {{0, 2}, {2, 4}, {4, 1}, {1, 3}, {3, 0}, {1, 5}}}, /* 0-1-2-3-4-0, 5 */
    {15, 6, {{0, 2}, {2, 4}, {4, 1}, {1, 3}, {3, 0}, {2, 5}}}, /* 0-1-2-3-4-0, 5 */
    {15, 6, {{0, 2}, {2, 4}, {4, 1}, {1, 3}, {3, 0}, {3, 5}}}, /* 0-1-2-3-4-0, 5 */
    {15, 6, {{0, 3}, {3, 5}, {5, 2}, {2, 4}, {4, 0}, {3, 1}}}, /* 0-2-3-4-5-0, 1 */
    {15, 6, {{0, 3}, {3, 5}, {5, 2}, {2, 4}, {4, 0}, {4, 1}}}, /* 0-2-3-4-5-0, 1 */
    {15, 6, {{0, 3}, {3, 5}, {5, 2}, {2, 4}, {4, 0}, {5, 1}}}, /* 0-2-3-4-5-0, 1 */
    {15, 6, {{0, 3}, {3, 5}, {5, 1}, {1, 4}, {4, 0}, {0, 2}}}, /* 0-1-3-4-5-0, 2 */
    {15, 6, {{0, 3}, {3, 5}, {5, 1}, {1, 4}, {4, 0}, {4, 2}}}, /* 0-1-3-4-5-0, 2 */
    {15, 6, {{0, 3}, {3, 5}, {5, 1}, {1, 4}, {4, 0}, {5, 2}}}, /* 0-1-3-4-5-0, 2 */
    {15, 6, {{0, 2}, {2, 5}, {5, 1}, {1, 4}, {4, 0}, {0, 3}}}, /* 0-1-2-4-5-0, 3 */
    {15, 6, {{0, 2}, {2, 5}, {5, 1}, {1, 4}, {4, 0}, {1, 3}}}, /* 0-1-2-4-5-0, 3 */
    {15, 6, {{0, 2}, {2, 5}, {5, 1}, {1, 4}, {4, 0}, {5, 3}}}, /* 0-1-2-4-5-0, 3 */
    {15, 6, {{0, 2}, {2, 5}, {5, 1}, {1, 3}, {3, 0}, {0, 4}}}, /* 0-1-2-3-5-0, 4 */
    {15, 6, {{0, 2}, {2, 5}, {5, 1}, {1, 3}, {3, 0}, {1, 4}}}, /* 0-1-2-3-5-0, 4 */
    {15, 6, {{0, 2}, {2, 5}, {5, 1}, {1, 3}, {3, 0}, {2, 4}}}, /* 0-1-2-3-5-0, 4 */
    {15, 6, {{5, 2}, {2, 4}, {4, 1}, {1, 3}, {3, 5}, {2, 0}}}, /* 5-1-2-3-4-5, 0 */
    {15, 6, {{5, 2}, {2, 4}, {4, 1}, {1, 3}, {3, 5}, {3, 0}}}, /* 5-1-2-3-4-5, 0 */
    {15, 6, {{5, 2}, {2, 4}, {4, 1}, {1, 3}, {3, 5}, {4, 0}}}, /* 5-1-2-3-4-5, 0 */
    {15, 6, {{5, 2}, {2, 4}, {4, 1}, {1, 3}, {3, 5}, {5, 0}}}, /* 5-1-2-3-4-5, 0 */
    {15, 6, {{0, 5}, {5, 1}, {1, 4}, {4, 2}, {2, 0}, {3, 0}}}, /* 0-5-1-4-2-0, 3 */
    {15, 6, {{0, 5}, {5, 1}, {1, 4}, {4, 2}, {2, 0}, {3, 1}}}, /* 0-5-1-4-2-0, 3 */
    {15, 6, {{0, 5}, {5, 1}, {1, 4}, {4, 2}, {2, 0}, {3, 5}}}, /* 0-5-1-4-2-0, 3 */
    {15, 6, {{5, 0}, {0, 4}, {4, 1}, {1, 3}, {3, 5}, {2, 0}}}, /* 5-0-4-1-3-5, 2 */
    {15, 6, {{5, 0}, {0, 4}, {4, 1}, {1, 3}, {3, 5}, {2, 4}}}, /* 5-0-4-1-3-5, 2 */
    {15, 6, {{5, 0}, {0, 4}, {4, 1}, {1, 3}, {3, 5}, {2, 5}}}, /* 5-0-4-1-3-5, 2 */

    /* an isolated line, and an isolated diamond */
    {16, 6, {{1, 3}, {0, 2}, {0, 4}, {0, 5}, {2, 4}, {2, 5}}},
    {16, 6, {{1, 4}, {0, 2}, {0, 3}, {0, 5}, {2, 5}, {3, 5}}},
    {16, 6, {{2, 4}, {0, 3}, {1, 3}, {1, 5}, {0, 5}, {3, 5}}},

    /* an closed wiggly 6-ring with a wiggly 1-3 line */
    {17, 7, {{0, 2}, {2, 4}, {4, 1}, {1, 3}, {3, 5}, {5, 0}, {2, 5}}},
    {17, 7, {{0, 2}, {2, 4}, {4, 1}, {1, 3}, {3, 5}, {5, 0}, {0, 4}}},
    {17, 7, {{0, 2}, {2, 4}, {4, 1}, {1, 3}, {3, 5}, {5, 0}, {1, 5}}},
    {17, 7, {{0, 2}, {2, 4}, {4, 1}, {1, 3}, {3, 5}, {5, 0}, {0, 3}}},
    {17, 7, {{0, 2}, {2, 4}, {4, 1}, {1, 5}, {5, 3}, {3, 0}, {0, 4}}},
    {17, 7, {{0, 2}, {2, 4}, {4, 1}, {1, 5}, {5, 3}, {3, 0}, {0, 5}}},
    {17, 7, {{0, 2}, {2, 4}, {4, 1}, {1, 5}, {5, 3}, {3, 0}, {1, 3}}},
    {17, 7, {{0, 2}, {2, 5}, {5, 3}, {3, 1}, {1, 4}, {4, 0}, {2, 4}}},
    {17, 7, {{0, 2}, {2, 5}, {5, 3}, {3, 1}, {1, 4}, {4, 0}, {0, 5}}},
    {17, 7, {{0, 2}, {2, 5}, {5, 3}, {3, 1}, {1, 4}, {4, 0}, {1, 5}}},
    {17, 7, {{0, 3}, {3, 1}, {1, 4}, {4, 2}, {2, 5}, {5, 0}, {3, 5}}},
    {17, 7, {{0, 3}, {3, 1}, {1, 4}, {4, 2}, {2, 5}, {5, 0}, {0, 2}}},
    {17, 7, {{0, 3}, {3, 1}, {1, 5}, {5, 2}, {2, 4}, {4, 0}, {3, 5}}},
    {17, 7, {{0, 3}, {3, 1}, {1, 5}, {5, 2}, {2, 4}, {4, 0}, {0, 2}}},

    /* two wiggly triangles connected by a wiggly line */
    {18, 7, {{0, 2}, {2, 4}, {4, 0}, {1, 3}, {3, 5}, {5, 1}, {0, 5}}},
    {18, 7, {{0, 2}, {2, 4}, {4, 0}, {1, 3}, {3, 5}, {5, 1}, {0, 3}}},
    {18, 7, {{0, 2}, {2, 4}, {4, 0}, {1, 3}, {3, 5}, {5, 1}, {1, 4}}},
    {18, 7, {{0, 2}, {2, 4}, {4, 0}, {1, 3}, {3, 5}, {5, 1}, {2, 5}}},

    {19, 7, {{0, 2}, {2, 5}, {5, 1}, {1, 4}, {4, 0}, {3, 0}, {3, 5}}},
    {19, 7, {{0, 3}, {3, 1}, {1, 4}, {4, 2}, {2, 0}, {5, 0}, {5, 1}}},
    {19, 7, {{0, 3}, {3, 1}, {1, 5}, {5, 2}, {2, 0}, {4, 0}, {4, 1}}},
    {19, 7, {{1, 4}, {4, 2}, {2, 0}, {0, 3}, {3, 1}, {5, 1}, {5, 2}}},
    {19, 7, {{2, 0}, {0, 3}, {3, 1}, {1, 4}, {4, 2}, {5, 2}, {5, 3}}},
    {19, 7, {{3, 0}, {0, 4}, {4, 2}, {2, 5}, {5, 3}, {1, 3}, {1, 4}}},
    {19, 7, {{4, 0}, {0, 5}, {5, 3}, {3, 1}, {1, 4}, {2, 4}, {2, 5}}},
    {19, 7, {{4, 1}, {1, 5}, {5, 3}, {3, 0}, {0, 4}, {2, 4}, {2, 5}}},

    {21, 8, {{0, 3}, {3, 5}, {5, 1}, {1, 4}, {4, 2}, {2, 0}, {0, 5}, {3, 1}}},
    {21, 8, {{2, 0}, {0, 5}, {5, 3}, {3, 1}, {1, 4}, {4, 2}, {2, 5}, {0, 3}}},
    {21, 8, {{4, 0}, {0, 2}, {2, 5}, {5, 3}, {3, 1}, {1, 4}, {4, 2}, {0, 5}}},

    {22, 9, {{0, 2}, {2, 4}, {4, 1}, {1, 5}, {5, 3}, {3, 0}, {0, 4}, {1, 3}, {2, 5}}},
    {-1, 0, {{0, 0}}},
  };

  /* claw backbone */
  draw_t gcln[] = {
    {0,  0, {{0, 0}}}, /* fully connected */
    { 1, 2, {{0, 2}, {1, 3}}},
    { 1, 2, {{0, 2}, {1, 4}}},
    { 1, 2, {{0, 2}, {1, 5}}},
    { 1, 2, {{0, 2}, {3, 4}}},
    { 1, 2, {{0, 2}, {3, 5}}},
    { 1, 2, {{0, 2}, {4, 5}}},
    { 1, 2, {{0, 3}, {1, 4}}},
    { 1, 2, {{0, 3}, {1, 5}}},
    { 1, 2, {{0, 3}, {4, 5}}},
    { 1, 2, {{0, 4}, {1, 3}}},
    { 1, 2, {{0, 4}, {1, 5}}},
    { 1, 2, {{0, 4}, {3, 5}}},
    { 1, 2, {{0, 5}, {1, 3}}},
    { 1, 2, {{0, 5}, {1, 4}}},
    { 1, 2, {{0, 5}, {3, 4}}},
    { 1, 2, {{1, 3}, {4, 5}}},
    { 1, 2, {{1, 4}, {3, 5}}},
    { 1, 2, {{1, 5}, {3, 4}}},

    /* three isolated wiggly lines */
    { 2, 3, {{0, 2}, {1, 3}, {4, 5}}},
    { 2, 3, {{0, 2}, {1, 4}, {3, 5}}},
    { 2, 3, {{0, 2}, {1, 5}, {3, 4}}},

    /* one isolated wiggly line, and an isolated wiggly-line hat */
    { 3, 3, {{0, 2}, {3, 1}, {1, 4}}},
    { 3, 3, {{0, 2}, {4, 1}, {1, 5}}},
    { 3, 3, {{0, 2}, {5, 1}, {1, 3}}},
    { 3, 3, {{0, 2}, {1, 3}, {3, 4}}},
    { 3, 3, {{0, 2}, {4, 3}, {3, 5}}},
    { 3, 3, {{0, 2}, {5, 3}, {3, 1}}},
    { 3, 3, {{0, 2}, {1, 4}, {4, 3}}},
    { 3, 3, {{0, 2}, {3, 4}, {4, 5}}},
    { 3, 3, {{0, 2}, {5, 4}, {4, 1}}},
    { 3, 3, {{0, 2}, {1, 5}, {5, 3}}},
    { 3, 3, {{0, 2}, {3, 5}, {5, 4}}},
    { 3, 3, {{0, 2}, {4, 5}, {5, 1}}},
    { 3, 3, {{0, 3}, {4, 1}, {1, 5}}},
    { 3, 3, {{0, 3}, {1, 4}, {4, 5}}},
    { 3, 3, {{0, 3}, {1, 5}, {5, 4}}},
    { 3, 3, {{0, 4}, {3, 1}, {1, 5}}},
    { 3, 3, {{0, 4}, {1, 3}, {3, 5}}},
    { 3, 3, {{0, 4}, {1, 5}, {5, 3}}},
    { 3, 3, {{0, 5}, {3, 1}, {1, 4}}},
    { 3, 3, {{0, 5}, {1, 3}, {3, 4}}},
    { 3, 3, {{0, 5}, {1, 4}, {4, 3}}},
    { 3, 3, {{1, 3}, {2, 0}, {0, 4}}},
    { 3, 3, {{1, 3}, {2, 0}, {0, 5}}},
    { 3, 3, {{1, 3}, {4, 0}, {0, 5}}},
    { 3, 3, {{1, 3}, {0, 4}, {4, 5}}},
    { 3, 3, {{1, 3}, {0, 5}, {5, 4}}},
    { 3, 3, {{1, 4}, {2, 0}, {0, 3}}},
    { 3, 3, {{1, 4}, {2, 0}, {0, 5}}},
    { 3, 3, {{1, 4}, {3, 0}, {0, 5}}},
    { 3, 3, {{1, 4}, {0, 3}, {3, 5}}},
    { 3, 3, {{1, 4}, {0, 5}, {5, 3}}},
    { 3, 3, {{1, 5}, {2, 0}, {0, 3}}},
    { 3, 3, {{1, 5}, {2, 0}, {0, 4}}},
    { 3, 3, {{1, 5}, {3, 0}, {0, 4}}},
    { 3, 3, {{1, 5}, {0, 3}, {3, 4}}},
    { 3, 3, {{1, 5}, {0, 4}, {4, 3}}},
    { 3, 3, {{3, 4}, {2, 0}, {0, 5}}},
    { 3, 3, {{3, 4}, {0, 5}, {5, 1}}},
    { 3, 3, {{4, 5}, {2, 0}, {0, 3}}},
    { 3, 3, {{4, 5}, {0, 3}, {3, 1}}},
    { 3, 3, {{3, 5}, {2, 0}, {0, 4}}},
    { 3, 3, {{3, 5}, {0, 4}, {4, 1}}},

    /* two wiggly 2-link chains */
    { 4, 4, {{2, 0}, {0, 3}, {4, 1}, {1, 5}}},
    { 4, 4, {{2, 0}, {0, 3}, {1, 4}, {4, 5}}},
    { 4, 4, {{2, 0}, {0, 3}, {1, 5}, {5, 4}}},
    { 4, 4, {{2, 0}, {0, 4}, {3, 1}, {1, 5}}},
    { 4, 4, {{2, 0}, {0, 4}, {1, 3}, {3, 5}}},
    { 4, 4, {{2, 0}, {0, 4}, {1, 5}, {5, 3}}},
    { 4, 4, {{2, 0}, {0, 5}, {3, 1}, {1, 4}}},
    { 4, 4, {{2, 0}, {0, 5}, {1, 3}, {3, 4}}},
    { 4, 4, {{2, 0}, {0, 5}, {1, 4}, {4, 3}}},

    /* a wiggly line, and a wiggly 3-link chain */
    { 5, 4, {{0, 2}, {1, 3}, {3, 4}, {4, 5}}},
    { 5, 4, {{0, 2}, {1, 3}, {3, 5}, {5, 4}}},
    { 5, 4, {{0, 2}, {1, 4}, {4, 3}, {3, 5}}},
    { 5, 4, {{0, 2}, {1, 4}, {4, 5}, {5, 3}}},
    { 5, 4, {{0, 2}, {1, 5}, {5, 3}, {3, 4}}},
    { 5, 4, {{0, 2}, {1, 5}, {5, 4}, {4, 3}}},
    { 5, 4, {{0, 2}, {3, 1}, {1, 4}, {4, 5}}},
    { 5, 4, {{0, 2}, {3, 1}, {1, 5}, {5, 4}}},
    { 5, 4, {{0, 2}, {3, 4}, {4, 1}, {1, 5}}},
    { 5, 4, {{0, 2}, {3, 5}, {5, 1}, {1, 4}}},
    { 5, 4, {{0, 2}, {4, 1}, {1, 3}, {3, 5}}},
    { 5, 4, {{0, 2}, {4, 3}, {3, 1}, {1, 5}}},
    { 5, 4, {{1, 3}, {2, 0}, {0, 4}, {4, 5}}},
    { 5, 4, {{1, 3}, {2, 0}, {0, 5}, {5, 4}}},
    { 5, 4, {{1, 4}, {2, 0}, {0, 3}, {3, 5}}},
    { 5, 4, {{1, 4}, {2, 0}, {0, 5}, {5, 3}}},
    { 5, 4, {{1, 5}, {2, 0}, {0, 3}, {3, 4}}},
    { 5, 4, {{1, 5}, {2, 0}, {0, 4}, {4, 3}}},
    { 5, 4, {{3, 4}, {2, 0}, {0, 5}, {5, 1}}},
    { 5, 4, {{3, 5}, {2, 0}, {0, 4}, {4, 1}}},
    { 5, 4, {{4, 5}, {2, 0}, {0, 3}, {3, 1}}},

    /* a wiggly line and a wiggly triangle */
    { 6, 4, {{0, 2}, {1, 3}, {3, 4}, {4, 1}}},
    { 6, 4, {{0, 2}, {1, 3}, {3, 5}, {5, 1}}},
    { 6, 4, {{0, 2}, {1, 4}, {4, 5}, {5, 1}}},
    { 6, 4, {{0, 2}, {3, 4}, {4, 5}, {5, 3}}},
    { 6, 4, {{0, 3}, {1, 4}, {4, 5}, {5, 1}}},
    { 6, 4, {{0, 4}, {1, 3}, {3, 5}, {5, 1}}},
    { 6, 4, {{0, 5}, {1, 3}, {3, 4}, {4, 1}}},
    { 6, 4, {{1, 3}, {0, 4}, {4, 5}, {5, 0}}},
    { 6, 4, {{1, 4}, {0, 3}, {3, 5}, {5, 0}}},
    { 6, 4, {{1, 5}, {0, 3}, {3, 4}, {4, 0}}},

    /* wiggly line a wiggly arrow */
    { 7, 4, {{0, 2}, {1, 3}, {1, 4}, {1, 5}}},
    { 7, 4, {{0, 2}, {3, 1}, {3, 4}, {3, 5}}},
    { 7, 4, {{0, 2}, {4, 1}, {4, 3}, {4, 5}}},
    { 7, 4, {{0, 2}, {5, 1}, {5, 3}, {5, 4}}},
    { 7, 4, {{1, 3}, {0, 2}, {0, 4}, {0, 5}}},
    { 7, 4, {{1, 4}, {0, 2}, {0, 3}, {0, 5}}},
    { 7, 4, {{1, 5}, {0, 2}, {0, 3}, {0, 4}}},

    /* wiggly line and a square */
    { 8, 5, {{2, 0}, {0, 3}, {3, 1}, {1, 4}, {4, 5}}},
    { 8, 5, {{2, 0}, {0, 3}, {3, 1}, {1, 5}, {5, 4}}},
    { 8, 5, {{2, 0}, {0, 3}, {3, 4}, {4, 5}, {5, 1}}},
    { 8, 5, {{2, 0}, {0, 3}, {3, 4}, {4, 1}, {1, 5}}},
    { 8, 5, {{2, 0}, {0, 3}, {3, 5}, {5, 1}, {1, 4}}},
    { 8, 5, {{2, 0}, {0, 3}, {3, 5}, {5, 4}, {4, 1}}},
    { 8, 5, {{2, 0}, {0, 4}, {4, 1}, {1, 3}, {3, 5}}},
    { 8, 5, {{2, 0}, {0, 4}, {4, 1}, {1, 5}, {5, 3}}},
    { 8, 5, {{2, 0}, {0, 4}, {4, 3}, {3, 5}, {5, 1}}},
    { 8, 5, {{2, 0}, {0, 4}, {4, 3}, {3, 1}, {1, 5}}},
    { 8, 5, {{2, 0}, {0, 4}, {4, 5}, {5, 1}, {1, 3}}},
    { 8, 5, {{2, 0}, {0, 4}, {4, 5}, {5, 3}, {3, 1}}},
    { 8, 5, {{2, 0}, {0, 5}, {5, 1}, {1, 3}, {3, 4}}},
    { 8, 5, {{2, 0}, {0, 5}, {5, 1}, {1, 4}, {4, 3}}},
    { 8, 5, {{2, 0}, {0, 5}, {5, 3}, {3, 4}, {4, 1}}},
    { 8, 5, {{2, 0}, {0, 5}, {5, 3}, {3, 1}, {1, 4}}},
    { 8, 5, {{2, 0}, {0, 5}, {5, 4}, {4, 1}, {1, 3}}},
    { 8, 5, {{2, 0}, {0, 5}, {5, 4}, {4, 3}, {3, 1}}},

    /* wiggly line and a square */
    { 9, 5, {{0, 2}, {1, 4}, {4, 3}, {3, 5}, {5, 1}}},
    { 9, 5, {{0, 2}, {1, 5}, {5, 4}, {4, 3}, {3, 1}}},
    { 9, 5, {{0, 2}, {1, 3}, {3, 5}, {5, 4}, {4, 1}}},

    /* wiggly 5-ring */
    {10, 5, {{0, 3}, {3, 1}, {1, 5}, {5, 4}, {4, 0}}},
    {10, 5, {{0, 3}, {3, 5}, {5, 1}, {1, 4}, {4, 0}}},
    {10, 5, {{0, 4}, {4, 1}, {1, 3}, {3, 5}, {5, 0}}},
    {10, 5, {{0, 4}, {4, 3}, {3, 1}, {1, 5}, {5, 0}}},
    {10, 5, {{0, 3}, {3, 1}, {1, 4}, {4, 5}, {5, 0}}},
    {10, 5, {{0, 3}, {3, 4}, {4, 1}, {1, 5}, {5, 0}}},

    /* wiggly line a wiggly umbrella */
    {11, 5, {{0, 2}, {3, 4}, {4, 5}, {5, 3}, {1, 3}}},
    {11, 5, {{0, 2}, {3, 4}, {4, 5}, {5, 3}, {1, 4}}},
    {11, 5, {{0, 2}, {3, 4}, {4, 5}, {5, 3}, {1, 5}}},
    {11, 5, {{0, 2}, {1, 4}, {4, 5}, {5, 1}, {3, 1}}},
    {11, 5, {{0, 2}, {1, 4}, {4, 5}, {5, 1}, {3, 4}}},
    {11, 5, {{0, 2}, {1, 4}, {4, 5}, {5, 1}, {3, 5}}},
    {11, 5, {{0, 2}, {1, 3}, {3, 5}, {5, 1}, {4, 1}}},
    {11, 5, {{0, 2}, {1, 3}, {3, 5}, {5, 1}, {4, 3}}},
    {11, 5, {{0, 2}, {1, 3}, {3, 5}, {5, 1}, {4, 5}}},
    {11, 5, {{0, 2}, {1, 3}, {3, 4}, {4, 1}, {5, 1}}},
    {11, 5, {{0, 2}, {1, 3}, {3, 4}, {4, 1}, {5, 3}}},
    {11, 5, {{0, 2}, {1, 3}, {3, 4}, {4, 1}, {5, 4}}},
    {11, 5, {{1, 3}, {0, 4}, {4, 5}, {5, 0}, {0, 2}}},
    {11, 5, {{1, 4}, {0, 3}, {3, 5}, {5, 0}, {0, 2}}},
    {11, 5, {{1, 5}, {0, 3}, {3, 4}, {4, 0}, {0, 2}}},

    /* no 12, 13, 17, 18, 19, 21, 22
     * because the claw center `2' connects to only one vertex
     * (due to the 4 wiggly lines),
     * but every vertex in the diagrams has a degree of >= 2 */

    /* triangle with a long tail */
    {14, 6, {{2, 0}, {0, 3}, {3, 1}, {1, 5}, {5, 4}, {4, 1}}},
    {14, 6, {{2, 0}, {0, 3}, {3, 4}, {4, 5}, {5, 1}, {1, 4}}},
    {14, 6, {{2, 0}, {0, 3}, {3, 5}, {5, 1}, {1, 4}, {4, 5}}},
    {14, 6, {{2, 0}, {0, 4}, {4, 1}, {1, 5}, {5, 3}, {3, 1}}},
    {14, 6, {{2, 0}, {0, 4}, {4, 3}, {3, 1}, {1, 5}, {5, 3}}},
    {14, 6, {{2, 0}, {0, 4}, {4, 5}, {5, 3}, {3, 1}, {1, 5}}},
    {14, 6, {{2, 0}, {0, 5}, {5, 1}, {1, 4}, {4, 3}, {3, 1}}},
    {14, 6, {{2, 0}, {0, 5}, {5, 3}, {3, 4}, {4, 1}, {1, 3}}},
    {14, 6, {{2, 0}, {0, 5}, {5, 4}, {4, 1}, {1, 3}, {3, 4}}},

    /* wiggly 5-ring with a tail */
    {15, 6, {{0, 2}, {0, 3}, {3, 1}, {1, 5}, {5, 4}, {4, 0}}},
    {15, 6, {{0, 2}, {0, 3}, {3, 5}, {5, 1}, {1, 4}, {4, 0}}},
    {15, 6, {{0, 2}, {0, 4}, {4, 1}, {1, 3}, {3, 5}, {5, 0}}},
    {15, 6, {{0, 2}, {0, 4}, {4, 3}, {3, 1}, {1, 5}, {5, 0}}},
    {15, 6, {{0, 2}, {0, 3}, {3, 1}, {1, 4}, {4, 5}, {5, 0}}},
    {15, 6, {{0, 2}, {0, 3}, {3, 4}, {4, 1}, {1, 5}, {5, 0}}},

    /* wiggly line with a diamond */
    {16, 6, {{0, 2}, {1, 4}, {1, 5}, {3, 4}, {3, 5}, {4, 5}}},
    {16, 6, {{0, 2}, {1, 3}, {1, 5}, {3, 4}, {3, 5}, {4, 5}}},
    {16, 6, {{0, 2}, {1, 3}, {1, 4}, {3, 4}, {3, 5}, {4, 5}}},
    {16, 6, {{0, 2}, {1, 3}, {1, 4}, {1, 5}, {3, 5}, {4, 5}}},
    {16, 6, {{0, 2}, {1, 3}, {1, 4}, {1, 5}, {3, 4}, {4, 5}}},
    {16, 6, {{0, 2}, {1, 3}, {1, 4}, {1, 5}, {3, 4}, {3, 5}}},

    {20, 7, {{0, 2}, {1, 3}, {1, 4}, {1, 5}, {3, 4}, {3, 5}, {4, 5}}},
    {-1, 0, {{0, 0}}},
  };

  for (ipr = 0; ipr < (1 << 15); ipr++)
    map[ipr] = mapb[ipr] = -1; /* invalid entry */
  draw_addwiggly(gchn, 6, map, dup); /* chain backbone */
  draw_addwiggly(gcln, 6, mapb, dup); /* claw backbone */

  /* compute multiplicity */
  for (k = 0; k < NDG6; k++)
    mul[k] = db[k].sc * db[k].degen * ((15 - db[k].npr) % 2 ? -1 : 1);

  rvn_zero(v[0]);
  rvn_zero(vb[0]);
  for (t = 1; t <= nsteps; t++) {
    /* spanning tree of chain topology */
    for (i = 0; i < 5; i++)
      rvn_add(v[i + 1], v[i], rvn_rndball0(u));
    rvn_copy(vb[1], v[1]);
    rvn_copy(vb[2], v[2]);
    rvn_copy(vb[3], v[3]);
    rvn_add(vb[4], vb[2], rvn_rndball0(u));
    rvn_add(vb[5], vb[2], rvn_rndball0(u));

    /* encode the connectivity */
    for (lnk = lnkb = 0, ipr = 0, i = 0; i < 5; i++)
      for (j = i + 1; j < 6; j++) {
        if (rvn_dist2(v[i], v[j]) < 1)
          lnk |= 1 << ipr;
        if (rvn_dist2(vb[i], vb[j]) < 1)
          lnkb |= 1 << ipr;
        ipr++;
      }

    if ((k = map[lnk]) >= 0) acc[k]++;  /* chain backbone */
    if ((k = mapb[lnkb]) >= 0) acc[k]++;  /* claw backbone */
  }

  norm1 = -5./720 * pow(2, 5);
  norm2 = -5./720 * pow(8, 5);
  for (tot = 0, k = 0; k < NDG6; k++) {
    x = 1. * acc[k] / nsteps / dup[k];
    tot += y = x * mul[k];
    printf("%2d A6_%-3s: acc %9.7f, dup %2d sc %+3d, sc*dg %+5d mul %+5d "
        "x*mul %+10.7f (%+9.6f,%+10.5f), tot %+10.7f (%+9.6f,%+10.5f)\n",
        k, db[k].name, x, dup[k], db[k].sc, db[k].sc * db[k].degen,
        mul[k], y, norm1 * y, norm2 * y, tot, norm1 * tot, norm2 * tot);
  }
  tot *= -5./720;
  printf("vir6: %.8f, %.7f, %.6f\n", tot, tot * pow(2, 5), tot * pow(8, 5));
  return tot;
}



int main(int argc, char *argv[])
{
  long nsteps = 10000000;
  int n = 6;

  /* Metropolis, Rosenbluth, Roksenbluth, Teller & Teller, J. Chem. Phys. 21, 6, 1087-1092, 1953
   * Ree, Hoover, J. Chem. Phys. 46, 4, 939-950, 1964
   * http://www.sklogwiki.org/SklogWiki/index.php/Hard_sphere:_virial_coefficients
   * B2  = b0 = 2 pi/3
   * B3  = 5/8 b0^2
   * B4  = 0.2869495 b0^3
   * B5  = 0.110252(1) b0^4
   * B6  = 0.03888198(91) b0^5
   * B7  = 0.01302354(91) b0^6
   * B8  = 0.0041832(11) b0^7
   * B9  = 0.0013094(13) b0^8
   * B10 = 0.0004035(15) b0^9 */
  if (argc > 1) n = atoi(argv[1]);
  if (argc > 2) nsteps = strtol(argv[2], NULL, 10);
  printf("D %d, n %d, %ld Monte Carlo moves\n", D, n, nsteps);

  if (n == 3) vir3(nsteps);
  else if (n == 4) vir4(nsteps);
  else if (n == 5) vir5(nsteps);
  else if (n == 6) vir6(nsteps);
  mtsave(NULL);
  return 0;
}

