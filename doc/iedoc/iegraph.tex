%\documentclass{revtex4-1}
% options: aip, jcp, reprint, preprint
\documentclass[preprint]{revtex4-1}
%\documentclass[notitlepage,preprint]{revtex4-1}
%\documentclass[aip,jcp,reprint,superscriptaddress]{revtex4-1}
%\documentclass[reprint]{revtex4-1}

\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{mathrsfs}
\usepackage{bm}
\usepackage{tikz}
\usepackage{multirow}
\usepackage{hyperref}
%\usepackage{dcolumn}
%\usepackage{graphicx}
%\usepackage{setspace}

\newtheorem{defn}{Definition}
\newtheorem{thrm}{Theorem}
\newtheorem{lemm}[thrm]{Lemma}
\newtheorem{prop}[thrm]{Proposition}

\newcommand{\vct}[1]{\mathbf{#1}}
\providecommand{\vr}{} % clear \vr
\renewcommand{\vr}{\vct{r}}
\newcommand{\vk}{\vct{k}}
\newcommand{\dvk}{\frac{d\vk}{(2\pi)^D}}
\newcommand{\tdvk}{\tfrac{d\vk}{(2\pi)^D}}
\newcommand{\vR}{\vct{R}}
\newcommand{\vK}{\vct{K}}

% add a superscript ``ex''
\newcommand{\supex}[1]{ { { #1 }^{ \mathrm{ex} } } }
\newcommand{\supexv}[1]{ { { #1 }^{ \mathrm{ex}, \, (v) } } }
\newcommand{\Pex}{\supex{P}}
\newcommand{\Pexv}{\supexv{P}}
\newcommand{\Fex}{\supex{F}}
\newcommand{\Fexv}{\supexv{F}}
\newcommand{\muex}{\supex{\mu}}
\newcommand{\muexv}{\supexv{\mu}}
\newcommand{\kex}{\supex{\kappa}}
\newcommand{\Chn}{\mathscr{C}}
%\newcommand{\Chn}{\mathcal{C}}
%\newcommand{\Chn}{\mathsf{C}}
% for the graph sum
\newcommand{\A}{\mathcal{A}}
% to denote a group
\newcommand{\G}{\mathsf{G}}
% to denote a dihedral group
\newcommand{\D}{\mathsf{D}}
\newcommand{\Hgroup}{\mathsf{H}}
\newcommand{\Aut}{\mathrm{Aut}}

\newcommand{\llbra}{[\![}
\newcommand{\llket}{]\!]}





\begin{document}

\title{Supplemental Material 2: Thermodynamic quantities in integral equations}

%\author{Cheng Zhang}
%\author{Chun-Liang Lai}
%\author{B. Montgomery Pettitt}
%\email{mpettitt@utmb.edu}
%\affiliation{
%  Sealy Center for Structural Biology and Molecular Physics,
%  Department of Biochemistry and Molecular Biology, \\
%  The University of Texas Medical Branch,
%  Galveston, Texas 7755, USA
%}
\begin{abstract}
We review a few classic formulae that extract thermodynamic quantities
  and virial coefficients from correlation functions.
%
For the Percus-Yevick closure,
  we give a simplification, Eq. \eqref{eq:pyPsimplified},
  of Baxter's pressure formula
  and show that it produces the same virial coefficients
  as the compressibility-route values.
%
We also derive an approximate formula, Eq. \eqref{eq:pyddpressure},
  for the second density derivative of pressure.
%
For the hypernetted-chain closure,
  we show that the classical formulae
  for the free energy, Eq. \eqref{eq:hncF},
  and chemical potential, Eq. \eqref{eq:hncmu},
  produce the same virial coefficients
  as the virial-route pressure formula.
\end{abstract}

\maketitle


%\tableofcontents




\section{Basics}

%For easy reference,
%we first repeat a few basic formulae in the main text.
%
The virial expansion is
%
\begin{equation}
  \beta P = \rho + B_2 \rho^2 + B_3 \rho^3 + \cdots,
\label{eq:virial}
\end{equation}
%
where $\beta = 1/(k_B T)$ is the inverse temperature.
%
The direct, indirect, and total correlation functions
  are denoted by $c(\vr)$, $t(\vr)$,
  and $h(\vr) \equiv c(\vr) + t(\vr)$,
  respectively.
%
The Ornstein-Zernike (OZ) relation\cite{hansen} reads
%
\begin{align}
  t(\vr) &= \rho [c * (c + t)](\vr), \notag \\
         &= \rho (c*c)(\vr) + \rho^2 (c*c*c)(\vr) + \cdots
\label{eq:oz}
\end{align}
%
where ``$*$'' denotes a convolution:
%\begin{equation*}
  $(a * b)(\vr) = \int d\vr' a(\vr - \vr') \, b(\vr')$.
%\label{eq:convol}
%\end{equation*}
%


A general closure is given by the following form
%
\begin{align}
  c(\vr)
&= [1 + f(\vr)] \, y(\vr) - t(\vr) - 1
  \notag \\
&= f(\vr) \, y(\vr) + \big[ y(\vr) - t(\vr) - 1 \big],
  \label{eq:closure}
\end{align}
%
where the cavity distribution function,
$y(\vr) \equiv g(\vr) \, e^{ \beta \phi(\vr) }$,
is to be approximated as some functional of $t(\vr)$.
%
The Percus-Yevick (PY) closure\cite{percusyevick}
assumes $y(\vr) = 1 + t(\vr)$.
%
So
%
\begin{equation}
  c(\vr) = f(\vr) + f(\vr) \, t(\vr),
  \label{eq:py}
\end{equation}
%
where
%
\begin{equation}
  f(\vr) = e^{-\beta \phi(\vr)} - 1,
  \label{eq:fbond}
\end{equation}
%
with $\phi(\vr)$ being the pair potential.
%
Alternatively,
the hypernetted-chain (HNC) closure\cite{
morita1958, *morita1959, *morita1960,
vanleeuwen1959, meeron1960,
verlet1960, green1960, rushbrooke1960}
assumes $y(\vr) = \exp { t(\vr) }$.
%
So
%
\begin{align}
c(\vr)
&= \big[ 1 + f(\vr) \big] \, e^{t(\vr)} - t(\vr) - 1
\notag \\
&= \sum_{m=0}^\infty
   \Big\{ \llbra m \ge 2 \llket + f(\vr) \Big\}
   \frac{ t^m(\vr) }{ m! },
\label{eq:hnc}
\end{align}
%
where
$\llbra P \llket$ denotes the Iverson bracket,
which is 1 if condition $P$ is true,
or 0 otherwise.



Below we shall express thermodynamic quantities
as integrals of $c(\vr)$ and $t(\vr)$
by a graphical analysis,
%
and the virial coefficients,
$B_n$ in Eq. \eqref{eq:virial},
can be found from these expressions.
%
Table \ref{tab:thermodyn}
summarizes the main results.





\ifdim \columnwidth < 4in
  \newcommand{\tabscale}{1.0}
\else
  % shrink the table in the preprint mode
  \newcommand{\tabscale}{0.85}
\fi

%\begin{turnpage}
\begin{table*}
\setlength{\tabcolsep}{2pt}
%\setlength\extrarowheight{4pt}
\caption{
  Thermodynamic quantities from integrals of $c(\vr)$ and $t(\vr)$
}
\label{tab:thermodyn}
% shrink the table in the preprint mode
\scalebox{\tabscale}{
\begin{tabular}{p{1.3cm} p{1.2cm} c l r p{1.6cm} c l}
  \hline
  \hline
  \noalign{\smallskip}
  %\phantom
  \multirow{2}{1.3cm}{ Graph sum$^\ast$ }
  &
  \multicolumn{3}{c}{PY}
  &
  \phantom &
  \multicolumn{3}{c}{HNC}
  \\
  %[-2mm]
  \cline{2-4}
  \cline{6-8}
  \noalign{\smallskip}
  %Graph sum$^\ast$
  &
  Quantity$^\sharp$ &
  Series$^\star$ &
  Integral &
  &
  Quantity$^\sharp$ &
  Series$^\star$ &
  Integral
  \\[-1mm]
  %\noalign{\smallskip}
  \hline
  \noalign{\smallskip}
  %
  %
  %
  %
  %
  $\begin{aligned} \sum_G \frac{ 2 \, I }{ s } \end{aligned}$ &
  %
  % PY
  %
  $\begin{aligned} -\beta \Pex \end{aligned}$
  &
  $\begin{aligned} -\sum_n B_n \rho^n \end{aligned}$
  &
  $\begin{aligned} \frac{\rho^2}{2} \int c \, (1 - h) \, d\vr
    - {S}^\S \end{aligned}$
  &
  &
  %
  % HNC
  %
  $\begin{aligned} -\frac{ 2 \beta \Fex }{ V } \end{aligned}$
  &
  $\begin{aligned} - \sum_n \frac{ 2 }{ n - 1 } B_n \rho^n \end{aligned}$
  &
  $\begin{aligned} \rho^2 \int \left( c - \frac{1}{2} h^2 \right) \, d\vr
    - {S}^\S \end{aligned}$
  \\
  %[4pt]
  \noalign{\smallskip}
  %
  %
  %
  %
  %
  $\begin{aligned} \sum_G \frac{ 2 \, n \, I }{ s } \end{aligned}$ &
  %
  % PY
  %
  $\begin{aligned} -\beta \kex^\dagger \end{aligned}$
  &
  $\begin{aligned} -\sum_n n B_n \rho^n \end{aligned}$
  &
  $\begin{aligned} \rho^2 \int c \, d\vr \end{aligned}$
  &
  &
  %
  % HNC
  %
  $\begin{aligned} -2 \rho \, \beta \muex^\ddagger \end{aligned}$
  &
  $\begin{aligned} -\sum_n \frac{ 2 n }{ n - 1 } B_n \rho^n \end{aligned}$
  &
  $\begin{aligned} \rho^2 \int (2 \, c - h \, t ) \, d\vr \end{aligned}$
  \\
  %[4pt]
  \noalign{\smallskip}
  %
  %
  %
  %
  %
  $\begin{aligned} \sum_G \frac{ 2 \, p \, I }{ s } \end{aligned}$
  &
  %
  % PY
  %
  $\begin{aligned} -\beta \supex{\chi}^{\P} \end{aligned}$
  &
  $\begin{aligned} -\sum_n n (n - 1) \, B_n \, \rho^n \end{aligned}$
  &
  $\begin{aligned} \rho^2 \int ( c + h \, t ) \, d\vr \end{aligned}$
  &
  &
  %
  % HNC
  %
  $\begin{aligned} -2 \beta \kex^\dagger \end{aligned}$
  &
  $\begin{aligned} -\sum_n 2 n B_n \rho^n \end{aligned}$
  &
  $\begin{aligned} \rho^2 \int 2 \, c \, d\vr \end{aligned}$
  \\
  %[4pt]
  \noalign{\smallskip}
  \hline
  \noalign{\smallskip}
  %
  %
  %
  %
  %
  %
  \multicolumn{8}{p{\textwidth}}{
    $^\ast$
    The sum is over the respective unrooted graphs $G$,
    which are the polygon packs in the PY case
    or the $c$-packs in the HNC case;
    $I$, $s$, $n$, $p$ are
    the integral,
    the symmetry number,
    the number of vertices,
    the number of ordered intra-face pairs (or pivots)
    of $G$, respectively.
  }
  \\
  \noalign{\smallskip}
  %
  \multicolumn{8}{l}{
    $^\sharp$
    The superscript ``ex'' means that the excess (non-ideal-gas) part.
  }
  \\
  \noalign{\smallskip}
  \multicolumn{8}{p{\textwidth}}{
    $^\star$
    The virial coefficient $B_n$ can be found by equating
    the density expansions of this and the next columns,
    e.g., the second row for the PY equation gives
    $B_n = -(1/n) \int c_{n-2} \, d\vr$.
  }
  \\
  \noalign{\smallskip}
  %
  \multicolumn{8}{l}{
    $^\S$
    $\begin{aligned}
        S
      \equiv
         \int \Big\{
                  \log\left[ 1 - \rho \, \tilde{c}(\vk)\right]
                 + \rho \, \tilde{c}(\vk)
              \Big\} \, \dvk
      \end{aligned}$.
    This function can be avoided by using the virial theorem
    [Sec. \ref{sec:virialtheorem}].
  }
  \\
  \noalign{\smallskip}
  %
  \multicolumn{8}{l}{
    $^\dagger$
    The bulk modulus is defined as
    $\begin{aligned}
        \kex
      \equiv
        \rho \, \partial \Pex / \partial \rho
    \end{aligned}$.
  }
  \\
  \noalign{\smallskip}
  %
  \multicolumn{8}{l}{
    $^\ddagger$
    The chemical potential is related to the pressure as
    $\begin{aligned}
        \rho \, \partial \muex / \partial \rho
      =
        \partial \Pex / \partial \rho
    \end{aligned}$.
  }
  \\
  \noalign{\smallskip}
  %
  \multicolumn{8}{l}{
    $\begin{aligned}
      ^\P \supex{\chi}
      \equiv
      \rho^2 ( \partial^2 \Pex / \partial \rho^2 )
    \end{aligned}$.
  }
  \\
  \noalign{\smallskip}
  \hline
\end{tabular}
} % \scalebox
\end{table*}
%\end{turnpage}



\tikzstyle{blackdot}=[circle,draw=black,fill=black,
                      inner sep=0pt,minimum size=1.5mm]
\tikzstyle{whitedot}=[circle,draw=black,fill=white,
                      inner sep=0pt,minimum size=1.5mm]
\tikzstyle{combine}=[green!30!black, very thick, densely dotted]
\tikzstyle{concat}=[blue!40!black, very thick, densely dashed]



\section{\label{sec:graph}Graphical representation of cluster integrals}



\subsection{Graph theory}

Here we briefly review the graphical representation
in liquid state theory\cite{hansen, mayer, uhlenbeck1962, morita1961III}.
%
We first list a few basic terms in the graph theory.
%
A \emph{graph}, or a \emph{diagram}, $G$ consists of
  a set of \emph{vertices} $V = \{v_1, \dots, v_n\}$
    (drawn as dots)
  and
  a set of \emph{edges} $E$ joining the vertices
    (drawn as lines).
%
Two vertices are \emph{adjacent} if they are joined by an edge;
%
two edges are \emph{adjacent} if they share a vertex.
%
An \emph{induced subgraph} $G(V')$ is obtained
  from keeping only a subset of vertices $V'$ of $V$
  and the edges between the vertices in $V'$.

A \emph{path} is formed by
  a sequence of adjacent edges
  joined in a head-to-tail fashion.
%
If the first and last vertices on the path coincide,
  the path is a \emph{cycle}.
%
A graph is \emph{connected}
  %if it is in one piece; that is,
  if any two vertices are joined by a path.
%
Further, a connected graph is \emph{biconnected}
  if removing any vertex and the adjacent edges
  leaves the graph connected.
%
In other words, a biconnected graph
  is free of any \emph{articulation point},
  whose removal disconnects the graph.
%
Similarly, a \emph{separation pair} is a pair of vertices
  whose removal along with the adjacent edges
  disconnects a connected graph.



\subsection{Graphs and integrals}

In liquid state theory,
  a graph represents an integral.
%
A vertex $i$ is associated to a spatial point at $\vr_i$.
%
A \emph{root} vertex,
  or simply a \emph{root} (drawn as a white dot),
  is specially designated,
  with given and fixed coordinates.
%
The coordinates of a non-root vertex
  (drawn as a black dot)
  are to be integrated out.
%
In our case, a non-root vertex
  also contributes a factor of $\rho$ (density)
  to the integrand.
%
An edge between vertices $i$ and $j$
  contributes a factor $f_{ij} \equiv f(\vr_{ij})$
  [defined in Eq. \eqref{eq:fbond}],
  with
  $\vr_{ij} \equiv \vr_i - \vr_j$.
%
For example,
\[
  {
  \begin{tikzpicture}[baseline=1.2mm]
    \newcommand{\sz}{2.0mm}
    \node (r1) at (-\sz, 0) [whitedot,label=left:{\footnotesize$1$}]{};
    \node (r2) at ( \sz, 0) [whitedot,label=right:{\footnotesize$2$}]{};
    \node (r3) at ( \sz, 2*\sz) [blackdot,label=right:{\footnotesize$3$}]{};
    \node (r4) at (-\sz, 2*\sz) [blackdot,label=left:{\footnotesize$4$}]{};
    \draw (r1) -- (r2) -- (r3) -- (r4) -- (r1) -- (r3);
  \end{tikzpicture}
  }
  =
  \rho^2 \int
    d\vr_3 \, d\vr_4 \,
    f_{12} f_{23} f_{34} f_{41} f_{13}.
\]



By the translational symmetry,
  a graph $A$ rooted at two vertices $1$ and $2$
  can be written as a function $a(\vr)$
  of $\vr \equiv \vr_{12}$
  (we use capital letters for graphs,
  and lowercase letters for the corresponding functions).
%
The spatial correlation functions,
  such as $c(\vr)$ and $t(\vr)$,
  are sums of 2-root graphs.



For a graph of no root,
  we avoid integrating the last vertex
  to keep the integral finite, e.g.,
%
%For example,
\[
  {
  \begin{tikzpicture}[baseline=1.8mm]
    \newcommand{\sz}{2.5mm}
    \node (r1) at (-\sz, 0) [blackdot,label=left:{\footnotesize$1$}]{};
    \node (r2) at ( \sz, 0) [blackdot,label=right:{\footnotesize$2$}]{};
    \node (r3) at ( 0, 1.8*\sz) [blackdot,label=above:{\footnotesize$3$}]{};
    \draw (r1) -- (r2) -- (r3) -- (r1);
  \end{tikzpicture}
  }
  =
  \rho^3 \int
    d\vr_2 \, d\vr_3 \,
    f_{12} f_{23} f_{31}.
\]
%
The choice of the last vertex is arbitrary
  for it alters only the origin of the integration,
  but not the value. % of the integral.





\subsection{Symmetry number}



We can remove the labels of
the non-root vertices (black dots)
in a labeled graph
to form an \emph{unlabeled} graph,
because non-root vertices are identical.
%
Note, however, that the roots (white dots)
are always labeled,
even if it is done implicitly.
%
For an unlabeled graph $G$,
after assuming an arbitrary labeling of
the non-root vertices,
we define the \emph{symmetry number}, $s(G)$,
as the number of ways of
permuting the labels of the non-root vertices that
keep the connections of $G$ unchanged\cite{
hansen, uhlenbeck1962}.
%
The connection-preserving permutations
form a group called the automorphism group, $\Aut(G)$,
and $s(G)$ is equal to its order:
%
\begin{equation*}
  s(G) \equiv | \Aut(G) |.
\end{equation*}
%
For example,
  $s\left({
  \begin{tikzpicture}[baseline=0.0mm]
    \newcommand{\sz}{1.7mm}
    \node (r1) at (-\sz, 0) [blackdot]{};
    \node (r2) at ( \sz, 0) [blackdot]{};
    \node (r3) at ( 0, 1.8*\sz) [blackdot]{};
    \draw (r1) -- (r2) -- (r3) -- (r1);
  \end{tikzpicture}
  }\right) = 3! = 6$,
  since the three black dots can be labeled arbitrarily;
but
  $s\left({
  \begin{tikzpicture}[baseline=0.8mm]
    \newcommand{\sz}{1.7mm}
    \node (r1) at (-\sz, 0) [whitedot]{};
    \node (r2) at ( \sz, 0) [whitedot]{};
    \node (r3) at ( \sz, 2*\sz) [blackdot]{};
    \node (r4) at (-\sz, 2*\sz) [blackdot]{};
    \draw (r1) -- (r2) -- (r3) -- (r4) -- (r1);
  \end{tikzpicture}
  }\right) = 1$,
  because the two white dots are distinguishable,
  and thus exchanging the two black dots alters the connection.





\subsection{\label{sec:bcsums}Sums of biconnected graphs}



We state without proving the following exact results\cite{hansen, mayer, uhlenbeck1962}.
%
The virial series in Eq. \eqref{eq:virial}
contains
all unrooted labeled biconnected graphs,
each weighted by $(1-n)/n!$
with $n$ being the number of vertices.
%
Equivalently, the series is the sum of
all unrooted \emph{unlabeled} biconnected graphs $G$
weighted by $(1-n)/s(G)$.
%
The series for $-\beta \Fex/V$,
with $\Fex$ being
the excess (non-ideal-gas) Helmholtz free energy,
is the sum of
all unrooted unlabeled biconnected graphs $G$
weighted by $1/s(G)$.
%
The series for $-\beta \muex$,
with $\muex$ being the excess chemical potential,
is the sum of
all one-root unlabeled biconnected graphs $G$
weighted by $1/s(G)$.
%
The series for $c(\vr)$ is the sum of
all two-root unlabeled biconnected graphs $G$
weighted by $1/s(G)$.



Unfortunately, not all biconnected graphs
can be produced by integral equations.
%
In either the PY or the HNC equation,
$c(\vr)$, for example,
contains only a subset of the biconnected graphs $G$,
and the weight may not be $1/s(G)$.
%
The hope, however, is that the missing graphs
are either negligible (HNC),
or self-canceling (PY).





\subsection{Series-parallel graphs}



In integral equations,
  $c(\vr)$ and $t(\vr)$
  only include
  \emph{series-parallel graphs},
%
which can be constructed
  hierarchically by successive
  serial and parallel compositions (defined below)
  starting from a few $f$-graphs\cite{eppstein1992}.



The \emph{parallel composition} $A \cdot B$
  of two 2-root graphs $A$ and $B$
  is formed by joining the corresponding roots,
%
e.g.,
%
\[
  \newcommand{\sz}{5mm}
  \newcommand{\dy}{.5*\sz}
  \newcommand{\oy}{\sz + 2*\dy}
  \newcommand{\py}{\sz + \dy}
  \newcommand{\wz}{1.4*\sz}
  \newcommand{\dx}{3.5*\sz}
  \newcommand{\px}{1.0*\wz + \dx}
  %
  %
  % example of parallel composition
  %
  %
  \begin{tikzpicture}[baseline=2.5mm]
    %
    % the two individual graphs
    %
    \node (r1)  at (-0.2*\wz, \oy)        [whitedot]{};
    \node (r2)  at ( 0.5*\wz, \oy + \sz)  [blackdot]{};
    \node (r3)  at ( 1.2*\wz, \oy)        [whitedot]{};
    %
    \node (r4)  at (-0.2*\wz, \sz)        [whitedot]{}
      edge[combine, bend left] (r1);
    \node (r5)  at ( 0.0*\wz, 0)          [blackdot]{};
    \node (r6)  at ( 1.0*\wz, 0)          [blackdot]{};
    \node (r7)  at ( 1.2*\wz, \sz)        [whitedot]{}
      edge[combine, bend right] (r3);
    %
    \draw[thick]
          (r1) -- (r2) -- (r3)
          (r4) -- (r5) -- (r6) -- (r7) (r4) -- (r6);

    %
    % the composite graph
    %
    \node (s1)  at (\px - 0.2*\wz, \py)       [whitedot]{};
    \node (s2)  at (\px + 0.5*\wz, \py + \sz) [blackdot]{};
    \node (s3)  at (\px + 1.2*\wz, \py)       [whitedot]{};
    \node (s5)  at (\px,           \py - \sz) [blackdot]{};
    \node (s6)  at (\px + 1.0*\wz, \py - \sz) [blackdot]{};
    \draw[thick]
          (s1) -- (s2) -- (s3)
          (s1) -- (s5) -- (s6) -- (s3) (s1) -- (s6);

    % the horizontal arrow between the two graphs
    \node (leftfig) at (\wz + \wz*.5, \py) {}
      edge[->, thick] (\px - \wz*.7, \py);
  \end{tikzpicture}
  \;.
\]
%
The value of $A \cdot B$
  is $a(\vr) \, b(\vr)$.
%
Generally,
  the parallel composition of several graphs $A_1$, \dots, $A_m$
  is equal to $a_1(\vr) \cdots a_m(\vr)$.


A \emph{series composition} $A*B$
  joins $A$ and $B$ in a head-to-tail manner, e.g.,
%
\[
  \newcommand{\sz}{6mm}
  \newcommand{\del}{1.0*\sz}
  \newcommand{\sep}{2.5*\sz}
  \newcommand{\px}{2*\sz + \del + \sep}
  %
  %
  % example of series composition (chain)
  %
  %
  \begin{tikzpicture}[baseline=0.5mm]
    %
    % the two individual graphs
    %
    \node (r1)  at (0,              0)        [whitedot]{};
    \node (r2)  at (.5*\sz,         0 + \sz)  [blackdot]{};
    \node (r3)  at (\sz,            0)        [whitedot]{};
    %
    \node (r4)  at (\sz + \del,     0)        [whitedot]{}
      edge[concat, bend left]  % [<->]
        node[anchor=south] {$*$} (r3);
    \node (r5)  at (1.0*\sz + \del, 0 + \sz)  [blackdot]{};
    \node (r6)  at (2.0*\sz + \del, 0 + \sz)  [blackdot]{};
    \node (r7)  at (2.0*\sz + \del, 0)        [whitedot]{};
    %
    \draw[thick]
          (r1) -- (r2) -- (r3) -- (r1)
          (r4) -- (r5) -- (r6) -- (r7) -- (r4) -- (r6);

    % the concatenated graph
    \node (s1)  at (\px,           0)        [whitedot]{};
    \node (s2)  at (\px + .5*\sz,  0 + \sz)  [blackdot]{};
    \node (s3)  at (\px + \sz,     0)        [blackdot]{};
    \node (s5)  at (\px + 1.0*\sz, 0 + \sz)  [blackdot]{};
    \node (s6)  at (\px + 2.0*\sz, 0 + \sz)  [blackdot]{};
    \node (s7)  at (\px + 2.0*\sz, 0)        [whitedot]{};
    \draw[thick]
          (s3) -- (s1) -- (s2) -- (s3) -- (s5) -- (s6) -- (s7) -- (s3) -- (s6);

    % the vertical arrow between the two graphs
    \node (leftfig) at (\px - 0.8*\sep, 0.5*\sz) {}
      edge[->, thick] (\px - 0.2*\sep, 0.5*\sz);
  \end{tikzpicture}
  \;.
\]
The merged and blackened root is called the \emph{joint}.
%
The value of $A*B$ is the convolution $\rho \cdot (a*b)(\vr)$.
%
Generally, a series composition,
  or a \emph{chain},
  of several graphs
  $A_1$, \dots, $A_l$ is equal to
  $\rho^{l-1} \cdot (a_1 * \cdots * a_l)(\vr)$,
and we call $A_1$, \dots, $A_l$
  the \emph{links} of the chain.



A \emph{cycle} is a circular series composition,
%
e.g.,
%
\[
  \newcommand{\sz}{5mm}
  \newcommand{\sep}{3.0*\sz}
  \newcommand{\px}{3*\sz + \sep}
  %
  %
  % example of circular concatenation (cycle)
  %
  %
  \begin{tikzpicture}[baseline=2mm]
    %
    % the three individual graphs
    %
    \node (r1)  at (-0.5*\sz,   0)            [whitedot]{};
    \node (r2)  at (-1.6*\sz,   0)            [blackdot]{};
    %\node (r2)  at (-1.716*\sz, 0 - .106*\sz) [blackdot]{};
    \node (r3)  at (-1.2*\sz,   0 + \sz)      [whitedot]{};
    %
    \node (r4)  at (-0.7*\sz,   0 + 1.8*\sz)  [whitedot]{}
      edge[concat, inner sep = 0pt, bend right]
        node[anchor=north west] {$*$} (r3);
    \node (r5)  at (-0.5*\sz,   0 + 2.5*\sz)  [blackdot]{};
    \node (r6)  at ( 0.5*\sz,   0 + 2.5*\sz)  [blackdot]{};
    \node (r7)  at ( 0.7*\sz,   0 + 1.8*\sz)  [whitedot]{};
    %
    \node (r8)  at ( 1.2*\sz,   0 + \sz)      [whitedot]{}
      edge[concat, inner sep = 0pt, bend right]
        node[anchor=north east] {$*$} (r7);
    \node (r9)  at ( 1.6*\sz,   0)            [blackdot]{};
    \node (r10) at ( 0.5*\sz,   0)            [whitedot]{}
      edge[concat] (r1);
      %edge[concat, inner sep = 3pt, bend left]
        %node[anchor=south] {$*$} (r1);
    %
    \draw [thick]
      (r1) -- (r2) -- (r3) -- (r1)
      (r4) -- (r5) -- (r6) -- (r7) -- (r4)
      (r8) -- (r9) -- (r10) -- (r8);

    %
    % the concatenated graph
    %
    \node (s1)  at (\px +         0, 0)            [blackdot]{};
    %\node (s2)  at (\px - 1.216*\sz, 0 - .106*\sz) [blackdot]{};
    \node (s2)  at (\px - 1.1*\sz,   0)            [blackdot]{};
    \node (s3)  at (\px - 0.7*\sz,   0 + \sz)      [blackdot]{};
    %
    \node (s5)  at (\px - 0.5*\sz,   0 + 1.7*\sz)  [blackdot]{};
    \node (s6)  at (\px + 0.5*\sz,   0 + 1.7*\sz)  [blackdot]{};
    \node (s7)  at (\px + 0.7*\sz,   0 + 1*\sz)    [blackdot]{};
    %
    \node (s9)  at (\px + 1.1*\sz,   0*\sz) [blackdot]{};
    %
    \draw [thick]
      (s1) -- (s2) -- (s3) -- (s1)
      (s3) -- (s5) -- (s6) -- (s7) -- (s3)
      (s7) -- (s9) -- (s1) -- (s7);

    % the vertical arrow between the two graphs
    \node (topfig) at (\px -1.2*\sz - 0.9*\sep, 1.0*\sz) {}
      edge[->, thick] (\px -1.2*\sz - 0.2*\sep, 1.0*\sz);
  \end{tikzpicture}
  \;.
\]
%
A cycle of $A_1$, \dots, $A_l$ is equal to
%
\begin{multline}
      \rho^l (a_1 * \cdots * a_l)(\vct{0})
  =
      \rho^l
      \int \tilde{a}_1(\vk) \cdots \tilde{a}_l(\vk) \, \dvk
      \\
  =
      \rho^l
      \int (a_1 * \cdots * a_{l-1})(\vr) \, a_l(\vr) \, d\vr,
\label{eq:cyclesp}
\end{multline}
%
where
  $\tilde{a}_i(\vk) = \int a_i(\vr) \, \exp(-i \vk \cdot \vr) \, d\vr$
  denotes the Fourier transform of $a_i(\vr)$ ($1 \le i \le l$).
%
On the second line,
  we have assumed that
  $a_l(\vr)$ is an even function of $\vr$,
  and
  $a_l(\vr) = a_l(-\vr)$.
%
In this case,
  the cycle can be written as a parallel composition
  of the chain $A_1 * \cdots * A_{l-1}$ and $A_l$.
%
Particularly,
%
\begin{align}
      (a * b)(\vct{0})
      %\notag \\
  =
      \int \tilde{a}(\vk) \, \tilde{b}(\vk) \, \dvk
  =
      \int a(\vr) \, b(\vr) \, d\vr,
\label{eq:cyclesp2}
\end{align}
%
Using Eq. \eqref{eq:cyclesp2} in Eq. \eqref{eq:oz} gives
  a zero-separation theorem\cite{rosenfeld1979}
%
\begin{align}
  t(\vct{0})
  &= \rho \int c(\vr) [c(\vr) + t(\vr)] \, d\vr
  = -1 - c(\vct{0}),
\label{eq:zerosep}
\end{align}
%
where the second step follows from
  $g(\vct{0}) = 0$ [assuming $\phi(\vct{0}) = \infty$].





\subsection{Graphical interpretation of the closure}



We state a general relationship between the indirect correlation function
  and the cavity distribution function $y(\vr)$.
%
In Eq. \eqref{eq:closure},
since $y(\vr)$ and $t(\vr)$
collect graphs with nonadjacent roots only,
we have
%
\begin{lemm}
The graphs in the expansion of $c(\vr)$
  can be split into two exclusive parts:
  those with adjacent roots belong to
  the expansion of $y(\vr)\, f(\vr)$,
  and the rest belong to
  the expansion of $y(\vr) - t(\vr) - 1$.
%
Conversely,
  all graphs in the expansions of $y(\vr) \, f(\vr)$
  and $y(\vr) - t(\vr) - 1$
  are contained in the expansion of $c(\vr)$.
\label{thm:crsplit}
\end{lemm}
%





\section{\label{sec:py}PY equation and polygon graphs}




\subsection{Polygon graphs}



We now characterize the graphs involved in $c(\vr)$
  in the PY closure, Eq. \eqref{eq:py}.
%
A \emph{polygon graph} $G$ satisfies
  %
  (i) the vertices of $G$ can be placed
  %on a polygon inscribed in a circle,
  on a convex polygon
  with no edges intersecting,
  %and labelled from 1 to $n$ in a clockwise fashion,
  %such that no two edges are intersecting;
  %
  %(ii) the consecutive vertices
  %$1$ and $2$, $2$ and $3$, \ldots,
  %or $n$ and $1$ ($\equiv n+1$) are adjacent.
  (ii) all sides of the polygon are edges,
  %
  (iii) the two roots lie on a side of the polygon. % (unless indicated otherwise).
%
We label the vertices from $1$ to $n$ in a clockwise fashion,
  and mark vertices $1$ and $n$ as the only two roots.
%
If $n = 2$, the graph
  \begin{tikzpicture}
    \node (r1) at (-3mm, 0) [whitedot]{};
    \node (r2) at ( 3mm, 0) [whitedot]{};
    \draw (r1) -- (r2);
  \end{tikzpicture},
  or the \emph{$f$-graph} hereinafter,
  is also included as a polygon graph.
%
Further,
  a \emph{pie graph}
  is defined as
  a polygon graph with a missing edge between the roots.
%
Below are two examples.
%
\[
  %
  %
  % example of a polygon graph
  % (left panel)
  %
  %
  \newcommand{\sz}{0.6cm}
  \begin{tikzpicture}
    \node (r1) at (-90+360.0/7*6.5 : \sz) [whitedot,label=left:\small{$1$}]{};
    \node (r2) at (-90+360.0/7*5.5 : \sz) [blackdot,label=left:\small{$2$}]{};
    \node (r3) at (-90+360.0/7*4.5 : \sz) [blackdot,label=left:\small{$3$}]{};
    \node (r5) at (-90+360.0/7*2.5 : \sz) [blackdot,label=right:\small{$n-2$}]{};
    \node (r6) at (-90+360.0/7*1.5 : \sz) [blackdot,label=right:\small{$n-1$}]{};
    \node (r7) at (-90+360.0/7*0.5 : \sz) [whitedot,label=right:\small{$n$}]{};
    \node (r4) at (-90+360.0/7*3.5 : \sz) [blackdot,label=above:\small{}]{}
      edge[densely dotted, thick, bend right=15] (r3)
      edge[densely dotted, thick, bend left=15] (r5);
    \draw[thick]
          (r1) -- (r2) -- (r3) (r5) -- (r6) -- (r7) -- (r1)
          (r2) -- (r4) (r5) -- (r1) (r5) -- (r7);
    \node (polygon) at (0, -\sz-0.2) [anchor=north] {Polygon graph};
  \end{tikzpicture}
  \hphantom{wwwww}
  %
  %
  % example of a pie graph
  % (right panel)
  %
  %
  \begin{tikzpicture}
    \node (r1) at (-90+360.0/7*6.5 : \sz) [whitedot,label=left:\small{$1$}]{};
    \node (r2) at (-90+360.0/7*5.5 : \sz) [blackdot,label=left:\small{$2$}]{};
    \node (r3) at (-90+360.0/7*4.5 : \sz) [blackdot,label=left:\small{$3$}]{};
    \node (r5) at (-90+360.0/7*2.5 : \sz) [blackdot,label=right:\small{$n-2$}]{};
    \node (r6) at (-90+360.0/7*1.5 : \sz) [blackdot,label=right:\small{$n-1$}]{};
    \node (r7) at (-90+360.0/7*0.5 : \sz) [whitedot,label=right:\small{$n$}]{};
    \node (r4) at (-90+360.0/7*3.5 : \sz) [blackdot,label=above:\small{}]{}
      edge[densely dotted, thick, bend right=15] (r3)
      edge[densely dotted, thick, bend left=15] (r5);
    \draw[thick]
          (r4) -- (r1) -- (r2) -- (r3)
          (r5) -- (r6) -- (r7)
          (r6) -- (r4) -- (r7);
    \node (pie) at (0, -\sz-0.2) [anchor=north] {Pie graph};
  \end{tikzpicture}
\]



\begin{lemm}
A pie graph is equivalent to
  a chain of polygon graphs.
\label{thm:pycat}
\end{lemm}

\begin{proof}
To show that every pie graph is a chain of polygon graphs,
we assume the contrary and
%
let $G$ be the smallest pie graph
  that is not a chain,
%
and $v$ be the last vertex adjacent to $1$ ($2 \le v < n$).
%
The induced subgraph $G^{(1)} = G(\{1, \dots, v\})$
  clearly forms a polygon graph.
%
If $v$ and $n$ are adjacent [case (a) below],
  the induced subgraph $G^{(2)} = (\{v, \dots, n\})$
  also forms a polygon graph,
  and $G = G^{(1)} * G^{(2)}$ is a chain,
  which is a contradiction.
%
Otherwise [case (b)], $G^{(2)}$ is a pie graph
  rooted at $v$ and $n$,
  and $G^{(2)}$ is smaller than $G$,
  which is also a contradiction.

\[
  \newcommand{\sz}{0.7cm}
  \begin{tikzpicture}
    \node (r1) at (-90+360.0/7*6.5 : \sz) [whitedot,label=left:{\footnotesize$1$}]{};
    \node (r2) at (-90+360.0/7*5.5 : \sz) [blackdot,label=left:{\footnotesize$2$}]{};
    \node (r3) at (-90+360.0/7*4.5 : \sz) [blackdot,label=left:{\footnotesize$3$}]{};
    \node (r5) at (-90+360.0/7*2.5 : \sz) [blackdot]{};
    \node (r6) at (-90+360.0/7*1.5 : \sz) [blackdot,label=right:{\footnotesize$n-1$}]{};
    \node (r7) at (-90+360.0/7*0.5 : \sz) [whitedot,label=right:{\footnotesize$n$}]{};
    \node (r4) at (-90+360.0/7*3.5 : \sz) [blackdot,label=above:{\footnotesize$v$}]{}
      edge[densely dotted, thick, bend right=15] (r3)
      edge[densely dotted, thick, bend left=15] (r5);
    \draw[thick]
          (r4) -- (r1) -- (r2) -- (r3)
          (r5) -- (r6) -- (r7) -- (r5)
          (r4) -- (r7);
    % beginning of G^1
    \draw[thick, fill=blue!20!gray, opacity=0.2, draw=blue]
      plot [smooth cycle]
      coordinates{
                   (-90+360.0/7*6.7 : 1.3*\sz)
                   (-90+360.0/7*5.6 : 1.7*\sz)
                   (-90+360.0/7*4.6 : 1.6*\sz)
                   (-90+360.0/7*3.3 : 1.1*\sz) };
    \node (G1) at (-2.0*\sz, 1.0*\sz) [blue] {$G^{(1)}$};
    % end of G1

    % beginning of G^2
    \draw[thick, fill=red, opacity=0.2, draw=red!50!black]
      plot [smooth cycle]
      coordinates{
                   (-90+360.0/7*3.7 : 1.1*\sz)
                   (-90+360.0/7*2.6 : 1.4*\sz)
                   %(-90+360.0/7*1.6 : 1.6*\sz)
                   (2.5*\sz, -0.3*\sz)
                   (-90+360.0/7*0.3 : 1.3*\sz) };
    \node (G2) at (2.2*\sz, 1.0*\sz) [red!80!black] {$G^{(2)}$};
    % end of G2

    \node (pie) at (0, -\sz-0.4*\sz) [anchor=north]
      {(a) $v$ and $n$ are adjacent};
  \end{tikzpicture}
  \;
  \begin{tikzpicture}
    \node (r1) at (-90+360.0/7*6.5 : \sz) [whitedot,label=left:{\footnotesize$1$}]{};
    \node (r2) at (-90+360.0/7*5.5 : \sz) [blackdot,label=left:{\footnotesize$2$}]{};
    \node (r3) at (-90+360.0/7*4.5 : \sz) [blackdot,label=left:{\footnotesize$3$}]{};
    \node (r5) at (-90+360.0/7*2.5 : \sz) [blackdot]{};
    \node (r6) at (-90+360.0/7*1.5 : \sz) [blackdot,label=right:{\footnotesize$n-1$}]{};
    \node (r7) at (-90+360.0/7*0.5 : \sz) [whitedot,label=right:{\footnotesize$n$}]{};
    \node (r4) at (-90+360.0/7*3.5 : \sz) [blackdot,label=above:{\footnotesize$v$}]{}
      edge[densely dotted, thick, bend right=15] (r3)
      edge[densely dotted, thick, bend left=15] (r5);
    \draw[thick]
          (r4) -- (r1) -- (r2) -- (r3)
          (r5) -- (r6) -- (r7) -- (r5);

    % beginning of G^1
    \draw[thick, fill=blue!20!gray, opacity=0.2, draw=blue]
      plot [smooth cycle]
      coordinates{
                   (-90+360.0/7*6.7 : 1.3*\sz)
                   (-90+360.0/7*5.6 : 1.7*\sz)
                   (-90+360.0/7*4.6 : 1.6*\sz)
                   (-90+360.0/7*3.3 : 1.1*\sz) };
    \node (G1) at (-2.0*\sz, 1.0*\sz) [blue] {$G^{(1)}$};
    % end of G1

    % beginning of G^2
    \draw[thick, fill=green, opacity=0.2, draw=green!50!black]
      plot [smooth cycle]
      coordinates{
                   (-90+360.0/7*3.7 : 1.2*\sz)
                   (-90+360.0/7*2.6 : 1.4*\sz)
                   (2.5*\sz,  0.2*\sz)
                   (2.3*\sz, -0.9*\sz)
                   (-90+360.0/7*0.3 : 1.3*\sz)
                   (-90+360.0/7*2.5 : 0.4*\sz)
                 };
    \node (G2) at (2.2*\sz, 1.0*\sz) [green!50!black] {$G^{(2)}$};
    % end of G2

    \node (pie) at (0, -\sz-0.4*\sz) [anchor=north]
      {(b) $v$ and $n$ are not adjacent};
  \end{tikzpicture}
\]

The converse is obvious.
%Conversely,
%  let $G=G^{(1)}*\cdots*G^{(l)}$,
%  and $v^{(i)}_j$ be the $j$th vertex of $G^{(i)}$.
%%
%It is readily seen that the ordering
%  $v^{(1)}_1 = 1$,
%  $v^{(1)}_2 = 2$,
%  \dots,
%  $v^{(1)}_{n_1 - 1}$, % = n_1 - 1$,
%  %
%  $v^{(2)}_1 \left( \equiv v^{(1)}_{n_1} \right)$,
%  $v^{(2)}_2$,
%  \dots,
%  $v^{(2)}_{n_2 - 2}$, % = n_1 + n_2 - 2$,
%  %
%  \dots,
%  $v^{(l)}_{n_l}$
%%
%  produces a pie graph.
\end{proof}



Given a polygon graph $G$,
even without knowing the labels of the non-root vertices,
we can recursively decompose the corresponding pie graph $G'$
(which differs from $G$ by a missing edge between the roots)
and determine the proper labels of all non-root vertices.
%
Thus
the labels of the non-root vertices of $G$
can be uniquely determined.
%
It follows that

\begin{lemm}
The symmetry number $s(G)$ of a polygon graph $G$ is always unity.
\label{thm:polygonsymnum}
\end{lemm}



We now use polygon and pie graphs to characters
  graphs in the PY equation.

\begin{lemm}
In the PY equation,
  $c(\vr)$ is the unweighted sum of
  all nonequivalent polygon graphs,
  and $t(\vr)$ is that of all nonequivalent
  pie graphs\cite{rice1965}.
\label{thm:pycrsum}
\end{lemm}

\begin{proof}
We show this by an induction on the number of vertices $n$ in
  graphs included in $c(\vr)$ or $t(\vr)$.
%
The statement obviously holds for $n \le 3$.
%
Suppose it remains so for $n \le k$,
consider the case of $n = k + 1$.

The OZ relation, Eq. \eqref{eq:oz},
  shows that every graph in $t(\vr)$
  is a chain of smaller polygon graphs,
  hence a pie graph by Lemma \ref{thm:pycat}.

The PY closure, Eq. \eqref{eq:py}, generates
  an $n$-vertex graph $G$ in $c(\vr)$
  by adding the edge between the roots
  to some $n$-vertex graph in $t(\vr)$.
%
Thus, $G$ is a polygon graph.

We can similarly show the converse:
  every polygon or pie graph
  is contained in the graphical expansion
  of $c(\vr)$ or $t(\vr)$,
  respectively.
\end{proof}


%In terms of labelled graphs, which do not have the symmetry number,
%we say that
%%
%\begin{lemm}
%In the PY equation,
%  $c(\vr)$ is the sum of
%  all nonequivalent \emph{labelled} polygon graphs $G$,
%  each weighted by $[n(G) - 2]!$,
%  with $n(G)$ being the number of vertices in $G$;
%  and $t(\vr)$ is that of all nonequivalent
%  labelled pie graphs.
%\label{thm:pycrsum_l}
%\end{lemm}



\subsection{Polygon packs}



A \emph{polygon pack} $G$ is obtained
  by blackening the two white dots (roots) of a polygon graph $H$.
%
The blackening operation is equivalent to the integration $\rho^2 \int d\vr$.
%
Therefore, in the expansion of $\rho^2 \int c(\vr) \, d\vr$,
  a polygon pack $G$ carries weight $w(G)$
  that is equal to the number of polygon graphs $H$ that
  can be reduced to the same $G$ after the roots-blackening.

Now, for a given polygon pack $G$,
  whitening two vertices on any side of
  a polygon pack $G$
  yields a polygon graph $H'$
  (although $H'$ may be different from the original $H$).
%  and there are $2n$ possible $H'$ with $2$ for each side
%
One can further show that
  whitening a nonadjacent pair of vertices always yields
  a non-polygon graph,
  for it always produces intersecting edges,
  no matter how the black dots are labeled.
%
Thus,
  the largest possible symmetry group of
  permuting vertices in a polygon graph
  is the dihedral group,
  which allows only cycling vertex labels along the perimeter,
  and/or reversing all the labels.
%
The automorphism group, $\Aut(G)$,
  is necessarily a subgroup of the dihedral group,
  whose order is $2 \, n(G)$.
%
The symmetry number $s(G)$,
  which is the order of $\Aut(G)$,
  is therefore a divisor of $2 \, n(G)$,
  by Lagrange's theorem.
%
Further,
  the number of cosets of the automorphism group,
  which is equal to $w(G)$, the number of ways of
  producing nonequivalent vertex labels by permutation,
  is given by $2 \, n(G) / s(G)$.
%
In summary,
%To satisfy Lemma \ref{thm:pycrsum},
%  a nonequivalent polygon pack $G$ appears $2 \, n/s(G)$ times
%  in $\rho^2 \int c(\vr) \, d\vr$,
%  where $s(G)$ is the symmetry number.
%%
%Note that since $s(G)$ is the number of ways of relabeling the vertices
%  that keep $G$ unchanged,
%$2n/s$ is the number of nonequivalent polygon graphs
%  that can be reduced to the same polygon pack.
%%
\begin{lemm}
In the PY equation,
  $\rho^2 \int c(\vr) \, d\vr$ is the sum of
  all nonequivalent polygon packs $G$:
  %
  \begin{equation}
      \rho^2 \int c(\vr) \, d\vr
    = \sum_{G} \frac{ 2 \, n(G) \, I(G) }{ s(G) }.
  \label{eq:pykappasum}
  \end{equation}
  %
  where $n(G)$, $s(G)$, and $I(G)$ are
  the number of vertices,
  the symmetry number,
  and the integral of $G$,
  respectively.
  \label{thm:pykappasum}
\end{lemm}
%
Note that the $n = 2$ case is special,
  for the $f$-graph does not form a polygon.
Thus, $s(G)$ in Eq. \eqref{eq:pykappasum}
is understood to be equal to $4$ in this case.

We give two examples.
For
$G_1 = {\begin{tikzpicture}[baseline=-1mm]
      \newcommand{\hh}{2.0mm}
      \node (r1) at (-\hh, -\hh) [blackdot]{};
      \node (r2) at ( \hh, -\hh) [blackdot]{};
      \node (r3) at ( \hh,  \hh) [blackdot]{};
      \node (r4) at (-\hh,  \hh) [blackdot]{};
      \draw (r1) -- (r2) -- (r3) -- (r4) -- (r1);
  \end{tikzpicture}}$,
we have
$s(G_1) = 8$, and
the weight in Eq. \eqref{eq:pykappasum}
is $w(G_1) = 2\times 4/8 = 1$,
because whitening the two vertices on any side
yields the same polygon graph
${\begin{tikzpicture}[baseline=-1mm]
      \newcommand{\hh}{2.0mm}
      \node (r1) at (-\hh, -\hh) [whitedot]{};
      \node (r2) at ( \hh, -\hh) [whitedot]{};
      \node (r3) at ( \hh,  \hh) [blackdot]{};
      \node (r4) at (-\hh,  \hh) [blackdot]{};
      \draw (r1) -- (r2) -- (r3) -- (r4) -- (r1);
  \end{tikzpicture}}$.
%
On the other hand, for
%
$G_2 = {
    \begin{tikzpicture}[baseline=-1mm]
      \newcommand{\hh}{0.7mm}
      \node (r1) at (-2.3*\hh, -4*\hh) [blackdot]{};
      \node (r2) at (-4.6*\hh,  0.0) [blackdot]{};
      \node (r3) at (-2.3*\hh,  4*\hh) [blackdot]{};
      \node (r4) at ( 2.3*\hh,  4*\hh) [blackdot]{};
      \node (r5) at ( 4.6*\hh,  0.0) [blackdot]{};
      \node (r6) at ( 2.3*\hh, -4*\hh) [blackdot]{};
      \draw (r1) -- (r2) -- (r3) -- (r4) -- (r5) -- (r6) -- (r1)
            (r1) -- (r5) (r1) -- (r4);
    \end{tikzpicture}
  }$,
$s(G_2) = 1$, and $w(G_2) = 2\times 6 = 12$.
This means that whitening the two vertices on any side of the polygon
in either order yields a distinct polygon graph.


%We can write Eq. \eqref{eq:pykappasum}
%in functional differentiation
%\begin{align*}
%  \frac {\delta } { \delta f_\mathrm{side}(\vr) }
%  \left[ \sum_G \frac{ I(G) }{ s(G) } \right]
%  =
%  \frac{\rho^2}{2} \frac{ c(\vr) } { f(\vr) }
%  =
%  \frac{\rho^2}{2}
%  [ 1 + t(\vr) ]
%\end{align*}




\subsection{Face decomposition of a polygon pack}




%\begin{lemm}
%A polygon graph of three or more vertices
%  is equivalent to
%  a cycle of three or more polygon graphs.
%\label{thm:pycatc}
%\end{lemm}
%
%\begin{proof}
%By removing the edge between the roots,
%  we get a pie graph,
%  which is a chain of polygon graphs
%  by Lemma \ref{thm:pycat}.
%%
%The chain is closed by the edge between the roots,
%  which is also a polygon graph,
%  to form a cycle.
%
%Conversely,
%  we can order the vertices in a manner similar to
%  that in the proof of Lemma \ref{thm:pycat},
%  and show that it produces a polygon graph.
%\end{proof}



A polygon graph or pack
  can always be decomposed as a cycle of smaller polygon graphs.
%
%removing the edge between the roots in a polygon graph
%  yields a chain of polygon graphs,
%  which can be closed
%  by the edge between the roots
%  to form a cycle.
%
%The cycle decomposition is, however, not unique.
%
Geometrically,
  each face of the polygon corresponds to a distinct cycle decomposition,
%
  as illustrated below.
%
\begin{equation*}
  %
  \newcommand\sz{0.8}
  \newcommand\del{0.1}
  \newcommand\osa{3.5*\sz}
  \newcommand\osb{7*\sz}
  \newcommand\dd{0.2*\sz}
  %
  \begin{tikzpicture}
  %
  % part 1
  %
    \node (r1) at (-90+60.0*5.5 : \sz) [blackdot]{};
    \node (r2) at (-90+60.0*4.5 : \sz) [blackdot]{};
    \node (r3) at (-90+60.0*3.5 : \sz) [blackdot]{};
    \node (r4) at (-90+60.0*2.5 : \sz) [blackdot]{};
    \node (r5) at (-90+60.0*1.5 : \sz) [blackdot]{};
    \node (r6) at (-90+60.0*0.5 : \sz) [blackdot]{};
    \draw[thick] (r1) -- (r2) -- (r3) -- (r4) -- (r5) -- (r6) -- (r1);
    \draw[thick] (r2) -- (r4) (r5) -- (r1);
    \draw[blue!70, thick, dashed]
        (-\sz+\dd, 0) -- (-0.5*\sz+0.5*\dd, -0.866*\sz+0.866*\dd)
     -- ( \sz-\dd, 0) -- ( 0.5*\sz-0.5*\dd,  0.866*\sz-0.866*\dd) -- cycle;
  %
  % part 2
  %
    \node (r1r) at (\osa-0.5*\sz-\del, -0.866*\sz+.4*\del) [whitedot]{};
    \node (r2r) at (\osa-1.0*\sz, -\del) [whitedot]{};
    \draw[thick] (r1r) -- (r2r);

    \node (r4r) at (\osa+0.5*\sz+\del,  0.866*\sz-.4*\del) [whitedot]{};
    \node (r5r) at (\osa+1.0*\sz,  \del) [whitedot]{};
    \draw[thick] (r4r) -- (r5r);

    \node (r2p) at (\osa-1.0*\sz,  \del) [whitedot]{};
    \node (r3p) at (\osa-0.5*\sz,  0.866*\sz) [blackdot]{};
    \node (r4p) at (\osa+0.5*\sz-\del,  0.866*\sz) [whitedot]{};
    \draw[thick] (r2p) -- (r3p) -- (r4p) -- (r2p);

    \node (r5q) at (\osa+1.0*\sz, -\del) [whitedot]{};
    \node (r6q) at (\osa+0.5*\sz, -0.866*\sz) [blackdot]{};
    \node (r1q) at (\osa-0.5*\sz+\del, -0.866*\sz) [whitedot]{};
    \draw[thick] (r5q) -- (r6q) -- (r1q) -- (r5q);

    \draw[->,very thick] (1.2*\sz, 0) to (\osa-1.2*\sz, 0);
  \end{tikzpicture}
  %
\end{equation*}



If $G$ has $m(G)$ faces, then by counting vertices, we get
%
\begin{equation}
  n(G) = 2 + \sum_{a = 1}^{m(G)} (l_a - 2)
       = 2 + \sum_{l = 3}^\infty (l - 2) \, m_l(G),
\label{eq:countvertices}
\end{equation}
%
where
  $l_a$ is the number of vertices in face $a$,
%
and
  $m_l(G)$ is the number of faces of $l$ vertices in $G$.
%
Similarly, the number of ordered intra-face vertex pairs
  $p(G)$ satisfies
%
\begin{align}
  p(G)  &= 2 + \sum_{a} \left[ l_a (l_a - 1) - 2 \right]
                        \notag \\
        &= 2 + \sum_{l = 3}^\infty m_l(G) \, [l(l-1) - 2],
\label{eq:countpairs}
\end{align}
%
where $l_a (l_a - 1)$ gives the number of pairs in face $a$,
  and the ``$-2$'' % in the square brackets
  offsets the double-counting
  for each edge shared by two adjacent faces.

Equations \eqref{eq:countvertices} and \eqref{eq:countpairs}
will be adapted to the HNC case in Sec. \ref{sec:hncFexmuex}.





\subsection{Cycle sums}





Using Eq. \eqref{eq:countvertices} in Eq. \eqref{eq:pykappasum} yields
%
\begin{equation}
    \rho^2 \int c(\vr) \, d\vr
  = \sum_G \frac{ 4 \, I(G) }{ s(G) }
  + \sum_{l = 3}^\infty 2 (l - 2) \, \Chn_l,
\label{eq:pyintgcr2sums}
\end{equation}
%
where
$\Chn_l \equiv \sum_G m_l(G) \, I(G) / s(G)$
is the sum of all cycles of length $l$ in all $G$.
%
To evaluate $\Chn_l$, we need the following lemma.

\begin{lemm}
The cycle sum $\Chn_l$ satisfies
\begin{align}
      \Chn_l
  \equiv
      \sum_G \frac{ m_l(G) \, I(G) } { s(G) }
%      \notag \\
  &=  \frac{1}{2 \, l} \,
      \rho^l \, (\underbrace{c*\cdots *c}_{l \; \mathrm{times}})(\vct 0)
      \notag \\
  &=  \frac{1}{2 \, l}
      \int \rho^l \, \tilde{c}^l(\vk) \dvk.
\label{eq:ccycling}
\end{align}
%
\end{lemm}

\begin{proof}
We show this under a generalized condition:
%Below, for generality,
%we assume that
every 2-root graph $G$ in the expansion of $c(\vr)$
carries the weight of $1/s(G)$.
%
This condition is satisfied in the PY case,
for every polygon graph in $c(\vr)$
carries the unit weight,
and $s(G) = 1$ by Lemma \ref{thm:polygonsymnum}.
%
The generalization
allows the proof to be also applicable to the HNC case. % below.


By definition,
$s(G)$ is the order of the automorphism group $\Aut(G)$,
or the number of vertex permutations
that keep the connection of $G$ unchanged.
%
Suppose $L$ is an $l$-cycle in $G$,
and the joints are $V_L = \{v_1, v_2, \dots v_l\}$.
%
The vertex permutations in $\Aut(G)$ that
map $V_L$ to $V_L$ itself % by cycling and/or reversing the elements
form a subgroup $\G_L$ of $\Aut(G)$.
%
The number of cosets $w(\G_L)$ of $\G_L$
is then equal to the number of $l$-cycles in $G$
that are isomorphic to $L$,
but with different sets of joints.
%
Thus, by Lagrange's theorem,
$w(\G_L) = |\Aut(G)|/|\G_L| = s(G)/|\G_L|$,
%
and
$m_l(G) = \sum w(\G_L)$,
where the sum is over all non-isomorphic $l$-cycles in $G$.
%
It follows that the $l$-cycle $L$
and its isomorphic counterparts
contribute
\begin{equation}
  \frac{ w(\G_L) \, I(G) }{ s(G) }
= \frac{ I(G) }{ |\G_L|}
\label{eq:ccyclingleft}
\end{equation}
to the left-hand side of Eq. \eqref{eq:ccycling}.


As discussed above,
the $l$-cycle $L$ represents a cycle decomposition of $G$
as $G_1 * \cdots * G_l (* \, G_1)$,
where $G_1$, $G_2$, \dots, $G_l$ are polygon graphs
rooted at the joints
$(v_1, v_2)$, $(v_2, v_3)$, \dots, $(v_l, v_1)$, respectively.
%
The cycle-preserving permutations of $G_1$, $G_2$, \dots, $G_l$ in the $l$-cycle
form a subgroup $\Hgroup_L$ of the dihedral group $\D_l$,
whose order is $2l$.
%
The number of different ways of the circular composition
$G_1 * \cdots * G_l (*\, G_1)$
occurring in $\rho^l (c * \cdots * c)$ is equal to
the number of cosets of $\Hgroup_L$,
which is, by Lagrange's theorem, equal to
$2l / |\Hgroup_L|$.
%
Now, as each $G_i$ ($1 \le i \le l$)
carries the weight of $1/s(G_i)$ in the expansion of $c(\vr)$,
the total contribution of the cycle $L$
to the right-hand side is
\begin{align*}
  \frac{1}{2l}
  \cdot
  \frac{2l}{|\Hgroup_L|}
  \cdot
  \frac{I(G)}{ s(G_1) \cdots s(G_l)}
= \frac{ I(G) }
 { |\Hgroup_L| \cdot s(G_1) \cdots s(G_l) }.
\end{align*}
The above expression is the same as Eq. \eqref{eq:ccyclingleft}
because
\begin{equation}
  \G_L = \Hgroup_L \times \Aut(G_1) \times \cdots \times \Aut(G_l).
  \label{eq:GLfactor}
\end{equation}
%
In other words,
if a vertex permutation preserves the connection,
it can only be built on
(i) cycling and reflecting the cycle elements, and
(ii) exchanging the vertices in each $G_i$.
Taking the order of Eq. \eqref{eq:GLfactor} yields
$|\G_L| = |\Hgroup_L| \cdot s(G_1) \cdots s(G_l)$.
\end{proof}

For example,
the graph
\newcommand{\hi}{0.05}
$G = {\begin{tikzpicture}[baseline=-1mm]
      \node (r1) at (-4*\hi, -4*\hi) [blackdot]{};
      \node (r2) at ( 4*\hi, -4*\hi) [blackdot]{};
      \node (r3) at ( 4*\hi,  4*\hi) [blackdot]{};
      \node (r4) at (-4*\hi,  4*\hi) [blackdot]{};
      \draw (r1) -- (r2) -- (r3) -- (r1) -- (r4) -- (r3);
\end{tikzpicture} }$
has a symmetry number $s(G) = 4$,
for one can exchange the two vertices
on either diagonals.
%
On the other hand,
$G$ has $m=2$ isomorphic cycles of length $l = 3$.
The cycle only has a reflection symmetry, so $|\Hgroup_L| = 2$.
So the contribution to both sides is
$m \, I /s = I/|\Hgroup_L| = I/2$.


%The reader can readily verify that
%  if the longest non-repeating segment of an $l$-cycle
%  is of length $d$ (and $d$ divides $l$),
%  the cycle along with its isomorphic counterparts
%  contribute $I(G) \cdot d/(p\cdot l)$ to both sides of \eqref{eq:ccycling},
%%
%where $p = 2$ if the cycle is symmetric in both directions,
%  or $p = 1$ otherwise.
%%
%For example,
%\newcommand{\hi}{0.05}
%$G = {\begin{tikzpicture}[baseline=-1mm]
%      \node (r1) at (-4*\hi, -4*\hi) [blackdot]{};
%      \node (r2) at ( 4*\hi, -4*\hi) [blackdot]{};
%      \node (r3) at ( 4*\hi,  4*\hi) [blackdot]{};
%      \node (r4) at (-4*\hi,  4*\hi) [blackdot]{};
%      \draw (r1) -- (r2) -- (r3) -- (r1) -- (r4) -- (r3);
%\end{tikzpicture} }$
%has $m=2$ isomorphic cycles of length $l = 3$ with $d = 3$ and $p = 2$.
%The symmetry number $s = 4$, for either diagonal allows
%the exchange of the two vertices.
%So the contribution to both sides is
%$I(G) \cdot m/s = I(G) \cdot d/(p\cdot l) = I(G)/2$.



Summing Eq. \eqref{eq:ccycling} over $l$ yields
%
\begin{align}
      \sum_{l=3}^{\infty} 2 \, \Chn_l
  &=  \int \tilde{T}(\vk) \, \dvk,
  %\notag \\
  %& \hphantom{=}
  %   - \frac{\rho^2}{2} \int c^2(\vr) \, d\vr,
     \label{eq:Clsum3} \\
  %
      \sum_{l=3}^{\infty} \, l \, \Chn_l
  &=
      \frac{ \rho^2 }{2} \int t(\vr) \, c(\vr) \, d\vr,
      \label{eq:Clsuml} \\
  %
      \sum_{l=3}^{\infty} \, l \, (l - 3) \, \Chn_l
  &=  \frac{ \rho^2 }{ 2 }
      \int t^2(\vr) \, d\vr,
\label{eq:Clsumll}
\end{align}
%
where
\begin{align}
  \tilde{T}(\vk)
&\equiv
    \frac{ \big[ \rho \, \tilde{c}(\vk) \big]^3 } { 3 }
  + \frac{ \big[ \rho \, \tilde{c}(\vk) \big]^4 } { 4 }
  + \cdots
\notag \\
&=
  - \log\big[1 - \rho \, \tilde{c}(\vk) \big]
  - \rho \, \tilde{c}(\vk)
  - \frac{ \big[ \rho \, \tilde{c}(\vk) \big]^2 } { 2 }.
  \label{eq:logrhoc}
\end{align}
%
Note that Eqs. \eqref{eq:Clsum3}, \eqref{eq:Clsuml}, and \eqref{eq:Clsumll}
  are direct consequences of the OZ relation, Eq. \eqref{eq:oz},
  and thus are applicable to any integral equation (not just the PY one).
%
For completeness, we list a few variants below
%
\begin{align}
      2 \, \Chn_2
  &=
      \frac{ \rho^2 }{2} \int c^2(\vr) \, d\vr,
%\label{eq:Clsum_cc}
\notag \\
%
      \sum_{l=2}^{\infty} \, l \, \Chn_l
  &=
      \frac{ \rho^2 }{2} \int c(\vr) \, h(\vr) \, d\vr,
%\label{eq:Clsum_ch}
\notag \\
%
      \sum_{l=2}^{\infty} \, l \, (l - 2) \, \Chn_l
  &=  \frac{ \rho^2 }{ 2 }
      \int t(\vr) \, h(\vr) \, d\vr,
\label{eq:Clsum_th} \\
%
      \sum_{l=1}^{\infty} \, l \, (l - 1) \, \Chn_l
  &=  \frac{ \rho^2 }{ 2 }
      \int h^2(\vr) \, d\vr.
%\label{eq:Clsum_hh}
\notag
\end{align}
%
Thus, the integrals of $c^2$, $t^2$, $h^2$, $ct$, $ch$, and $th$
can all be expressed as chain sums.



\subsection{Baxter's pressure formula}


%We now derive Baxter's pressure formula
%\cite{baxterpressure}.
%
To obtain an expression of pressure,
  we start with\cite{hansen}
%
\begin{align}
  -\partial_\rho (\beta \Pex)
  &= \rho \int c(\vr) \, d\vr
  \notag \\
  &= \sum_{G} \frac{ 2 \, n(G) \, \rho^{-1} I(G) }{ s(G) },
\label{eq:crcompr}
\end{align}
where
we have used Eq. \eqref{eq:pykappasum} in the second step.
%
%where the superscript ``ex'' means to the excess, or non-ideal-gas, part of the contribution.
%
Since for a polygon pack $G$ of $n$ vertices, $\rho^{-1} I(G)$
  is proportional to $\rho^{n-1}$,
%
integration over $\rho$ yields\cite{baxterpressure}
%
\begin{align}
      -\beta \Pex
  &=  \sum_{G} \frac{ 2 \, I(G) }{ s(G) }.
  \label{eq:pyPgraph}
\end{align}
%
By further using
Eqs. \eqref{eq:pyintgcr2sums}, \eqref{eq:Clsum3} and \eqref{eq:Clsuml},
we get
%
\begin{align}
      -\beta \Pex
  &=   \frac{ \rho^2 }{ 2 }
    \int [1 - t(\vr)]\, c(\vr) \, d\vr
      +\int \tilde{T}(\vk) \, \dvk.
\label{eq:baxterpressure}
\end{align}
%
Note that the weight $-2/s(G)$ is rather different
  from that $(1-n)/s(G)$ given in Sec. \ref{sec:graph}.
%
This means that the PY closure not only drops the non-polygon graphs,
  but also reduces the weights of the polygon graphs.
%
By using Eq. \eqref{eq:zerosep} and adding the ideal-gas part,
  we can rewrite the above result as
%
\begin{align*}
      \beta P
    =
      \int \log\big[1 - \rho \, \tilde{c}(\vk)\big] \, \dvk
      -\frac{ \rho \, t(\vct{0}) + \rho^2 \tilde{c}(\vct0) }{2}.
\end{align*}
%
Further, by using the virial theorem,
the Fourier-space integral can be avoided,
resulting Eq. \eqref{eq:pyPsimplified} in Sec. \ref{sec:vtpy}.



\subsection{Algebraic verification}

We can show that
  Eq. \eqref{eq:baxterpressure} is equivalent to Eq. \eqref{eq:crcompr}
  algebraically\cite{baxterpressure}.
%
Differentiating Eq. \eqref{eq:logrhoc} and using Eq. \eqref{eq:oz} yields
%
\begin{align*}
  \partial_\rho \tilde T
=
  \sum_{l = 2}^{\infty}
    ( \rho \, \tilde{c} )^l
    \, \partial_\rho ( \rho \, \tilde{c} )
=
  \rho \, \tilde{t}
  \, \partial_\rho ( \rho \, \tilde{c} ),
\end{align*}
%
where ``$(\vk)$'' is dropped.
%
Integrating out $\vk$ and using Eq. \eqref{eq:cyclesp2} yields
%
\begin{align}
  \int \partial_\rho \tilde T \dvk
&=
  \int
    \big(
      \rho \, \tilde{t} \, \tilde{c}
      +
      \rho^2 \, \tilde{t} \, \partial_\rho \tilde{c}
    \big) \dvk
\notag \\
&=
  \rho \int t \, c \, d\vr
      +
  \rho^2 \int t \, \partial_\rho c \, d\vr.
\label{eq:intdlogrhoc}
\end{align}



Differentiating Eq. \eqref{eq:baxterpressure}
with respect to $\rho$ and using Eq. \eqref{eq:intdlogrhoc} yields
%
\[
  -\partial_\rho ( \beta \Pex )
=
  \rho \int c \, d\vr
  + \frac{\rho^2}{2} \int (
    \partial_\rho c - c \, \partial_\rho t + t \, \partial_\rho c
    ) \, d\vr,
\]
The second term vanishes because of the PY closure, Eq. \eqref{eq:py}:
$c \, \partial_\rho t = (1 + \, t) \, f \, \partial_\rho t = (1 + t) \, \partial_\rho c$.
%
Thus,
\[
  -\partial_\rho ( \beta \Pex )
=
  \rho \int c \, d\vr,
\]
which is Eq. \eqref{eq:crcompr}.

This demonstration proves that
Eqs. \eqref{eq:crcompr} and \eqref{eq:baxterpressure}
produce the same virial coefficients,
since the two formulae differ only
by a differentiation with respect to the density, $\rho$.




\subsection{Second density derivative of pressure}

Similarly,
  by differentiating Eq. \eqref{eq:pykappasum} with respect to $\rho$,
  and ignoring inter-face pairs
  we get
  $p(G) \approx n(G) \, [n(G) - 1]$,
  and
%
\begin{align}
           -\frac{\rho^2}{2}
            \frac{\partial^2 ( \beta \Pex ) }
                 {\partial \rho^2}
  &\approx   \sum_G \frac{ p(G) \, I(G) }{ s(G) }
    \notag \\
  &=
            \sum_G \frac{2 I(G) }{s(G)}
            + \sum_{l = 3}^\infty [l(l-1) - 2] \, \Chn_l
    \notag \\
  &=         \frac{\rho^2}{2} \int [c(\vr) + t(\vr) \, h(\vr) ] \, d\vr,
\label{eq:pyddpressure}
\end{align}
%
where we have use
  Eqs. \eqref{eq:countpairs},
       \eqref{eq:pyintgcr2sums}, and
       \eqref{eq:Clsum_th}.
%
Note that this relation is approximate (i.e., it is not a compressibility route result)
  and the deviation is
  similar to that in the HNC approximation.





\section{\label{sec:hnc}HNC equation}


\subsection{$c$-graphs}

The HNC equation includes
  more graphs than the PY closure.
%
For example, $c(\vr)$ contains
%
\begin{equation}
  \newcommand{\hh}{0.22cm}
  \begin{tikzpicture}[baseline=1.2mm]
    \node (r1) at (-2.0*\hh,  2*\hh) [whitedot]{};
    \node (r2) at (   0,      4*\hh) [blackdot]{};
    \node (r5) at (   0,      0*\hh) [blackdot]{};
    \node (r6) at ( 2.0*\hh,  2*\hh) [whitedot]{};
    \draw[thick]
          (r1) -- (r2) -- (r6)
          (r1) -- (r5) -- (r6);
  \end{tikzpicture},
  %
  \;\;
  %
  \begin{tikzpicture}[baseline=1.2mm]
    \node (r1) at (-2.0*\hh,  1*\hh) [whitedot]{};
    \node (r2) at (   0,      4*\hh) [blackdot]{};
    \node (r3) at (   0,      2*\hh) [blackdot]{};
    \node (r5) at (   0,      0*\hh) [blackdot]{};
    \node (r6) at ( 2.0*\hh,  1*\hh) [whitedot]{};
    \draw[thick]
          (r1) -- (r2) -- (r6)
          (r1) -- (r3) -- (r6)
          (r1) -- (r5) -- (r6);
  \end{tikzpicture},
  %
  \;\;
  %
  \begin{tikzpicture}[baseline=1.2mm]
    \node (r1) at (-2.0*\hh,  2*\hh) [whitedot]{};
    \node (r2) at (   0,      4*\hh) [blackdot]{};
    \node (r3) at (   0,      3*\hh) [blackdot]{};
    \node (r4) at (   0,      1*\hh) [blackdot]{};
    \node (r5) at (   0,      0*\hh) [blackdot]{};
    \node (r6) at ( 2.0*\hh,  2*\hh) [whitedot]{};
    \draw[thick] (r1) -- (r6)
          (r1) -- (r2) -- (r6)
          (r1) -- (r3) -- (r6)
          (r1) -- (r4) -- (r6)
          (r1) -- (r5) -- (r6);
  \end{tikzpicture},
  %
  \;\;\mbox{and}\;\;
  %
  \begin{tikzpicture}[baseline=1.2mm]
    \node (r1) at (-1.2*\hh,  0) [whitedot]{};
    \node (r2) at (-2.8*\hh,  2.6*\hh) [blackdot]{};
    \node (r3) at (-1.8*\hh,  2.2*\hh) [blackdot]{};
    \node (r4) at (   0,      4*\hh) [blackdot]{};
    \node (r5) at ( 1.8*\hh,  2.2*\hh) [blackdot]{};
    \node (r6) at ( 2.8*\hh,  2.6*\hh) [blackdot]{};
    \node (r7) at ( 1.2*\hh,  0) [whitedot]{};
    \draw[thick] (r1) -- (r7)
                 (r1) -- (r2) (r1) -- (r3) (r1) -- (r4)
                 (r4) -- (r2) (r4) -- (r3)
                 (r4) -- (r5) (r4) -- (r6)
                 (r7) -- (r5) (r7) -- (r6);
  \end{tikzpicture},
  \label{eq:hnccrex}
\end{equation}
%
%
%
but not
%
%
%
\begin{equation}
  \newcommand{\hh}{0.22cm}
  \begin{tikzpicture}[baseline=1.2mm]
    \node (r1) at (-2*\hh,  2*\hh) [whitedot]{};
    \node (r2) at (0*\hh,   0*\hh) [blackdot]{};
    \node (r3) at (0*\hh,   4*\hh) [blackdot]{};
    \node (r4) at ( 2*\hh,  2*\hh) [whitedot]{};
    \draw[thick] (r1) -- (r2) -- (r4) -- (r3) -- (r1)
                 (r2) -- (r3);
  \end{tikzpicture}
  \;\;\mbox{and}\;\;
  \begin{tikzpicture}[baseline=1.2mm]
    \node (r1) at (-2*\hh,  2*\hh) [whitedot]{};
    \node (r2) at (0*\hh,   0*\hh) [blackdot]{};
    \node (r3) at (0*\hh,   4*\hh) [blackdot]{};
    \node (r4) at ( 2*\hh,  2*\hh) [whitedot]{};
    \draw[thick] (r1) -- (r2) -- (r4) -- (r3) -- (r1)
                 (r2) -- (r3) (r1) -- (r4);
  \end{tikzpicture}.
  \label{eq:hnccrexnot}
\end{equation}
%
We use the following recursive definition
  to characterize them.
%
A \emph{$c$-graph} is either
%
1) an $f$-graph,
or
%
2) a cycle of three or more
  smaller $c$-graphs,
  with the roots being any two joints
  of the cycle.
%
One can verify that the above definition
  includes all graphs in Eq. \eqref{eq:hnccrex},
  but none in Eq. \eqref{eq:hnccrexnot}.
%

Further, we define a \emph{$c$-chain}
  as a chain of $c$-graphs,
and a \emph{$c$-bundle}
  as a parallel composition of
  $c$-chains.
%
Then, similar to Lemma \ref{thm:pycrsum},
  we have

\begin{lemm}
In the HNC equation,
%
$c(\vr)$
  is the sum of all nonequivalent $c$-graphs $G$,
  each weighted by the inverse symmetry number $1/s(G)$.
  %where $s(G)$ is the number of ways of relabeling
  %\emph{black} vertices that keep the connections of $G$ unchanged;
Further, $t(\vr)$ and $y(\vr)$ are the corresponding weighted sum of all
  $c$-chains and $c$-bundles, respectively.
  \label{thm:hnccr}
\end{lemm}
%
%
%
\begin{proof}
%
We carry an induction on the number of vertices $n$.
%
One can readily verify that the statements are true for $n \le 3$.
%
Suppose they are true for $n \le k$,
  we prove the $n = k + 1$ case below.


We first show that
  every graph $H$ in the expansion of $t(\vr)$
  is a $c$-chain weighted by $1/s(H)$.
%
According to Eq. \eqref{eq:oz},
\[
  t = \rho \, c*c + \rho^2 \, c * c * c + \rho^3 \, c*c*c*c \cdots.
\]
So, $H$ can be written as a $c$-chain
  $G_1 * \cdots * G_l$ ($l \ge 2$).
%
The weight $w(G)$ is
  $w(G_1) \cdots w(G_l)$,
  which is, by the induction hypotheses, equal to
  $s^{-1}(G_1) \cdots s^{-1}(G_l)$.
%
Since the joints are distinguishable,
  and the relabeling of the non-joint vertices  of $H$
  can occur only within each $G_i$ independently,
  the symmetry number is
  $s(H) = s(G_1) \cdots s(G_l)$,
  which is indeed the inverse weight of $H$.
%
The converse, every $c$-chain can be found in the expansion of $t(\vr)$,
can be shown similarly.

Next, we show every graph in the expansion of $y(r)$
  in a $c$-bundle.
%
Since the HNC closure is
\[
  y(\vr)
= \exp t(\vr)
=
1 + t(\vr)
+ \frac{ t^2(\vr) }{ 2! }
+ \frac{ t^3(\vr) }{ 3! }+ \cdots,
\]
every graph $M$ in the graphical expansion of $y(\vr)$,
  or, specifically, in the expansion of $t^m(\vr)/m!$ ($m \ge 0$),
  is a $c$-bundle of $m$ $c$-chains,
  $H_1$, $H_2$, \dots, and $H_m$.
%
%
To verify the weight $w(M)$,
  we sort the $m$ chains as
\begin{equation}
\begin{split}
  %\hphantom{~~~~}
& \text{$m_1$ identical chains of type $1$}, \\
  %\hphantom{~~~~}
& \dots, \\
  %\hphantom{~~~~}
& \text{$m_t$ identical chains of type $t$}, \\
& \text{with $m = m_1 + \cdots + m_t$}.
\end{split}\label{eq:sortchains}
\end{equation}
%
The number of times of $M$
  appearing in expansion of $t^m(\vr)$
  is equal to the number of ways
  of assigning the $t$ types to the $m$ chains
  under the conditions, Eqs. \eqref{eq:sortchains},
  which can be computed from the multinomial coefficients
  $m!/(m_1! \cdots m_t!)$.
%
So
%
\[
  w(M)
=
  \frac{ m! } { m_1! \cdots m_t! }
  \times
  \frac{ 1 } { m! }
  \frac{ 1 } { s(H_1) \cdots s(H_m) }.
\]
%
On the other hand,
  the symmetry number of $M$ is
  $s(M) = m_1! \cdots m_t! \, s(H_1) \cdots s(H_m)$,
  because, besides the intra-chain permutations,
  there are $m_r!$ ways of permuting the chains of the same type $r$,
  and collectively relabeling the vertices within accordingly.
So $w(M) = 1/s(M)$.
%
The converse can be shown similarly.

Next, let us show that every graph in the expansion of $c(\vr)$
  is a $c$-graph.
%
Again, from the closure, Eq. \eqref{eq:hnc},
  an $n$-vertex graph $G$ in $c(\vr)$ is
  either a $c$-bundle $M$ of
  $m$ $c$-chains $H_1$, \dots, $H_m$,
  or the parallel composition of a $c$-bundle $M$ and an $f$-graph,
  i.e., $G = M (\cdot f) = H_1 \cdots H_m (\cdot f)$,
  if it is generated by the term
  $\big\{\llbra m \ge 2 \llket + f(\vr)\big\} \, t^m(\vr) / m!$.
%
Let us first show that $G$ is a $c$-graph.
%
In the case of $m = 0$,
  $G$ is the $f$-graph, which is a $c$-graph.
%
If $1 \le m \le 2$,
  $G$ is a cycle of $c$-graphs,
  hence a $c$-graph.
%
For $m \ge 3$, we carry an induction on $m$.
%
We view $G$ as a parallel composition of the $c$-chain $H_m$
  and the graph $G' = H_1 \cdots H_{m-1}
  (\cdot f)$, as shown below.
\[
  \newcommand{\sz}{3mm}
  \begin{tikzpicture}
    \node (v1)    at ( 0, 0) [blackdot,label=left:$v_1$]{};
    \node (v2)    at ( 1.0*\sz, 2.0*\sz) [blackdot,blue,label=left:$v_2$]{}
      edge[thick, blue, bend right=10] (v1);
    \node (vlm1)  at ( 9.0*\sz, 2.0*\sz) [blackdot,blue,label=right:$v_{l-1}$]{}
      edge[dotted, thick, blue, bend right=45] (v2);
    %\node (ui)    at ( 5.0*\sz, 3.5*\sz) []{}
    %  edge[dotted, bend right=25] (v2);
    %  edge[dotted, bend left=25] (vlm1);
    \node (vl)    at (10.0*\sz, 0) [blackdot,label=right:$v_l$]{}
      edge[thick, blue, bend right=10] (vlm1)
      edge[dashed, thick] node[anchor=north] {$f$} (v1)
      edge[thick, bend left=40] node[anchor=north] {$H_1$} (v1);

%      edge[ultra thick, bend left=150] node[anchor=north] {$H_{m-1}$} (v1);

    \node (Hm) at (5.0*\sz, 2.5*\sz) [blue] {$H_m$};

    \node (elps) at (4.9*\sz, -3.5*\sz) {$\vdots$};

    \node (um1)   at (5.0*\sz, -4.7*\sz)
      [inner sep=0pt, minimum size=0pt, label=below:$H_{m-1}$]{}
      edge[thick, bend left=45] (v1)
      edge[thick, bend right=45] (vl);

    %% beginning of G'
    \draw[fill=lightgray, opacity=.2] plot [smooth cycle]
      coordinates{
                   (-2.3*\sz,-3.0*\sz)
                   (-2.2*\sz, 0.0*\sz)
                   ( 0.0*\sz, 1.0*\sz)
                   (10.0*\sz, 1.0*\sz)
                   (12.2*\sz, 0.0*\sz)
                   (12.3*\sz,-3.0*\sz)
                   (10.0*\sz,-6.0*\sz)
                   ( 0.0*\sz,-6.0*\sz) };
    \node (Gp) at (9.5*\sz, -5.0*\sz) {$G'$};

  \end{tikzpicture}
\]
Since $G'$ is a $c$-graph by the induction hypothesis,
  $G$, which is a the parallel composition of $G'$ and $H_m$,
  is a cycle of $c$-graphs by Eq. \eqref{eq:cyclesp},
  and hence a $c$-graph.
%
The weight $w(G)$ is the same as $w(M)$.



We can similarly show the converse:
  every $c$-graph $G$ can be generated by the closure.
%
By definition, $G$ is a cycle of $c$-graphs.
%
If the two roots are not consecutive joints of the cycle,
  then $G$ can be generated by the term $t^2(\vr)/2$.
%
Otherwise, $G$ can be written as a cycle
  $v_1 - \cdots - v_l - v_1$
  rooted at the joints $v_1$ and $v_l$
  ($l \ge 3$),
%
or, equivalently, $G = G' \cdot H_m$,
  with
    $G'$ being the $c$-graph between $v_1$ and $v_l$,
  and
    $H_m \equiv v_1 - \cdots - v_l$
    being a $c$-chain.
%
By the induction hypotheses,
  $G'$ can be generated by the term
  $\big\{ \llbra m \ge 3 \llket +f(\vr) \big\} t^{m - 1}(\vr) / (m - 1)!$
  of some $m$ (for $G'$ has fewer vertices than $G$),
whereas
  $H_m$ can be generated by $t(\vr)$.
%
It follows that
  $G$ can be generated by the term
  $\big\{ \llbra m \ge 2 \llket  + f(\vr)\big\} t^{m}(\vr) / m! $.
%
\end{proof}




\subsection{$c$-packs}

If we blacken the two roots,
a $c$-graph becomes a \emph{$c$-pack}.
%
In a $c$-pack,
  a pair of vertices forms a \emph{pivot}
  if marking them as the roots renders the $c$-pack to some $c$-graph.
%
For example,
  \begin{tikzpicture}[baseline=1.0mm]
    \node (r1) at (-2mm, 0) [blackdot,label=left:{\footnotesize$1$}]{};
    \node (r2) at ( 2mm, 0) [blackdot,label=right:{\footnotesize$2$}]{};
    \node (r3) at ( 2mm, 4mm) [blackdot,label=right:{\footnotesize$3$}]{};
    \node (r4) at (-2mm, 4mm) [blackdot,label=left:{\footnotesize$4$}]{};
    \draw (r1) -- (r2) -- (r3) -- (r4) -- (r1) (r1) -- (r3);
  \end{tikzpicture}
is a $c$-pack,
  $(1, 2)$ and $(1, 3)$ are pivots,
  but $(2, 4)$ is not.
%
Following an argument similar to the one leading to Lemma \ref{thm:pykappasum},
  we have

\begin{lemm}
In the HNC equation,
%
$\rho^2 \int c(\vr) \, d\vr$
  is the sum of all nonequivalent $c$-packs $G$:
%
\begin{equation}
    \rho^2 \int c(\vr) \, d\vr
  = \sum_G \frac{ p(G) \, I(G) }{ s(G) },
  \label{eq:hnccrsum}
\end{equation}
%
where $p(G)$ and $s(G)$ are
  the number of ordered pivots and
  the symmetry number
  of $G$,
  respectively.
\label{thm:hnccrsum}
\end{lemm}

%Note that, for the $f$-graph, we define $p(G) = 2$.


The converse is the following.


\begin{lemm}
Define the following sum over all $c$-packs
\begin{equation}
  \A \equiv \sum_G \frac{ I(G) }{ s(G) },
  \label{eq:Adef}
\end{equation}
The sums obtained from whitening,
one at a time,
all,
adjacent,
and nonadjacent
ordered pivots
of all $c$-packs $G$ in $\A$
are given by
$\rho^2 \, c(\vr)$,
$\rho^2 \, f(\vr) \, y(\vr)$,
and
$\rho^2 \, [y(\vr) - t(\vr) - 1]$,
respectively.
\label{thm:whitenAhnc}
\end{lemm}



\begin{proof}
By definition,
  the symmetry number $s(G)$
  of a $c$-pack $G$
  is the order of the automorphism group $\Aut(G)$,
  which is the set of vertex permutations
  that keep the connections of $G$ unchanged.
%
Given an ordered pivot $(i, j)$ of $G$,
  let $G_{ij}$ be the $c$-graph
  from whitening the pivot in $G$.
%
Let $\G_{ij}$
  denote the set of permutations of the non-root vertices
  that keep the connections of $G_{ij}$ unchanged,
then the symmetry number $s(G_{ij}) = |\G_{ij}|$.
%
Clearly, $\G_{ij}$ is a subgroup of $\Aut(G)$.
%
%Each coset of $\G_{ij}$
%corresponds to a vertex permutation
%that maps $(i, j)$ to an isomorphic pivot.
%
Thus, the number of cosets $w_{ij}(G)$
is equal to the number of ordered pivots in $G$
that are equivalent to $(i, j)$.
%
By Lagrange's theorem $s(G) = s(G_{ij}) \, w_{ij}(G)$.
%
It follows that the procedure of whitening all ordered pivots
produces $w_{ij}(G)$ copies of $G_{ij}$,
and the total contribution
to the sum of the whitened graphs
is $w_{ij}(G) \, I(G_{ij})/s(G) = I(G_{ij})/s(G_{ij})$.
%
A sum over $c$-packs $G$
then yields $\rho^2 \, c(\vr)$ by Lemma \ref{thm:hnccr}.

By using Lemma \ref{thm:crsplit},
  we can separate the $c$-graphs with adjacent roots
  from those with nonadjacent ones,
  and this yields the other two sums.
\end{proof}



\subsection{Functional differentiation}

Lemma \ref{thm:whitenAhnc} can be conveniently
restated in terms of functional derivatives.
%
We define, for two arbitrary functions $\psi_0(\vr)$ and $\psi_1(\vr)$,
the generalized sum
\begin{align}
  \A(\psi_0, \psi_1)
\equiv
  \sum_G \frac{ I(G; \psi_0, \psi_1) } { s(G) },
\label{eq:Apsi}
\end{align}
where
\begin{multline}
  I(G; \psi_0, \psi_1)
=
  \int
  %\left[
    \prod_{\{i, j\} \in E(G)}
    \Bigl[
      f(\vr_{ij}) \, \exp \psi_1(\vr_{ij})
    \Bigr]
  %\right]
  %\notag
  \\
%& \hphantom{=\int}
  %\left(
    \prod_{
      \{l, m\} \in P(G) \backslash E(G)
      % \substack{
      %   \{l, m\} \notin E(G) \\
      %   \{l, m\} \in P(G)
      % }
    }
    \Bigl[
      \exp \psi_0(\vr_{lm})
    \Bigr]
  %\right)
  \quad
  d\vr_2 \, \cdots \, d\vr_n,
  \label{eq:Ipsi}
\end{multline}
with $E(G)$, $P(G)$ being the sets of edges and unordered pivots in $G$,
%
Thus, $|E(G)|$ is equal to the number of edges $e(G)$,
and $|P(G)| = p(G)/2$,
where the factor $1/2$ accounts for the two orderings
of the two vertices in the pivot.



We shall show in Lemma \ref{thm:hncfpivot} that
every edge in $G$ is an unordered pivot.
%
Thus,
the first product in Eq. \eqref{eq:Ipsi}
covers all adjacent unordered pivots,
and the second product over the complement
$P(G) \backslash E(G)$
covers all nonadjacent unordered pivots,
%
We can treat
$\A(\psi_0, \psi_1)$
as a generating function
of nonadjacent ($\psi_0$) and adjacent ($\psi_1$) unordered pivots,
%
and $\A(0,0)$ recovers Eq. \eqref{eq:Adef}.
%
Thus, Lemma \ref{thm:whitenAhnc} can now be stated as
\begin{align*}
  \frac{\rho^2}{2} c(\vr)
&=
  \left.
  \sum_{\sigma = 0, 1}
  \frac{ \delta \A(\psi_0, \psi_1) } { \delta \psi_\sigma(\vr) }
  \right|_{\psi_0 = \psi_1 = 0},
\\
%
%
%
  \frac{\rho^2}{2} f(\vr) \, y(\vr)
&=
  \left.
  \frac{ \delta \A(\psi_0, \psi_1) } { \delta \psi_1(\vr) }
  \right|_{\psi_0 = \psi_1 = 0},
\\
%
%
%
  \frac{\rho^2}{2}[ y(\vr) - t(\vr) - 1 ]
&=
  \left.
  \frac{ \delta \A(\psi_0, \psi_1) } { \delta \psi_0(\vr) }
  \right|_{\psi_0 = \psi_1 = 0}.
\end{align*}

Since $\delta \psi_1(\vr) = \delta f(\vr)/ f(\vr)$,
the second equation becomes\cite{hiroike1957, morita1958, *morita1960, *morita1960I}
\begin{equation}
  \frac{ \delta \A } { \delta f(\vr) }
  = \frac{1}{2} \, \rho^2 y(\vr).
  \label{eq:yrfunctional}
\end{equation}
The relation is also true for the exact graphical sum of $y(\vr)$,
if $\A$ covers all biconnected graphs.
%
It, however, has to be modified to
Eq. \eqref{eq:yrfunctionalpy}
in the PY case.





\subsection{\label{sec:hncFex}Graphical sums of the Helmholtz free energy and chemical potential}


We now show that the free energy is given by\cite{morita1958, *morita1960}
\begin{equation}
  -\frac{ \beta \Fex }{V}
=
  \A \equiv \sum_G \frac{ I(G) }{ s(G) }.
\label{eq:hncFexA}
\end{equation}
%A proof will be given in Secs. \ref{sec:hnccavity} and \ref{sec:hncFex}.
%
%From thermodynamics, we have
We start from the thermodynamic identity
\begin{align}
  \partial_\beta (\beta \Fex)
&=
 \langle \Phi \rangle
=
\frac{\rho^2 \, V}{2} \int
  \phi(\vr) \, g(\vr) \, d\vr,
  \label{eq:Fti}
\end{align}
where $\Phi = \sum_{i < j} \phi(\vr_{ij})$
is the potential energy of the system.
%
On the other hand, differentiating $\A$ yields
\begin{align*}
  \partial_\beta \A
&=
  \int
  \frac{ \delta \A } { \delta f(\vr) }
  \,
  \partial_\beta f(\vr) \, d\vr
  \\
&=
  -\frac{\rho^2} {2}
  \int
  y(\vr) \, [f(\vr) + 1]
  \, \phi(\vr) \, d\vr
  \\
&=
  -\frac{\rho^2} {2}
  \int \phi(\vr) \, g(\vr) \, d\vr,
\end{align*}
where we have used Eq. \eqref{eq:yrfunctional}.
%
Comparing this to Eq. \eqref{eq:Fti}, we get
\begin{equation}
  -\partial_\beta(\beta \, \Fex/V) = \partial_\beta \A.
  \label{eq:hncdFexdA}
\end{equation}
Since at the high temperature limit ($\beta = 0$),
we have $\phi(\vr) = f(\vr) = 0$,
and $\Fex(\beta = 0) = \A(\beta = 0) = 0$,
%
integrating Eq. \eqref{eq:hncdFexdA} from $\beta = 0$
yields Eq. \eqref{eq:hncFexA}.
%
A similar derivation from the virial theorem
can be found in Sec. \ref{sec:vthnc},
which shows that the expression, Eq. \eqref{eq:hncFexA},
corresponds to the virial-route result\cite{morita1960, morita1960I}.

Equation \eqref{eq:hncFexA} shows that the graphical sum
in the HNC equation shares the same weight as
the exact sum given in Sec. \ref{sec:bcsums}.
%
The only difference is that the former covers only $c$-packs,
whereas the latter covers all unrooted biconnected graphs.


For the chemical potential, we use the relation
\begin{equation}
  \muex = \partial_N(\Fex)_V = \partial_\rho(\Fex/V),
  \label{eq:muexdFex}
\end{equation}
where,
$N = \rho \, V$
is the total number of particles
(not to be confused with the order $n$).
%
Thus,
%The chemical potential can now be obtained as
%
\begin{align}
    - \beta \rho \muex
  =
  -\rho \, \partial_\rho(\beta \, \Fex/V)
  =
    \sum_G \frac{ n(G) \, I(G) } { s(G) }.
\label{eq:hncmugsum}
\end{align}
where we have used $I(G) \propto \rho^{n(G)}$.





\subsection{Cycle decomposition}




To proceed, we need to generalize the face decomposition in the PY case
  to a cycle decomposition for the HNC case,
  which helps adapting the counting formulae,
  Eqs. \eqref{eq:countvertices} and \eqref{eq:countpairs}.


First, we say that
a cycle of $l$ ($l \ge 3$) $c$-graphs
is \emph{simple}
if at least $(l-1)$ links of the cycle are $f$-graphs.
%
We now show that
%
%
%
\begin{lemm}
There is at least one simple cycle
  in a $c$-pack $G$ of three or more vertices.
\end{lemm}
%
%
%
\begin{proof}
%
We prove this by giving an algorithm, \textbf{Algorithm L},
  for finding a simple cycle of $G$.
%
By definition,
  $G$ has at least one pivot $(v_1, v_{k})$,
  and can be decomposed to a cycle of $c$-graphs
  $K = v_1 - \cdots - v_k - \cdots - v_l - v_1 (\equiv v_{l+1})$,
  with $v_j$ being the $j$th joint.

If $K$ is simple, there is nothing to prove.
%
Otherwise,
  there is a link in $K$, say $G_1$ between $v_1$ and $v_2$,
  that is a $c$-graph, but not an $f$-graph
  (as shown below).
%
Now, by definition, $G_1$ can be decomposed to
  a cycle $J'$ (blue) of $c$-graphs
  passing through $v'_1 \equiv v_1$
  and $v'_{k'} \equiv v_2$:
%
  $J' = v'_1 - v'_2 - \cdots - v'_{k'-1}
      - v'_{k'} - v'_{k'+1} - \cdots
      - v'_{l'} - v'_1$.
%
Without loss of generality,
  we can assume that
  the branch $v'_1, v'_2, \dots, v'_{k'}$
  contains at least three vertices,
  i.e., $k' \ge 3$.
%
Now $J = v'_1 (=v_1) - v'_{l'} - \cdots - v'_{k'+1} - v'_{k'} (= v_2) \
       - v_3 - \cdots - v_l - v'_1$
  is also a cycle of $c$-graphs (red),
  and thus can be reduced to a $c$-graph
  rooted at $v'_1$ and $v'_{k'}$.
%
Thus, $G$ can be decomposed to a different cycle
  $K' = v'_1 - v'_2 - \cdots - v'_{k'} - v'_1$
  (green).
%
\[
  \newcommand{\sz}{4mm}
  \begin{tikzpicture}
    % begin of graph G_1
    \draw[thick, fill=lightgray!50!white, draw=blue!20!gray, opacity=0.5]
      plot [smooth cycle]
      coordinates{
        (  2.0*\sz,  1.0*\sz)
        ( -1.5*\sz,  3.0*\sz)
        ( -1.0*\sz,  5.5*\sz)
        (  1.5*\sz,  7.5*\sz)
        (  9.5*\sz,  7.5*\sz)
        ( 12.0*\sz,  5.5*\sz)
        ( 12.5*\sz,  3.0*\sz)
        (  9.0*\sz,  1.0*\sz)
        (  5.5*\sz,  0.5*\sz)
      };
    \node (G1) at ( 13.0*\sz, 5.5*\sz) [gray!50!blue] {$G_1$};
    % end of graph G_1

    \node (vn)  at ( 0, 0) [blackdot]{};
    \node (v0)  at ( 0.2*\sz, 1.5*\sz) [blackdot,label=left:$v_l$]{}
      edge[thick, bend right=10] (vn);
    \node (v1)  at ( 2.0*\sz, 3.5*\sz) [blackdot,label=left:$v_1(v'_1)$]{}
      edge[thick, thick, bend right=15] (v0);
    \node (v3) at (10.8*\sz, 1.5*\sz) [blackdot,label=right:$v_3$]{};
    \node (v2) at ( 9.0*\sz, 3.5*\sz) [blackdot,label=right:$v_2(v'_{k'})$]{}
      edge[thick, thick, bend left=15] (v3);
    \node (v4)  at (11.0*\sz, 0)       [blackdot]{}
      edge[thick, bend right=10] (v3);

    % beginning of the inner J' cycle
    \node (u2) at ( 3.5*\sz, 6.0*\sz)
      [blackdot,blue,label={[label distance=-1mm]160:$v'_2$}]{}
      edge[blue, thick, bend right=30] (v1);
    \node (ukm1) at ( 7.5*\sz, 6.0*\sz)
      [blackdot,blue,label={[label distance=-1mm]20:$v'_{k'-1}$}]{}
      edge[blue, thick, bend left=30] (v2)
      edge[blue, dotted, thick, bend right=10] (u2);
    \node (uk1) at ( 7.5*\sz, 1.5*\sz)
      [blackdot,blue,label=above:$v'_{k'+1}$]{}
      edge[blue, thick, bend right=30] (v2);
    \node (ul) at  ( 3.5*\sz, 1.5*\sz) [blackdot,blue,label=above:$v'_{l'}$]{}
      edge[blue, thick, bend left=30] (v1)
      edge[blue, dotted, thick, bend right=10] (uk1);

    \node (Jp) at ( 9.5*\sz, 5.5*\sz) [blue] {$J'$};
    % end of the inner J' cycle

    % beginning of the K' cycle
    \draw[draw=green!50!black, thick] plot [smooth cycle]
      coordinates{ ( 2.5*\sz, 3.9*\sz)
                   ( 3.5*\sz, 5.7*\sz)
                   ( 7.5*\sz, 5.7*\sz)
                   ( 8.5*\sz, 3.9*\sz) };

    \node (Kp) at ( 5.5*\sz, 5.0*\sz) [green!50!black] {$K'$};
    % end of the K' cycle

    \node (vb)  at ( 5.5*\sz,-1.9*\sz) [blackdot]{};

    \node (vr) at ( 9.5*\sz,-1.2*\sz) [blackdot]{}
      edge[dotted, thick, bend left=7] (vb)
      edge[thick, bend right=20] (v4);

    \node (vlft)  at ( 1.5*\sz,-1.2*\sz) [blackdot]{}
      edge[dotted, thick, bend right=7] (vb)
      edge[thick, bend left=20] (vn);

    %\draw[dashed, black] (v1) -- (v2);
    \node (K) at (11.0*\sz, -1.2*\sz) {$K$};

    % beginning of the J cycle
    \draw[draw=red!80!black, thick] plot [smooth cycle]
        coordinates{ ( 1.5*\sz, 2.5*\sz)
                     ( 0.7*\sz, 0.2*\sz)
                     ( 3.5*\sz,-1.2*\sz)
                     ( 7.5*\sz,-1.2*\sz)
                     (10.3*\sz, 0.2*\sz)
                     ( 9.5*\sz, 2.5*\sz)
                     ( 8.0*\sz, 1.2*\sz)
                     ( 5.5*\sz, 0.8*\sz)
                     ( 3.0*\sz, 1.2*\sz)
                   };
    \node (J) at ( 5.5*\sz, -0.2*\sz) [red!80!black] {$J$};
    % end of the J simple cycle

  \end{tikzpicture}
\]

If $K'$ is simple, we are done.
%
Otherwise,
  we replace the link between $v'_1$ and $v'_{k'}$ in $K'$
  (which is also the subgraph induced by the vertices on cycle $J$)
  by an $f$-graph.
%
On the simplified graph $G'$,
  we can further apply the above step
  to any link $v'_{j'} - v'_{j'+1}$ of $K'$
  that is not an $f$-graph.
%
One can readily show that
  the above procedure removes more edges than vertices,
%
such that the overall process always ends with a $c$-graph
  with equal numbers of vertices and edges
  (i.e., a simple cycle).
\end{proof}



Algorithm L in above proof allows us to
  decompose a $c$-pack as simple cycles as follows.

\textbf{Algorithm D:}
\begin{enumerate}
  \item
    Given a $c$-pack $G$,
      repeat steps 2 and 3 until $G$ is an $f$-graph.
  \item
    Find a simple cycle in $G$,
      $v_1 - v_2 - \cdots - v_l - v_1$
      using Algorithm L,
      such that
      for $j = 1, \dots, l-1$,
      the $c$-graph between $v_j$ and $v_{j+1}$
      is an $f$-graph.
  \item
    Remove $v_2, v_3, \dots, v_{l-1}$,
      and join $v_1$ and $v_l$ if they are not adjacent.
\end{enumerate}
%
It is readily shown that,
  Step 3 results in a new $c$-pack $G$
  with $(l - 2)$ fewer vertices,
  and the algorithm always ends with an $f$-graph.
%
Thus,


\begin{lemm}
  A $c$-pack $G$ can be reduced
    by Algorithm D to an $f$-graph in $m(G)$ steps,
    where $m(G)$ is the number of ways of decomposing
    $G$ as a cycle of $c$-graphs,
    which is independent of the order of the vertex elimination
    in Algorithm D.
\label{thm:hncdecomp}
\end{lemm}


\begin{proof}
Let $J = u_1 - u_2 - \dots - u_j - u_1 (\equiv u_{j+1})$
  be a cycle that decomposes the original $c$-pack $G$,
%
and $L^{(s)} = v_1 - v_2 - \dots - v_l - v_1$
  be the simple cycle
  (with $\{v_1, v_2\}$, ..., $\{v_{l-1}, v_l\}$ being $f$-bonds)
  discovered in the $s$th round of Algorithm D.
%
We will show below that
  either
  (a) the vertices in $V_L = \{ v_2, \dots, v_{l-1} \}$
    are entirely contained in
    some link $u_i - u_{i+1}$,
  or
  (b) $L^{(s)}$ and $J$ share the same joints (i.e., the two are the same).
%
Since case (a) leaves $J$ intact,
  every cycle $J$ is discovered (and then eliminated)
  only in case (b),
  and the lemma follows.
%

If (a) is not true,
  it means that the vertices in $L^{(s)}$
  spread over several links,
  $u_i - u_{i+1}$, $u_{i'} - u_{i' + 1}$, \dots, in cycle $J$.
%
Then,
  there is at least one joint $u_i$ of $J$
  that belongs to $V_L$
  [for the vertices in $V_L$ are connected in $G^{(s)}$].
%
Consider now the $c$-pack $G^{(s)}$
  in Step 2 of the $s$th round of Algorithm D.
%
Since every vertex in $V_L$ is adjacent to only two vertices,
  the links $u_{i-1} - u_i$
  and $u_i - u_{i+1}$ in $J$
  must both be $f$-bonds,
%
and $u_{i-1}$ and $u_{i+1}$ are the only two vertices
  adjacent to $u_i$ in $G^{(s)}$.
%
Now, since the vertices in $V_L$ are connected,
  either $u_i$ is the only vertex in $V_L$,
  or $V_L$ contains at least one of $u_{i-1}$ and $u_{i+1}$.
%
\[
  \newcommand{\sz}{4mm}
  \begin{tikzpicture}
    \node (v1)    at ( 0, 0) [blackdot,label=left:$v_1$]{};
    \node (v2)    at ( 0.5*\sz, 2.0*\sz) [blackdot,label=left:$v_2$]{}
      edge[thick, bend right=10] (v1);
    \node (uim1)  at ( 2.0*\sz, 3.7*\sz) [blackdot,blue,label=left:$u_{i-1}$]{}
      edge[dotted, bend right=10] (v2);
    \node (ui)    at ( 5.0*\sz, 4.2*\sz)
      [blackdot,blue,label={[label distance=1mm]above:$u_{i}$}]{}
      edge[blue, thick, bend right=7] (uim1);
    \node (uip1)  at ( 8.0*\sz, 3.7*\sz) [blackdot,blue,label=right:$u_{i+1}$]{}
      edge[blue, thick, bend right=7] (ui);
    \node (vlm1)  at ( 9.5*\sz, 2.0*\sz) [blackdot,label=right:$v_{l-1}$]{}
      edge[dotted, bend right=10] (uip1);
    \node (vl)    at (10.0*\sz, 0) [blackdot,label=right:$v_l$]{}
      edge[thick, bend right=10] (vlm1)
      edge[ultra thick, bend left=10] (v1);

    \node (u1)    at ( 5.0*\sz, 8.7*\sz) [blackdot,blue,label=above:$u_1$]{};
    \node (uj)    at ( 8.0*\sz, 8.0*\sz) [blackdot,blue,label=45:$u_j$]{}
      edge[blue,dotted,thick, bend left=60] (uip1)
      edge[blue,thick, bend right=8] (u1);
    \node (u2)    at ( 2.0*\sz, 8.0*\sz) [blue, blackdot,blue,label=135:$u_2$]{}
      edge[blue,dotted,thick, bend right=60] (uim1)
      edge[blue,thick, bend left=8] (u1);

    % beginning of the L circle
    \draw[draw=black, thick]
      plot [smooth cycle]
      coordinates{ ( 0.8*\sz, 0.6*\sz)
                   ( 2.4*\sz, 3.4*\sz)
                   ( 7.6*\sz, 3.4*\sz)
                   ( 9.2*\sz, 0.6*\sz)
                   ( 5.0*\sz, 0.0*\sz) };

    \node (L) at (5.3*\sz, 2.0*\sz) {$L^{(s)}$};
    % end of the L circle

    % beginning of the J circle
    \draw[thick, draw=blue]
      plot [smooth cycle]
      coordinates{
                   ( 2.0*\sz, 4.5*\sz)
                   ( 1.2*\sz, 5.9*\sz)
                   ( 2.2*\sz, 7.6*\sz)
                   ( 5.0*\sz, 8.3*\sz)
                   ( 7.8*\sz, 7.6*\sz)
                   ( 8.8*\sz, 5.9*\sz)
                   ( 8.2*\sz, 4.5*\sz)
                   ( 5.0*\sz, 4.7*\sz) };

    \node (J) at (5.0*\sz, 7.0*\sz) [blue] {$J$};
    % end of the J circle
  \end{tikzpicture}
\]

By repeating the above argument on $u_{i-1}$ or $u_{i+1}$,
we can show that
  all the joints $v_1$, \dots $v_l$ of $L^{(s)}$
  are also consecutive joints of $J$.
%
This means that the two cycles share the same joints
  [case (b)].
\end{proof}



Since every edge (except the last one) is removed in Step 3 of Algorithm D,
we have
\begin{lemm}
  Every $f$-bond in a $c$-pack is an unordered pivot.
\label{thm:hncfpivot}
\end{lemm}




\subsection{\label{sec:hncFexmuex}Helmholtz free energy, chemical potential, and pressure}


Given a $c$-pack $G$,
  Lemma \ref{thm:hncdecomp} allows us
  to order all cycles that decompose $G$
  according to the simple cycles
  discovered in Algorithm L.
%
Counting vertices and vertex pairs
  are readily established on the simple cycles.
%
First, each step of Algorithm L removes $(l - 2)$ vertices,
  with $l$ being the length of the simple cycle.
%
Thus, the total number of vertices $n(G)$
  is still given by Eq. \eqref{eq:countvertices},
  with $m_l(G)$ interpreted as
  the number of ways
  of decomposing $G$ as length-$l$ cycles.

A cycle of length $l$, by definition,
  contains $l (l - 1)$ ordered pivots,
  and Step 3 of Algorithm D
  removes all but two of them.
%
Thus, Eq. \eqref{eq:countpairs}
  is also applicable, with $p(G)$ interpreted
  as the number of ordered pivots of $G$.



%It can be shown that \cite{morita1958, *morita1959, *morita1960}
%\begin{equation}
%  -\frac{ \beta \Fex }{V}
%=
%  \A \equiv \sum_G \frac{ I(G) }{ s(G) }.
%\label{eq:hncFexA}
%\end{equation}
%A proof will be given in Secs. \ref{sec:hnccavity} and \ref{sec:hncFex}.
%%
%Thus, the free energy can be computed
The free energy can now be computed from Eq. \eqref{eq:hncFexA}
as\cite{morita1958, *morita1960, *morita1960I, singer1985}
%
\begin{align}
    - \frac{ 2 \beta \Fex } { V }
  &=
      \sum_G \frac{ 2 \, I(G) } { s(G) }
      \notag \\
  &=
      \rho^2 \int c(\vr) \, d\vr
    - \sum_{l = 3}^\infty \left[ l(l-1) - 2 \right] \, \Chn_l
      \notag \\
  &=
      \rho^2 \int \left[ c(\vr) - \tfrac{1}{2} t^2(\vr) - t(\vr) \, c(\vr) \right] \, d\vr
      \notag \\
  & \hphantom{=}
      + \int  \tilde{T}(\vk) \, \dvk,
\label{eq:hncF}
\end{align}
%
where,
  on the second line,
  we have used Eqs. \eqref{eq:hnccrsum} and \eqref{eq:countpairs},
  and on the next lines,
  we have used Eqs. \eqref{eq:Clsum3}-\eqref{eq:Clsumll}.
%
Similarly, the chemical potential
  can be computed from Eq. \eqref{eq:hncmugsum}
  as \cite{morita1958, *morita1960, *morita1960I, singer1985}
%
\begin{align}
    - \beta \, \rho \, \muex
  &=
      \sum_G \frac{ n(G) \, I(G) } { s(G) }
  =
      \sum_G \frac{ 2 \, I(G) } { s(G) }
    + \sum_{l = 3}^\infty (l-2) \, \Chn_l
      \notag \\
  &=
      \rho^2 \int c(\vr) \, d\vr
    - \sum_{l = 3}^\infty l \, (l-2) \, \Chn_l
      \notag \\
  &=
      \rho^2 \int \left[ c(\vr) - \tfrac{1}{2} h(\vr) \, t(\vr) \right] \, d\vr.
\label{eq:hncmu}
\end{align}
%
we have used Eqs. \eqref{eq:countvertices}, \eqref{eq:countpairs},
\eqref{eq:hnccrsum}, and \eqref{eq:Clsum_th}.
%Although \eqref{eq:hncmu} assigns the correct weight to each $G$,
%  the sum goes over only a subset (that of $c$-packs) of the biconnected graphs.
%%
%So it is still an approximate relation.
%%


As a check, let us algebraically
derive Eq. \eqref{eq:hncmu} from Eq. \eqref{eq:hncF}.
%
Using Eq. \eqref{eq:muexdFex} and \eqref{eq:intdlogrhoc},
we get from differentiating Eq. \eqref{eq:hncF}:
\[
  -2 \, \beta \, \muex = \rho \int (2\,c - h \, t) \, d\vr
  + \rho^2 \int (\partial_\rho c - h \, \partial_\rho t) \, d\vr.
\]
The second term vanishes because of the HNC closure, Eq. \eqref{eq:hnc}:
$1+h = (1+f) \, \exp t$,
%
  which implies $\partial_\rho h = (1+ h) \, \partial_\rho t$.
%
We then recover Eq. \eqref{eq:hncmu}.



We obtain the pressure from
  $\Pex = \rho \muex - \Fex/V$:
%
\begin{align}
2 \, \beta \Pex
&=
\sum_G \frac{ 2 \, [n(G) - 1] \, I(G) } { s(G) }
\notag \\
&=
\rho^2 \int
  \left[
    \tfrac{1}{2} t^2(\vr) - c(\vr)
  \right] d\vr
  +\int \tilde T(\vk) \dvk.
\label{eq:hncP}
\end{align}
%
We will show in Sec. \ref{sec:vthnc} that
Eq. \eqref{eq:hncP}
is equivalent to the virial-route pressure formula:
\begin{equation}
  \beta \, \Pexv
=
  - \frac{\rho^2}{2D}
  \int (\vr \cdot \nabla\phi) \, g(\vr) \, d\vr.
\label{eq:virialpressure}
\end{equation}
%
The proof was previously sketched\cite{
morita1960, morita1960I}.
It is illustrated in Fig. \ref{fig:iepres}
for the three-dimensional hard-sphere fluid.

\begin{figure}[h]
  \makebox[\linewidth][c]{
    \includegraphics[angle=0, width=0.8\linewidth]{fig/iepres.pdf}
  }%
  \caption{\label{fig:iepres}
  Comparison of the pressure formulae for the PY and HNC equations.}
\end{figure}





\section{\label{sec:virialtheorem}Virial theorem}

Here we derive a virial theorem,
and use it
(a) to simplify Baxter's pressure formula,
and
(b) to show that Eqs. \eqref{eq:hncF} and \eqref{eq:hncmu}
produce the same virial coefficients as Eq. \eqref{eq:virialpressure}.



\subsection{Derivation}

We first define
\begin{equation}
  I^*(G; \rho, \zeta)
  = \rho^{n-1} \int \prod f(\zeta \, \vr_{ij}) \, d\vr_2 \cdots d\vr_n,
  \label{eq:Irhozetadef}
\end{equation}
where $n = n(G)$ is the number of vertices in $G$,
and the inner product goes over all $f$-bonds in the $G$.
%%
%The normal integral is recovered as
%\[
%  I(G) = \rho \, I^*(G; \rho, 1).
%\]
%%
Since the integral in Eq. \eqref{eq:Irhozetadef} is independent of $\rho$,
$I^*(G;\rho, \zeta)$ is a homogeneous function of $\rho$, and
%
\begin{equation}
  \rho \, \partial_\rho I^*(G; \rho, \zeta)
  = (n - 1) \, I^*(G; \rho, \zeta).
  \label{eq:Idrho}
\end{equation}



Now consider the scaling
$\vr'_i \equiv \rho^{1/D} \vr_i$.
Since
\begin{align*}
  I^*(G; \rho, \zeta)
&= \int \prod f(\zeta \, \rho^{-1/D} \vr'_{ij})
        \, d\vr'_2 \cdots d\vr'_n
  \notag \\
&= I^*(G; 1, \zeta \, \rho^{-1/D}),
\end{align*}
%
it follows that
\begin{align}
 \zeta \, \partial_\zeta I^*(G; \rho, \zeta)
&= -D \, \rho \, \partial_\rho I^*(G; \rho, \zeta) \notag \\
&= -D \, [n(G) - 1] \, I^*(G; \rho, \zeta),
\label{eq:drhodzeta}
\end{align}
where we have used Eq. \eqref{eq:Idrho} in the second step.


Consider now an arbitrary sum over all unrooted graphs (polygon packs or $c$-packs)
\[
  A^*(\rho, \zeta) = \sum_G w(G) I^*(G; \rho, \zeta),
\]
where $w(G)$ is some weight.
%
Using Eq. \eqref{eq:drhodzeta} yields,
\begin{align*}
  \zeta \, \partial_\zeta A^*(\rho, \zeta)
&=
  -D \, \rho \, \partial_\rho A^*(\rho, \zeta)
  \\
&=
  -\sum_G w(G) \, \bigl[ n(G) - 1 \bigr] \, I^*(G; \rho, \zeta).
\end{align*}
%or in terms of the graphical sums,
%\begin{align*}
%  \sum_G w(G) J^*(G; \rho, \zeta)
%  &= \zeta \, \partial_\zeta A^*(\rho, \zeta) \notag \\
%  %= -D \, \rho \, \partial_\rho A^*(\rho, \zeta) \notag \\
%  &= \sum_G w(G) \, [n(G) - 1] \, I^*(G; \rho, \zeta).
%\end{align*}
%%
%where
%\begin{equation*}
%  J^*(G; \rho, \zeta)
%  = \rho^{n-1} \int
%  \zeta \, \partial_\zeta
%  \left[
%    \prod f(\zeta \, \vr_{ij})
%  \right] \, d\vr_2 \cdots d\vr_n.
%  \label{eq:Krhozetadef}
%\end{equation*}
%
Finally, we multiply both sides by $\rho$, and
%
\begin{align}
  %\sum_G w(G) J(G, \zeta)
  %&=
  \zeta \, \partial_\zeta A(\rho, \zeta) %\notag \\
  &= -D \, \rho^2 \, \partial_\rho \big[ A(\rho, \zeta)/\rho \big] \notag \\
  &= -\sum_G D \, [n(G) - 1] \, w(G) \, I(G, \zeta),
  \label{eq:virialtheorem}
\end{align}
where
\begin{align*}
  I(G, \zeta)    &= \rho \, I^*(G; \rho, \zeta), &
            I(G) &= I(G, 1), \\
%  J(G, \zeta)    &= \rho \, J^*(G; \rho, \zeta) = \zeta \, \rho \, \partial_\zeta I(G, \zeta), &
%            J(G) &= J(G, 1), \\
  A(\rho, \zeta) &= \rho \, A^*(\rho, \zeta) = \sum_G w(G) \, I(G, \zeta), &
         A(\rho) &= A(\rho, 1).
\end{align*}
%
Note that
$I(G)$ is
%both $I(G)$ and $J(G)$ are
proportional to $\rho^n$, instead of $\rho^{n-1}$.




\subsection{\label{sec:vtpy}Simplified Baxter's pressure formula (PY equation)}



For the PY closure, we use $w(G) = 2/s(G)$
in Eq. \eqref{eq:virialtheorem}
and carry the sum over all polygon packs $G$.
%
Then
%
\begin{align*}
  \sum_G \frac{ 2 \, I(G) } { s(G) }
  =
  \sum_G \frac{ 2 \, n(G) \, I(G) } { s(G) }
  + \frac{ \zeta \partial_\zeta }{ D }
    \mkern-8mu \left. \left(
    \sum_G \frac{ 2 \, I(G, \zeta) } { s(G) }
    \right) \right|_{\zeta = 1}.
\end{align*}


Using Eqs. \eqref{eq:pykappasum} and \eqref{eq:crcompr}, we get
\begin{align}
  -\beta \, \Pex
  =
  \rho^2 \int c(\vr) \, d\vr
  + (1/D) \,
      \partial_\zeta \left( -\beta \Pex \right)
    \Big|_{\zeta = 1}.
\label{eq:pyPsimp1}
\end{align}
%
For the second term on the right-hand side,
we differentiate Eq. \eqref{eq:baxterpressure} with respect to $\zeta$,
and
\begin{align*}
&\hphantom{==}
\partial_\zeta (-\beta \, \Pex) \Big|_{\zeta=1}
\\
&=
\frac{\rho^2}{2}
\int
  \partial_\zeta (c - t \, c)
  \Big|_{\zeta = 1} \, d\vr
+ \rho^2 \int t \, (\partial_\zeta c) \Big|_{\zeta = 1} \, d\vr
\\
&=
\frac{\rho^2}{2}
\int (1+t)^2 \, (\partial_\zeta f) \Big|_{\zeta = 1} \, d\vr
\\
&=
\frac{\rho^2}{2}
\int (1+t)^2 \, (\vr \cdot \nabla f) \, d\vr,
\end{align*}
%
where we have used
\begin{align}
%
\int \partial_\zeta \, \tilde T \, \dvk
&=
  \rho^2 \int \tilde{t} \, \partial_\zeta \tilde{c} \, \dvk
=
  \rho^2 \int t \, \partial_\zeta c \, d\vr,
  \label{eq:dTdzeta} \\
%
  \partial_\zeta \, c
&=
  f \, \partial_\zeta t
  + (1 + t) \, \partial_\zeta f,
  \notag \\
%
  t \, \partial_\zeta \, c - c \, \partial_\zeta t
&=
  -f \, \partial_\zeta t
  + t \, (1 + t) \, \partial_\zeta f,
  \notag \\
%
  (\partial_\zeta f) \Big|_{\zeta = 1}
&= \vr \cdot \nabla f.
  \label{eq:dfdzeta}
\end{align}
%
Note that Eqs. \eqref{eq:dTdzeta} and \eqref{eq:dfdzeta} are general,
whereas the rest two equations result from the PY closure, Eq. \eqref{eq:py},
%
Thus,
\begin{equation}
  -\beta \Pex = \rho^2 \int
  \left\{ c(\vr)
    + \frac{ \big[ t(\vr) + 1 \big]^2 (\vr \cdot \nabla f) }
           { 2 \, D }
  \right\} \, d\vr.
  \label{eq:pyPsimplified}
\end{equation}

For the hard-sphere fluid,
$\vr \cdot \nabla f = r \, f'(r) = \delta(r - 1)$, and
\begin{align}
  -\beta \Pex
&=
  \rho^2 \tilde{c}(0)
  +
  \rho^2 \int
    \frac{ \big[ t(r) + 1 \big]^2 }
         { 2 \, D }
  \, \delta(r - 1)
  \, S_D \, r^{D-1} \, dr
\notag
\\
&=
  \rho^2
  \Bigl\{
    \tilde{c}(0)
  +
  \big[ t(1) + 1 \big]^2 \, B_2
  \Bigr\}
\notag \\
&=
  \rho^2
  \bigl[
    \tilde{c}(0)
  +
    c^2(1^-) \, B_2
  \bigr],
  \label{eq:pyPsimplifiedhs}
\end{align}
%
where
$S_D \, r^{D-1}$ is the surface area of a $D$-dimensional hypersphere of radius $r$,
and $B_2 = S_D / (2D)$.
%
On the last line, we have also used the identity
$0 = g(\vr) = c(\vr) + t(\vr) + 1$
for $|\vr| < 1$.
%
In Fig. \ref{fig:iepres},
we show that
Eqs.
\eqref{eq:baxterpressure},
\eqref{eq:pyPsimplified},
and
\eqref{eq:pyPsimplifiedhs}
yielded the same results
in the three-dimensional hard-sphere fluid.



\subsection{$c(\vr; \zeta) \ne c(\zeta \, \vr)$}


We warn the reader about a possible confusion of notations
shown in the section title.
%
In $c(\vr; \zeta)$,
\emph{every} $f$-bond
in the graphical expansion of $c(\vr; \zeta)$
is affected by $\zeta$.
%
But in $c(\zeta \vr)$,
only the $f$-bond between the roots is affected.
%
Thus,
$c(\vr; \zeta) \ne c(\zeta \, \vr)$,
and, generally
\[
  (\partial_\zeta c) \big|_{\zeta = 1}
\ne
  \vr \cdot \nabla c,
\]
although Eq. \eqref{eq:dfdzeta} is true.
%(with $\zeta$ set to unity only after the differentiation).
%

%The distinction is clearly demonstrated in
For a concrete example,
consider
$c_1(\vr) = (f*f)\cdot f$,
and evaluate the integrals
$J^*_1 = \rho^2 \, \zeta \, \partial_\zeta \int c_1(\vr; \zeta) \, d\vr$
and
$J^*_2 = \rho^2 \, \zeta \, \partial_\zeta \int c_1(\zeta \vr) \, d\vr$.
%
For $J^*_1$,
we have, by Eq. \eqref{eq:drhodzeta},
\begin{align*}
  J^*_1 \big|_{\zeta = 1}
&=
  \left.
  \zeta \, \partial_\zeta \left(
  {
  \begin{tikzpicture}[baseline=1.8mm]
    \newcommand{\sz}{3.0mm}
    \node (r1) at (-\sz, 0) [whitedot,label=left:{\footnotesize$1$}]{};
    \node (r2) at ( \sz, 0) [blackdot,label=right:{\footnotesize$2$}]{}
      edge[inner sep=0.3mm] node[anchor=north] {\footnotesize$\zeta$} (r1);
    \node (r3) at ( 0, 1.8*\sz) [blackdot,label=above:{\footnotesize$3$}]{}
      edge[inner sep=1.0mm] node[anchor=-30] {\footnotesize$\zeta$} (r1)
      edge[inner sep=1.0mm] node[anchor=210] {\footnotesize$\zeta$} (r2);
  \end{tikzpicture}
  }
  \right)
  \right|_{\zeta=1}
= -2 \, D
  {
  \begin{tikzpicture}[baseline=1.8mm]
    \newcommand{\sz}{3.0mm}
    \node (r1) at (-\sz, 0) [whitedot,label=left:{\footnotesize$1$}]{};
    \node (r2) at ( \sz, 0) [blackdot,label=right:{\footnotesize$2$}]{}
      edge[inner sep=0.3mm] (r1);
    \node (r3) at ( 0, 1.8*\sz) [blackdot,label=above:{\footnotesize$3$}]{}
      edge[inner sep=1.0mm] (r1)
      edge[inner sep=1.0mm] (r2);
  \end{tikzpicture}
  }.
\end{align*}
%
%
%
For $J^*_2$, we integrate by parts, and
\begin{align*}
  J^*_2
&=
  \rho^2 \, \int \zeta \, \vr \cdot \nabla c_1(\zeta \, \vr) \, d\vr
  \\
&=
  -\rho^2 \, \int (\nabla \cdot \vr) \, c_1 (\zeta \, \vr) \, \zeta \, d\vr
= -D
  {
  \begin{tikzpicture}[baseline=1.8mm]
    \newcommand{\sz}{3.0mm}
    \node (r1) at (-\sz, 0) [whitedot,label=left:{\footnotesize$1$}]{};
    \node (r2) at ( \sz, 0) [blackdot,label=right:{\footnotesize$2$}]{}
      edge[inner sep=0.2mm] (r1);
    \node (r3) at ( 0, 1.8*\sz) [blackdot,label=above:{\footnotesize$3$}]{}
      edge[] (r1)
      edge[] (r2);
  \end{tikzpicture}
  }.
\end{align*}
%
Thus, $J^*_1 \big|_{\zeta = 1} \ne J^*_2 \big|_{\zeta = 1}$. %, even with $\zeta = 1$.



\subsection{\label{sec:pyPalt}
Alternative derivation of Eq. \eqref{eq:pyPsimplified} (PY equation)}



We can derive Eq. \eqref{eq:pyPsimplified}
without using Eq. \eqref{eq:baxterpressure}
or heavy algebra.
%
We first show that the term $[t(\vr)+1]^2/2$ in Eq. \eqref{eq:pyPsimplified}
resembles the cavity distribution function $y(\vr)$ in the HNC case
[cf. Eq. \eqref{eq:yrfunctional}].
%
We first define an \emph{extended polygon graph}
as a polygon graph that allows any intra-face root pairs,
instead of just those on a side,
as the roots.
%
Thus,
$\newcommand{\hh}{1.6mm}
  \begin{tikzpicture}[baseline=-0.8mm]
    \node (r1) at (-\hh,  -\hh) [whitedot]{};
    \node (r2) at ( \hh,  -\hh) [blackdot]{};
    \node (r5) at (-\hh,   \hh) [blackdot]{};
    \node (r6) at ( \hh,   \hh) [whitedot]{};
    \draw[thick]
          (r1) -- (r2) -- (r6)
          (r1) -- (r5) -- (r6);
  \end{tikzpicture}$
and
$\newcommand{\hh}{1.6mm}
  \begin{tikzpicture}[baseline=-0.8mm]
    \node (r1) at (-\hh,  -\hh) [whitedot]{};
    \node (r2) at ( \hh,  -\hh) [blackdot]{};
    \node (r5) at (-\hh,   \hh) [blackdot]{};
    \node (r6) at ( \hh,   \hh) [whitedot]{};
    \draw[thick] (r1) -- (r6)
          (r1) -- (r2) -- (r6)
          (r1) -- (r5) -- (r6);
  \end{tikzpicture}$
are extended polygon graphs, but
$\newcommand{\hh}{1.6mm}
  \begin{tikzpicture}[baseline=-0.8mm]
    \node (r1) at (-\hh,  -\hh) [blackdot]{};
    \node (r2) at ( \hh,  -\hh) [whitedot]{};
    \node (r5) at (-\hh,   \hh) [whitedot]{};
    \node (r6) at ( \hh,   \hh) [blackdot]{};
    \draw[thick] (r1) -- (r6)
          (r1) -- (r2) -- (r6)
          (r1) -- (r5) -- (r6);
  \end{tikzpicture}$
is not.


\begin{lemm}
In the PY equation,
$t^2(\vr)/2$
is the weighted sum of all nonequivalent extended polygon graphs $G$
with the roots being a nonadjacent intra-face pair,
with the weight of $G$ given by $1/s(G)$;
$f(\vr) \, \bigl[ t(\vr) + 1 \bigr]^2/2$
is the corresponding weighted sum of extended polygon graphs.
\end{lemm}

\begin{proof}
If an extended polygon graph $G$ has a nonadjacent intra-face pair,
  it can be viewed as a parallel composition
  of two pie graphs joined at the pair.
%
Thus, $G$ is included in the expansion of $t^2(\vr)/2$
  by Lemma \ref{thm:pycrsum}.
%
Conversely,
  each graph $G$ in the expansion of $t^2(\vr)/2$
  assumes the form of $H_1 \cdot H_2$,
  where $H_1$ and $H_2$ are pie graphs.
%
Now for the weight.
%
If $H_1$ and $H_2$ are identical,
  the weight is $1/2$,
  which is equal to the inverse of
  the symmetry number $s(G) = 2$
  (for we can collectively exchange
  the labels of the non-root vertices in $H_1$
  and those in $H_2$).
%
Otherwise,
  we also have a symmetric copy of $G' = H_2 \cdot H_1$
  in the expansion.
So the weight $2\cdot(1/2) = 1$ of $H_1 \cdot H_2$
  is equal to the inverse symmetry number $s(G) = 1$.

For the second part regarding adjacent pairs,
  we observe that
  if an adjacent pair is on a side of a polygon,
  then the sum gives $f(\vr) \, [1/2 + t(\vr)]$,
  by Lemma \ref{thm:pycrsum}
  (with the weight of the $f$-graph
  modified by the factor of $1/s = 1/2$).
%
Otherwise,
  $G$ can be viewed as the parallel composition
  of the $f$-graph and two pie graphs $H_1$ and $H_2$,
%
which yields the sum $f(\vr) \, t^2(\vr)/2$,
  following the above reasoning.
%
The sum the two cases gives
  $f(\vr) \, \bigl[ t(\vr) + 1 \bigr]^2/2$.
\end{proof}



By using a proof similar to that for
Lemma \ref{thm:whitenAhnc},
we get

\begin{lemm}
Redefine $\A$ in Eq. \eqref{eq:Adef}
as a sum carried over all polygon packs.
Then, the sums obtained from whitening,
one at a time,
all and nonadjacent intra-face ordered pairs
of all polygon pack $G$ in $\A$
are given by
$\frac{1}{2} \, \rho^2 \, f(\vr) \, [t(\vr) + 1]^2$
and
$\frac{1}{2} \, \rho^2 \, t^2(\vr)$,
respectively.
\label{thm:whitenApy}
\end{lemm}


The above result can also be written
in terms of functional derivatives.
%
We borrow the definitions in
Eqs. \eqref{eq:Apsi} and \eqref{eq:Ipsi},
with two modifications:
(i) the sum over $G$ in Eq. \eqref{eq:Apsi}
is carried over all polygon packs;
(ii) $P(G)$ is replaced to the set of intra-face \emph{unordered} pairs.
%
Since every edge is an unordered intra-face pair,
we have
%
\begin{align*}
\frac 1 2 \times \frac{\rho^2}{2} \, f(\vr) \, \bigl[ t(\vr) + 1 \bigr]^2
&=
\left.
\frac{ \delta \A(\psi_0, \psi_1) } { \delta \psi_1(\vr) }
\right|_{\psi_0 = \psi_1 = 0},
\end{align*}
which can be rewritten,
in analogous to Eq. \eqref{eq:yrfunctional} in the HNC case,
as
\begin{equation}
  \frac{ \delta \A } { \delta f(\vr)}
=
  \frac{ \rho^2 } {4}
  \bigl[ t(\vr) + 1 \bigr]^2.
  \label{eq:yrfunctionalpy}
\end{equation}
%
Similarly, for unordered nonadjacent pairs,
\begin{align*}
\frac{\rho^2}{4} \, t^2(\vr)
&=
\left.
\frac{ \delta \A(\psi_0, \psi_1) } { \delta \psi_0(\vr) }
\right|_{\psi_0 = \psi_1 = 0}.
\end{align*}
%


Equation Eq. \eqref{eq:yrfunctionalpy} leads to
a new derivation of Eq. \eqref{eq:pyPsimplified}.
%
Using Eq. \eqref{eq:pyPgraph}, we get
%
\begin{align*}
  \partial_\zeta (-\beta \Pex) \big|_{\zeta = 1}
&=
  \partial_\zeta \left( \sum_G \frac { 2 \, I(G) } { s(G) } \right) \Bigg|_{\zeta = 1}
\\
&=
  2 \, (\partial_\zeta \A)_{\zeta = 1}
\\
&=
  2 \int \frac{ \delta \A } { \delta f(\vr) } \,
  \big[ \partial_\zeta f(\vr) \big]_{\zeta = 1} \, d\vr
\\
&=
  \frac{\rho^2}{2}
  \int \bigl[ t(\vr) + 1 \bigr]^2 \,
  (\vr \cdot \nabla f) \, d\vr.
\end{align*}
%
Using this in Eq. \eqref{eq:pyPsimp1} yields Eq. \eqref{eq:pyPsimplified}.

Similarly,
for the derivative with respect to $\beta$, we have
\begin{align*}
  \partial_\beta (\beta \Pex)
&=
  -2 \, \partial_\beta \A
%\\
%&=
=
  -2 \int \frac{ \delta \A } { \delta f(\vr) } \,
  \partial_\beta f(\vr) \, d\vr
\\
&=
  \frac{\rho^2}{2}
  \int \bigl[ t(\vr) + 1 \bigr]^2 \,
  \big[ f(\vr) + 1 \bigr] \,
  \phi(\vr) \, d\vr
\\
&=
  \frac{\rho^2}{2}
  \int
  \bigl[ t(\vr) + 1 \bigr] \,
  \phi(\vr) \,
  g(\vr) \,
  d\vr.
\end{align*}
%



\subsection{\label{sec:vthnc}Virial-route nature of
Eqs. \eqref{eq:hncF} and \eqref{eq:hncmu} (HNC equation)}

For the HNC equation,
let us derive Eq. \eqref{eq:hncFexA} from the virial theorem.
%
Differentiating $\A$ with respect to $\zeta$ yields
\begin{align*}
  (\zeta \, \partial_\zeta \A) \big|_{\zeta = 1}
&=
  \int \frac{ \delta \A } { \delta f(\vr) } \,
  \big[ \zeta \partial_\zeta f(\vr) \big]_{\zeta = 1} \, d\vr
  \\
&=
  \frac{\rho^2}{2}
  \int y(\vr) \,
  (\vr \cdot \nabla f) \, d\vr
  \\
&=
  -\frac{ \beta \, \rho^2}{2}
  \int (\vr \cdot \nabla \phi) \, g \, d\vr
= D \, \beta \, \Pexv,
\end{align*}
where we have used Eqs. \eqref{eq:yrfunctional},
\eqref{eq:dfdzeta}, and \eqref{eq:virialpressure}.
%The last step follows from the classic formula of virial-route pressure.
%
Using Eq. \eqref{eq:virialtheorem}
with $w(G) = 1/s(G)$, we get
\begin{align*}
  -\rho^2 \partial_\rho ( \A/\rho )
=
  \frac{1}{D} (\zeta \, \partial_\zeta \A) \big|_{\zeta = 1}
=
  \beta \, \Pexv.
\end{align*}
%
But from thermodynamics, we have
\begin{align*}
  \Pexv
=
  -\partial_V \bigl( \Fexv \bigr)_N
=
  \rho^2 \partial_\rho \bigl( \Fexv/N \bigr)_N.
\end{align*}
%
Thus,
$\partial_\rho (\A/\rho)  = -\partial_\rho( \beta \, \Fexv/N )$,
and an integration of $\rho$ from 0,
with $\A \big|_{\rho = 0} = \Fexv \big|_{\rho = 0} = 0$, yields
\[
  \A/\rho = -\beta \, \Fexv/N.
\]
%we get the virial route pressure formula
%\begin{equation}
%  \beta \, \Pexv = \frac{\rho^2} {2D} \, \int (\vr \cdot \nabla f) \, y \, d\vr.
%  \label{eq:Pvirial}
%\end{equation}
This show the free energy $\Fex$ in
Eqs. \eqref{eq:hncFexA} and \eqref{eq:hncF}
is the virial-route result $\Fexv$.
%
%As shown in Sec. \ref{sec:hncFexmuex},
%\eqref{eq:hncmu}
%is related to \eqref{eq:hncF}
%by a differentiation with respect to $\rho$.
%
Further, the excess chemical potential
$\muex$ in Eqs. \eqref{eq:hncmugsum} and \eqref{eq:hncmu}
is also the virial-route result,
for it is obtained from differentiating $\Fex$
with respect to $\rho$
[see Eq. \eqref{eq:muexdFex}].
%
In other words,
the virial coefficients computed from
Eqs. \eqref{eq:hncF} or \eqref{eq:hncmu}
are the same as those computed from
Eq. \eqref{eq:virialpressure},
and Eqs. \eqref{eq:hncP} and \eqref{eq:virialpressure}
are equivalent in the HNC equation.



Below we verify this algebraically\cite{morita1960}
without using Eq. \eqref{eq:yrfunctional}.
%
We now differentiate Eq. \eqref{eq:hncF} with respect to $\zeta$,
\begin{align}
  \left. \partial_\zeta \left(-\frac{ \beta\,\Fex }{ V }\right) \right|_{\zeta = 1}
&=
\frac{\rho^2}{2} \int
  \bigl[
    \partial_\zeta c - (c + t) \, \partial_\zeta t
  \bigr]_{\zeta = 1} \, d\vr
  \notag \\
&= \frac{\rho^2}{2} \int (\partial_\zeta f)_{\zeta = 1} \, y \, d\vr
  \notag \\
&= \frac{\rho^2}{2} \int (\vr \cdot \nabla f) \, y \, d\vr
%  \notag \\
= D \, \beta \, \Pexv,
  \notag
%  \label{eq:hncdFdzeta1}
\end{align}
%
where we have used Eq. \eqref{eq:dTdzeta},
\[
  \partial_\zeta c
  = (1 + c + t) \, \partial_\zeta t
  + y \, \partial_\zeta f - \partial_\zeta t,
\]
which is obtained from
differentiating the closure, Eq. \eqref{eq:hnc},
then using Eqs. \eqref{eq:dfdzeta}, and \eqref{eq:virialpressure}.

Now, by setting $A \rightarrow \Fex / V$
in Eq. \eqref{eq:virialtheorem}, we get
\begin{align}
  \zeta \, \partial_\zeta (\Fex/V) \Big|_{\zeta = 1}
  = -D \, \rho^2 \, \partial_\rho (\Fex/N)
  %  \notag \\
  = D \, \partial_V (\Fex)_N.
    \notag %\\
%  &= D \beta \Pex,
%    \label{eq:hncdFdzeta2}
\end{align}
Thus, $-\partial_V (\Fex)_N = \Pexv$,
and hence $\Fex$ from Eq. \eqref{eq:hncF}
is the virial-route result.
%





\section{Zero separation theorem}

Finally, for the hard-sphere fluid, we have an additional formula,
  which computes the virial coefficients
  from the cavity distribution function $y(\vr)$\cite{hoover1962}:
%
\begin{equation}
  \log y(\vct0) = \beta \muex.
  \label{eq:yrzerosep}
\end{equation}
%
We now show this graphically.
%
Every graph included in $y(\vr)$
  has two nonadjacent roots\cite{hansen},
%
  and joining the roots
  yields a biconnected graph in $c(\vr)$,
  by Lemma \ref{thm:crsplit}.
%
Taking the logarithm further
  removes any graph in $y(\vr)$
  whose roots form
  a separation pair\cite{hansen}.
%
Thus, when the roots of a graph $H$ in $\log y(\vr)$
  are merged as $\vr \rightarrow \vct0$,
  the resulting graph $G$ is biconnected,
  for the merged root in $G$ is not an articulation point.


Now consider a particular $G$,
  in which there are $K$ vertices $v_1, \dots, v_K$ adjacent to the root.
%
We collect all graphs $H$ that can be reduced to $G$
  by the above root merging (see below).
\[
  {
  \begin{tikzpicture}[baseline=1.2mm]
    \newcommand{\sz}{4.0mm}
    \node (r1) at (-\sz, 0) [whitedot,label=left:{\footnotesize$1$}]{};
    \node (r2) at ( \sz, 0) [whitedot,label=right:{\footnotesize$2$}]{};
    \node (v1) at (-2.0*\sz, 2*\sz) [blackdot,label=above:{\footnotesize$v_1$}]{}
        edge[thick] (r1)
        edge[thick, dashed] (r2);
    \node (v2) at (-0.5*\sz, 2*\sz) [blackdot,label=above:{\footnotesize$v_2$}]{}
        edge[thick] (r1)
        edge[thick, dashed] (r2);
    \node (vK) at ( 2.0*\sz, 2*\sz) [blackdot,label=above:{\footnotesize$v_K$}]{}
        edge[thick] (r1)
        edge[thick, dashed] (r2);
    \node (elps) at (0.8*\sz, 2*\sz) [label=above:{\footnotesize$\cdots$}]{};
  \end{tikzpicture}
  }
\]
%
In $H$, each $v_k$ ($1 \le k \le K$) is adjacent to
  either root 1 only,
  or root 2 only,
  or both roots,
  except the two cases in which all $v_1, \dots, v_K$ are adjacent to the same root only.
%
Since for the hard-sphere potential $f^2 = -f$,
%
the sum of all the above graphs $H$
  multiplies the contribution of $G$ by
  $(1 + 1 - 1)^K - 2 = -1$.
%
Thus, $\log y(\vct0) = (-1) \cdot \sum_G I(G)/s(G)$,
  where the sum is carried over all one-root unlabeled biconnected graphs $G$.
According to Sec. \ref{sec:bcsums},
  the sum is equal to $-\beta \muex$,
  which proves Eq. \eqref{eq:yrzerosep}.



\bibliography{liquid}
\end{document}

