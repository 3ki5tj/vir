%\documentclass{revtex4-1}
% options: aip, jcp, reprint, preprint
\documentclass[notitlepage,preprint]{revtex4-1}
%\documentclass[aip,jcp,reprint,superscriptaddress]{revtex4-1}

\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{graphicx}
\usepackage{dcolumn}
\usepackage{bm}
\usepackage{tikz}
%\usepackage{setspace}

\newtheorem{defn}{Definition}
\newtheorem{thrm}{Theorem}
\newtheorem{lemm}[thrm]{Lemma}
\newtheorem{prop}[thrm]{Proposition}

\newcommand{\vct}[1]{\mathbf{#1}}
\providecommand{\vr}{} % clear \vr
\renewcommand{\vr}{\vct{r}}
\newcommand{\vk}{\vct{k}}
\newcommand{\dvk}{\frac{d\vk}{(2\pi)^D}}
\newcommand{\tdvk}{\tfrac{d\vk}{(2\pi)^D}}

% add a superscript ``ex''
\newcommand{\supex}[1]{ { { #1 }^{ \mathrm{ex} } } }
\newcommand{\Pex}{\supex{P}}
\newcommand{\Fex}{\supex{F}}
\newcommand{\muex}{\supex{\mu}}
\newcommand{\kex}{\supex{\kappa}}

\newcommand{\secref}[1]{Sec. \ref{#1}}

\newcommand{\llbra}{[\![}
\newcommand{\llket}{]\!]}

\begin{document}

\title{Supplemental material: Thermodynamic integrals in integral equations}

%\author{C.-L. Lai}
%\author{C. Zhang}
%\author{B.M. Pettitt}
%\email{mpettitt@utmb.edu}
%\affiliation{
%  Sealy Center for Structural Biology and Molecular Physics,
%  Department of Biochemistry and Molecular Biology, \\
%  The University of Texas Medical Branch,
%  Galveston, Texas 7755, USA
%}
%\begin{abstract}
%\end{abstract}

\maketitle



%\appendix



\section{Basics}

We first repeat a few basic formulas in the main text.
%
The virial expansion is
%
\begin{equation}
  \beta P = \rho + B_2 \rho^2 + B_3 \rho^3 + \cdots,
\label{eq:virial}
\end{equation}
%
where $\beta = 1/(k_B T)$ is the inverse temperature.

The theory of integral equations involves
  the direct correlation function $c(\vr)$
  and the indirect correlation function $t(\vr)$.
%
The Ornstein-Zernike (OZ) relation\cite{hansen} reads
%
\begin{align}
  t(\vr) &= \rho [c * (c + t)](\vr), \notag \\
         &= \rho (c*c)(\vr) + \rho^2 (c*c*c)(\vr) + \cdots
\label{eq:oz}
\end{align}
%
where ``$*$'' denotes a convolution:
\begin{equation}
  (a * b)(\vr) = \int d\vr' a(\vr - \vr') \, b(\vr').
\label{eq:convol}
\end{equation}
%
The Percus-Yevick (PY) closure\cite{percusyevick} reads
%
\begin{equation}
  c(\vr) = f(\vr) + f(\vr) \, t(\vr),
  \label{eq:py}
\end{equation}
where
\begin{equation}
  f(\vr) = e^{-\beta \phi(\vr)} - 1,
  \label{eq:fbond}
\end{equation}
with $\phi(\vr)$ being the pair potential.
%
Alternatively, the hypernetted-chain (HNC) closure\cite{
morita1958, *morita1959, *morita1960} reads
%
\begin{align}
  c(\vr) &= f(\vr) \, e^{t(\vr)} - t(\vr) - 1 \notag \\
         &= \sum_{m=0}^\infty
                \Big\{ \llbra m \ge 2 \llket + f(\vr) \Big\}
                \frac{ t^m(\vr) }{ m! },
  \label{eq:hnc}
\end{align}
%
where $\llbra P \llket$ is the Iverson bracket, which is 1 if condition $P$ is true, or 0 otherwise.

Below we shall express thermodynamic quantities
  as integrals of $c(\vr)$ and $t(\vr)$
  by a graphic analysis,
%
and the virial coefficients $B_n$ in \eqref{eq:virial}
  can be found from these expressions.
%
Table \ref{tab:thermodyn}
  summarizes the main results.

\ifdim \columnwidth < 4in
  \newcommand{\tabscale}{1.0}
\else
  % shrink the table in the preprint mode
  \newcommand{\tabscale}{0.85}
\fi

%\begin{turnpage}
\begin{table*}
\setlength{\tabcolsep}{2pt}
%\setlength\extrarowheight{4pt}
\caption{
  Thermodynamic quantities from integrals of $c(\vr)$ and $t(\vr)$
}
\label{tab:thermodyn}
% shrink the table in the preprint mode
\scalebox{\tabscale}{
\begin{tabular}{p{1.3cm} p{1.2cm} c l r p{1.6cm} c l}
  \hline
  \hline
  \noalign{\smallskip}
  \phantom
  &
  \multicolumn{3}{c}{PY}
  &
  \phantom &
  \multicolumn{3}{c}{HNC}
  \\[-2mm]
  \cline{2-4}
  \cline{6-8}
  \noalign{\smallskip}
  Graph sum$^*$
  &
  Thermo. quantity$^\#$ &
  Series &
  Integral &
  &
  Thermo. quantity$^\#$ &
  Series &
  Integral
  \\
  %[4pt]
  \noalign{\smallskip}
  \hline
  \noalign{\smallskip}
  %
  %
  %
  %
  %
  $\begin{aligned} \sum_G \frac{ 2 \, I }{ s } \end{aligned}$ &
  %
  % PY
  %
  $\begin{aligned} -\beta \Pex \end{aligned}$
  &
  $\begin{aligned} -\sum_n B_n \rho^n \end{aligned}$
  &
  $\begin{aligned} \rho^2 \int \frac{1}{2} c \, (1 - h) \, d\vr
    - {S}^\S \end{aligned}$
  &
  &
  %
  % HNC
  %
  $\begin{aligned} -\frac{ 2 \beta \Fex }{ V } \end{aligned}$
  &
  $\begin{aligned} - \sum_n \frac{ 2 }{ n - 1 } B_n \rho^n \end{aligned}$
  &
  $\begin{aligned} \rho^2 \int \left( c - \frac{1}{2} h^2 \right) \, d\vr
    - {S}^\S \end{aligned}$
  \\
  %[4pt]
  \noalign{\smallskip}
  %
  %
  %
  %
  %
  $\begin{aligned} \sum_G \frac{ 2 \, n \, I }{ s } \end{aligned}$ &
  %
  % PY
  %
  $\begin{aligned} -\beta \kex^\dagger \end{aligned}$
  &
  $\begin{aligned} -\sum_n n B_n \rho^n \end{aligned}$
  &
  $\begin{aligned} \rho^2 \int c \, d\vr \end{aligned}$
  &
  &
  %
  % HNC
  %
  $\begin{aligned} -2 \rho \, \beta \muex^\ddagger \end{aligned}$
  &
  $\begin{aligned} -\sum_n \frac{ 2 n }{ n - 1 } B_n \rho^n \end{aligned}$
  &
  $\begin{aligned} \rho^2 \int (2 \, c - h \, t ) \, d\vr \end{aligned}$
  \\
  %[4pt]
  \noalign{\smallskip}
  %
  %
  %
  %
  %
  $\begin{aligned} \sum_G \frac{ 2 \, p \, I }{ s } \end{aligned}$
  &
  %
  % PY
  %
  $\begin{aligned} -\beta \supex{\chi}^{\P} \end{aligned}$
  &
  $\begin{aligned} -\sum_n n (n - 1) \, B_n \, \rho^n \end{aligned}$
  &
  $\begin{aligned} \rho^2 \int ( c + h \, t ) \, d\vr \end{aligned}$
  &
  &
  %
  % HNC
  %
  $\begin{aligned} -2 \beta \kex^\dagger \end{aligned}$
  &
  $\begin{aligned} -\sum_n 2 n B_n \rho^n \end{aligned}$
  &
  $\begin{aligned} \rho^2 \int 2 \, c \, d\vr \end{aligned}$
  \\
  %[4pt]
  \noalign{\smallskip}
  \hline
  \noalign{\smallskip}
  %
  %
  %
  %
  %
  %
  \multicolumn{8}{p{\textwidth}}{
    $^*$ $I$, $s$, $n$, $p$ are
    the integral,
    the symmetry number,
    the number of vertices,
    the number of ordered intra-face pairs (or pivots)
    of graph $G$, respectively.
  }
  \\
  \noalign{\smallskip}
  %
  \multicolumn{8}{l}{
    $^\#$
    The superscript ``ex'' means that the excess (non-ideal-gas) part.
  }
  \\
  \noalign{\smallskip}
  %
  \multicolumn{8}{l}{
    $^\S$
    $\begin{aligned}
        S
      \equiv
         \int \Big\{
                  \log\left[ 1 - \rho \, \tilde{c}(\vk)\right]
                 + \rho \, \tilde{c}(\vk)
              \Big\} \, \dvk
      \end{aligned}$.
  }
  \\
  \noalign{\smallskip}
  %
  \multicolumn{8}{l}{
    $^\dagger$
    The bulk modulus is defined as
    $\begin{aligned}
        \kex
      \equiv
        \rho \, \partial \Pex / \partial \rho
    \end{aligned}$.
  }
  \\
  \noalign{\smallskip}
  %
  \multicolumn{8}{l}{
    $^\ddagger$
    The chemical potential is related to the pressure as
    $\begin{aligned}
        \rho \, \partial \muex / \partial \rho
      =
        \partial \Pex / \partial \rho
    \end{aligned}$.
  }
  \\
  \noalign{\smallskip}
  %
  \multicolumn{8}{l}{
    $\begin{aligned}
      ^\P \supex{\chi}
      \equiv
      ( \rho^2 / 2 ) ( \partial^2 \Pex / \partial \rho^2 )
    \end{aligned}$.
  }
  \\
  \noalign{\smallskip}
  \hline
\end{tabular}
} % \scalebox
\end{table*}
%\end{turnpage}



\tikzstyle{blackdot}=[circle,draw=black,fill=black,
                      inner sep=0pt,minimum size=1.5mm]
\tikzstyle{whitedot}=[circle,draw=black,fill=white,
                      inner sep=0pt,minimum size=1.5mm]
\tikzstyle{combine}=[green!30!black, very thick, densely dotted]
\tikzstyle{concat}=[blue!40!black, very thick, densely dashed]



\section{\label{sec:graph}Graphic representation of cluster integrals}




Here we briefly review the graphic representation in liquid theory\cite{hansen}.
%
We first list a few basic terms in the graph theory.
%
A \emph{graph} $G$ consists of
  a set of \emph{vertices} $V = \{v_1, \dots, v_n\}$
    (drawn as dots)
  and
  a set of \emph{edges} $E$ joining the vertices
    (drawn as lines).
%
Two vertices are \emph{adjacent} if they are joined by an edge;
%
two edges are \emph{adjacent} if they share a vertex.
%
A graph is \emph{connected}
  if any two vertices are connected
  by a sequence of adjacent edges.
%
An \emph{induced subgraph} $G(V')$ is obtained
  from keeping only a subset $V'$ of $V$
  and the edges between the vertices in $V'$.



In liquid theory,
  each graph represents an integral.
%
A vertex $i$ is associated to a spatial point
  and its coordinates $\vr_i$.
%
The coordinates of a \emph{root} vertex,
  or simply a \emph{root} (drawn as a white dot),
  are given and fixed.
%
The coordinates of a non-root vertex
  (drawn as a black dot)
  are to be integrated over.
%
In our case, a non-root vertex
  also contributes a factor of $\rho$ (density)
  to the integrand.
%
An edge between vertices $i$ and $j$
  contributes a factor $f(\vr_{ij})$
  [defined in \eqref{eq:fbond}],
  with
  $\vr_{ij} \equiv \vr_i - \vr_j$.
%
For example,
\[
  {
  \begin{tikzpicture}[baseline=1.2mm]
    \newcommand{\sz}{2.0mm}
    \node (r1) at (-\sz, 0) [whitedot,label=left:{\footnotesize$1$}]{};
    \node (r2) at ( \sz, 0) [whitedot,label=right:{\footnotesize$2$}]{};
    \node (r3) at ( \sz, 2*\sz) [blackdot,label=right:{\footnotesize$3$}]{};
    \node (r4) at (-\sz, 2*\sz) [blackdot,label=left:{\footnotesize$4$}]{};
    \draw (r1) -- (r2) -- (r3) -- (r4) -- (r1) -- (r3);
  \end{tikzpicture}
  }
  =
  \rho^2 \int
    d\vr_3 \, d\vr_4 \,
    f(\vr_{12}) f(\vr_{23}) f(\vr_{34}) f(\vr_{41}) f(\vr_{13}).
\]



By the translational symmetry,
  a graph $A$ rooted at two vertices $1$ and $2$
  can be written as a function $a(\vr)$
  of $\vr \equiv \vr_{12}$
  (we use capital letters for graphs,
  and the lowercase letters for the corresponding functions).
%
The spatial correlation functions,
  such as $c(\vr)$ and $t(\vr)$,
  are all sums of 2-root graphs.



For a graph of no root,
  we avoid integrating the last vertex
  to keep the integral finite, e.g.,
%
%For example,
\[
  {
  \begin{tikzpicture}[baseline=1.8mm]
    \newcommand{\sz}{2.5mm}
    \node (r1) at (-\sz, 0) [blackdot,label=left:{\footnotesize$1$}]{};
    \node (r2) at ( \sz, 0) [blackdot,label=right:{\footnotesize$2$}]{};
    \node (r3) at ( 0, 1.8*\sz) [blackdot,label=above:{\footnotesize$3$}]{};
    \draw (r1) -- (r2) -- (r3) -- (r1);
  \end{tikzpicture}
  }
  =
  \rho^3 \int
    d\vr_2 \, d\vr_3 \,
    f(\vr_{12}) f(\vr_{23}) f(\vr_{31}).
\]
%
The choice of the last vertex is arbitrary
  for it alters only the origin of the integration,
  but not the value. % of the integral.
%
Graphs in the virial expansion \eqref{eq:virial}
  are of this type.



\subsection*{Series-parallel graphs}



In integral equations,
  $c(\vr)$ and $t(\vr)$
  only include
  \emph{series-parallel graphs},
%
which can be constructed
  hierarchically by successive
  serial and parallel compositions (defined below)
  starting from a few $f$-graphs\cite{eppstein1992}.



The \emph{parallel composition} $A \cdot B$
  of two 2-root graphs $A$ and $B$
  is formed by joining the corresponding roots,
%
e.g.,
%
\[
  \newcommand{\sz}{5mm}
  \newcommand{\dy}{.5*\sz}
  \newcommand{\oy}{\sz + 2*\dy}
  \newcommand{\py}{\sz + \dy}
  \newcommand{\wz}{1.4*\sz}
  \newcommand{\dx}{3.5*\sz}
  \newcommand{\px}{1.0*\wz + \dx}
  %
  %
  % example of parallel composition
  %
  %
  \begin{tikzpicture}[baseline=2.5mm]
    %
    % the two individual graphs
    %
    \node (r1)  at (-0.2*\wz, \oy)        [whitedot]{};
    \node (r2)  at ( 0.5*\wz, \oy + \sz)  [blackdot]{};
    \node (r3)  at ( 1.2*\wz, \oy)        [whitedot]{};
    %
    \node (r4)  at (-0.2*\wz, \sz)        [whitedot]{}
      edge[combine, bend left] (r1);
    \node (r5)  at ( 0.0*\wz, 0)          [blackdot]{};
    \node (r6)  at ( 1.0*\wz, 0)          [blackdot]{};
    \node (r7)  at ( 1.2*\wz, \sz)        [whitedot]{}
      edge[combine, bend right] (r3);
    %
    \draw[thick]
          (r1) -- (r2) -- (r3)
          (r4) -- (r5) -- (r6) -- (r7) (r4) -- (r6);

    %
    % the composite graph
    %
    \node (s1)  at (\px - 0.2*\wz, \py)       [whitedot]{};
    \node (s2)  at (\px + 0.5*\wz, \py + \sz) [blackdot]{};
    \node (s3)  at (\px + 1.2*\wz, \py)       [whitedot]{};
    \node (s5)  at (\px,           \py - \sz) [blackdot]{};
    \node (s6)  at (\px + 1.0*\wz, \py - \sz) [blackdot]{};
    \draw[thick]
          (s1) -- (s2) -- (s3)
          (s1) -- (s5) -- (s6) -- (s3) (s1) -- (s6);

    % the horizontal arrow between the two graphs
    \node (leftfig) at (\wz + \wz*.5, \py) {}
      edge[->, thick] (\px - \wz*.7, \py);
  \end{tikzpicture}
  \;.
\]
%
The value of $A \cdot B$
  is $a(\vr) \, b(\vr)$.
%
Generally,
  the parallel composition of several graphs $A_1$, \dots, $A_m$
  is equal to $a_1(\vr) \cdots a_m(\vr)$.


A \emph{series composition} $A*B$
  joins $A$ and $B$ in a head-to-tail manner, e.g.,
%
\[
  \newcommand{\sz}{6mm}
  \newcommand{\del}{1.0*\sz}
  \newcommand{\sep}{2.5*\sz}
  \newcommand{\px}{2*\sz + \del + \sep}
  %
  %
  % example of series composition (chain)
  %
  %
  \begin{tikzpicture}[baseline=0.5mm]
    %
    % the two individual graphs
    %
    \node (r1)  at (0,              0)        [whitedot]{};
    \node (r2)  at (.5*\sz,         0 + \sz)  [blackdot]{};
    \node (r3)  at (\sz,            0)        [whitedot]{};
    %
    \node (r4)  at (\sz + \del,     0)        [whitedot]{}
      edge[concat, bend left]  % [<->]
        node[anchor=south] {$*$} (r3);
    \node (r5)  at (1.0*\sz + \del, 0 + \sz)  [blackdot]{};
    \node (r6)  at (2.0*\sz + \del, 0 + \sz)  [blackdot]{};
    \node (r7)  at (2.0*\sz + \del, 0)        [whitedot]{};
    %
    \draw[thick]
          (r1) -- (r2) -- (r3) -- (r1)
          (r4) -- (r5) -- (r6) -- (r7) -- (r4) -- (r6);

    % the concatenated graph
    \node (s1)  at (\px,           0)        [whitedot]{};
    \node (s2)  at (\px + .5*\sz,  0 + \sz)  [blackdot]{};
    \node (s3)  at (\px + \sz,     0)        [blackdot]{};
    \node (s5)  at (\px + 1.0*\sz, 0 + \sz)  [blackdot]{};
    \node (s6)  at (\px + 2.0*\sz, 0 + \sz)  [blackdot]{};
    \node (s7)  at (\px + 2.0*\sz, 0)        [whitedot]{};
    \draw[thick]
          (s3) -- (s1) -- (s2) -- (s3) -- (s5) -- (s6) -- (s7) -- (s3) -- (s6);

    % the vertical arrow between the two graphs
    \node (leftfig) at (\px - 0.8*\sep, 0.5*\sz) {}
      edge[->, thick] (\px - 0.2*\sep, 0.5*\sz);
  \end{tikzpicture}
  \;.
\]
The merged and blackened root is called the \emph{joint}.
%
The value of $A*B$ is a convolution $\rho \cdot (a*b)(\vr)$.
%
Generally, a series composition,
  or a \emph{chain},
  of several graphs
  $A_1$, \dots, $A_l$ is equal to
  $\rho^{l-1} \cdot (a_1 * \cdots * a_l)(\vr)$.



A \emph{cycle} is a circular series composition,
%
e.g.,
%
\[
  \newcommand{\sz}{5mm}
  \newcommand{\sep}{3.0*\sz}
  \newcommand{\px}{3*\sz + \sep}
  %
  %
  % example of circular concatenation (cycle)
  %
  %
  \begin{tikzpicture}[baseline=2mm]
    %
    % the three individual graphs
    %
    \node (r1)  at (-0.5*\sz,   0)            [whitedot]{};
    \node (r2)  at (-1.6*\sz,   0)            [blackdot]{};
    %\node (r2)  at (-1.716*\sz, 0 - .106*\sz) [blackdot]{};
    \node (r3)  at (-1.2*\sz,   0 + \sz)      [whitedot]{};
    %
    \node (r4)  at (-0.7*\sz,   0 + 1.8*\sz)  [whitedot]{}
      edge[concat, inner sep = 0pt, bend right]
        node[anchor=north west] {$*$} (r3);
    \node (r5)  at (-0.5*\sz,   0 + 2.5*\sz)  [blackdot]{};
    \node (r6)  at ( 0.5*\sz,   0 + 2.5*\sz)  [blackdot]{};
    \node (r7)  at ( 0.7*\sz,   0 + 1.8*\sz)  [whitedot]{};
    %
    \node (r8)  at ( 1.2*\sz,   0 + \sz)      [whitedot]{}
      edge[concat, inner sep = 0pt, bend right]
        node[anchor=north east] {$*$} (r7);
    \node (r9)  at ( 1.6*\sz,   0)            [blackdot]{};
    \node (r10) at ( 0.5*\sz,   0)            [whitedot]{}
      edge[concat] (r1);
      %edge[concat, inner sep = 3pt, bend left]
        %node[anchor=south] {$*$} (r1);
    %
    \draw [thick]
      (r1) -- (r2) -- (r3) -- (r1)
      (r4) -- (r5) -- (r6) -- (r7) -- (r4)
      (r8) -- (r9) -- (r10) -- (r8);

    %
    % the concatenated graph
    %
    \node (s1)  at (\px +         0, 0)            [blackdot]{};
    %\node (s2)  at (\px - 1.216*\sz, 0 - .106*\sz) [blackdot]{};
    \node (s2)  at (\px - 1.1*\sz,   0)            [blackdot]{};
    \node (s3)  at (\px - 0.7*\sz,   0 + \sz)      [blackdot]{};
    %
    \node (s5)  at (\px - 0.5*\sz,   0 + 1.7*\sz)  [blackdot]{};
    \node (s6)  at (\px + 0.5*\sz,   0 + 1.7*\sz)  [blackdot]{};
    \node (s7)  at (\px + 0.7*\sz,   0 + 1*\sz)    [blackdot]{};
    %
    \node (s9)  at (\px + 1.1*\sz,   0*\sz) [blackdot]{};
    %
    \draw [thick]
      (s1) -- (s2) -- (s3) -- (s1)
      (s3) -- (s5) -- (s6) -- (s7) -- (s3)
      (s7) -- (s9) -- (s1) -- (s7);

    % the vertical arrow between the two graphs
    \node (topfig) at (\px -1.2*\sz - 0.9*\sep, 1.0*\sz) {}
      edge[->, thick] (\px -1.2*\sz - 0.2*\sep, 1.0*\sz);
  \end{tikzpicture}
  \;.
\]
%
A cycle of $A_1$, \dots, $A_l$ is equal to
%
\begin{align}
      \rho^l (a_1 * \cdots * a_l)(\vct{0})
  &=
      \rho^l
      \int (a_1 * \cdots * a_{l-1})(\vr) \, a_l(\vr) \, d\vr
      \notag \\
  &=
      \rho^l
      \int \tilde{a}_1(\vk) \cdots \tilde{a}_l(\vk) \, \dvk,
\label{eq:cyclesp}
\end{align}
%
where
  $\tilde{a}_i(\vk) = \int a_i(\vr) e^{-i \vk \cdot \vr} \, d\vr$
  denotes the Fourier transform of $a_i(\vr)$.
%
We have also assumed that
  $a_i(\vr)$ is an even function of $\vr$,
  such that
  $\tilde{a_i}(\vk) = \tilde{a_i}(-\vk)$.





\section{\label{sec:py}PY approximation and polygon graphs}





We now characterize the graphs involved in $c(\vr)$
  in the PY closure \eqref{eq:py}.
%
A \emph{polygon graph} $G$ satisfies
  %
  1) the vertices of $G$ can be placed
  %on a polygon inscribed in a circle,
  on a convex polygon
  with no edges intersecting,
  %and labelled from 1 to $n$ in a clockwise fashion,
  %such that no two edges are intersecting;
  %
  %2) the consecutive vertices
  %$1$ and $2$, $2$ and $3$, \ldots,
  %or $n$ and $1$ ($\equiv n+1$) are adjacent.
  2) all sides of the polygon are edges.
%
We label the vertices from $1$ to $n$ in a clockwise fashion,
  and mark vertices $1$ and $n$ as the only two roots.
%
If $n = 2$, the graph
  \begin{tikzpicture}
    \node (r1) at (-3mm, 0) [whitedot]{};
    \node (r2) at ( 3mm, 0) [whitedot]{};
    \draw (r1) -- (r2);
  \end{tikzpicture},
  or the \emph{$f$-graph} hereinafter,
  is also defined as a polygon graph.
%
Further,
  a \emph{pie graph}
  is defined as
  a polygon graph with a missing edge between the roots.
%
Below are two examples.
%
\[
  %
  %
  % example of a polygon graph
  % (left panel)
  %
  %
  \newcommand{\sz}{0.6cm}
  \begin{tikzpicture}
    \node (r1) at (-90+360.0/7*6.5 : \sz) [whitedot,label=left:\small{$1$}]{};
    \node (r2) at (-90+360.0/7*5.5 : \sz) [blackdot,label=left:\small{$2$}]{};
    \node (r3) at (-90+360.0/7*4.5 : \sz) [blackdot,label=left:\small{$3$}]{};
    \node (r5) at (-90+360.0/7*2.5 : \sz) [blackdot,label=right:\small{$n-2$}]{};
    \node (r6) at (-90+360.0/7*1.5 : \sz) [blackdot,label=right:\small{$n-1$}]{};
    \node (r7) at (-90+360.0/7*0.5 : \sz) [whitedot,label=right:\small{$n$}]{};
    \node (r4) at (-90+360.0/7*3.5 : \sz) [blackdot,label=above:\small{}]{}
      edge[densely dotted, thick, bend right=15] (r3)
      edge[densely dotted, thick, bend left=15] (r5);
    \draw[thick]
          (r1) -- (r2) -- (r3) (r5) -- (r6) -- (r7) -- (r1)
          (r2) -- (r4) (r5) -- (r1) (r5) -- (r7);
    \node (polygon) at (0, -\sz-0.2) [anchor=north] {Polygon graph};
  \end{tikzpicture}
  \hphantom{wwwww}
  %
  %
  % example of a pie graph
  % (right panel)
  %
  %
  \begin{tikzpicture}
    \node (r1) at (-90+360.0/7*6.5 : \sz) [whitedot,label=left:\small{$1$}]{};
    \node (r2) at (-90+360.0/7*5.5 : \sz) [blackdot,label=left:\small{$2$}]{};
    \node (r3) at (-90+360.0/7*4.5 : \sz) [blackdot,label=left:\small{$3$}]{};
    \node (r5) at (-90+360.0/7*2.5 : \sz) [blackdot,label=right:\small{$n-2$}]{};
    \node (r6) at (-90+360.0/7*1.5 : \sz) [blackdot,label=right:\small{$n-1$}]{};
    \node (r7) at (-90+360.0/7*0.5 : \sz) [whitedot,label=right:\small{$n$}]{};
    \node (r4) at (-90+360.0/7*3.5 : \sz) [blackdot,label=above:\small{}]{}
      edge[densely dotted, thick, bend right=15] (r3)
      edge[densely dotted, thick, bend left=15] (r5);
    \draw[thick]
          (r4) -- (r1) -- (r2) -- (r3)
          (r5) -- (r6) -- (r7)
          (r6) -- (r4) -- (r7);
    \node (pie) at (0, -\sz-0.2) [anchor=north] {Pie graph};
  \end{tikzpicture}
\]



\begin{lemm}
A pie graph is equivalent to
  a chain of polygon graphs.
\label{thm:pycat}
\end{lemm}

\begin{proof}
In the forward direction, assume the contrary and
%
let $G$ be the smallest pie graph
  that is not a chain of polygon graphs,
%
and $v$ be the last vertex adjacent to $1$ ($2 \le v < n$).
%
The induced subgraph $G^{(1)} = G(\{1, \dots, v\})$
  is clearly a polygon graph.
%
If $v$ and $n$ are adjacent,
  the induced subgraph $G^{(2)} = (\{v, \dots, n\})$
  is also a polygon graph,
  and $G = G^{(1)} * G^{(2)}$ is a chain,
  which is a contradiction.
%
Otherwise, $G^{(2)}$ is a pie graph
  rooted at $v$ and $n$,
  and $G^{(2)}$ is smaller than $G$,
  which is also a contradiction.

The converse is obvious.
%Conversely,
%  let $G=G^{(1)}*\cdots*G^{(l)}$,
%  and $v^{(i)}_j$ be the $j$th vertex of $G^{(i)}$.
%%
%It is readily seen that the ordering
%  $v^{(1)}_1 = 1$,
%  $v^{(1)}_2 = 2$,
%  \dots,
%  $v^{(1)}_{n_1 - 1}$, % = n_1 - 1$,
%  %
%  $v^{(2)}_1 \left( \equiv v^{(1)}_{n_1} \right)$,
%  $v^{(2)}_2$,
%  \dots,
%  $v^{(2)}_{n_2 - 2}$, % = n_1 + n_2 - 2$,
%  %
%  \dots,
%  $v^{(l)}_{n_l}$
%%
%  produces a pie graph.
\end{proof}



\begin{lemm}
Under the PY closure,
  $c(\vr)$ is the unweighted sum of
  all nonequivalent polygon graphs,
  and $t(\vr)$ is that of all nonequivalent pie graphs.
\label{thm:pycrsum}
\end{lemm}

\begin{proof}
We show this by an induction on the number of vertices $n$ in
  graphs included in $c(\vr)$ or $t(\vr)$.
%
The statement obviously holds for $n \le 3$.
%
Suppose it remains so for $n \le k$,
consider the case of $n = k + 1$.

The OZ relation \eqref{eq:oz}
  shows that every graph in $t(\vr)$
  is a chain of smaller polygon graphs,
  hence a pie graph. % by Lemma \ref{thm:pycat}.

The PY closure \eqref{eq:py} generates
  an $n$-vertex graph $G$ in $c(\vr)$
  by adding the edge between the roots
  to some $n$-vertex graph in $t(\vr)$.
%
Thus, $G$ is a polygon graph.

We can similarly show the converse:
  every polygon or pie graph
  can be generated by the closure
  with a unit weight.
\end{proof}




A \emph{polygon pack} $G$ is obtained
  by blackening the two white dots of a polygon graph $H$
  (equivalent to the integration $\rho^2 \int d\vr$).
%
Conversely,
  whitening the two vertices of any side of
  a polygon pack $G$
  yields a polygon graph $H'$,
  and there are $2n$ possible $H'$ with $2$ for each side
%
  (some $H'$, however, may be different from $H$).
%
To satisfy Lemma \ref{thm:pycrsum},
  a nonequivalent polygon pack $G$ must appear $2 \, n/s$ times
  in $\rho^2 \int c(\vr) \, d\vr$,
  where $s$ is the symmetry number, or
  the number of ways of relabelling the vertices
  that keep $G$ unchanged.
%
For example,
%
%
% Examples of the symmetry numbers
%
%
\newcommand{\hh}{0.07}
\begin{equation*}
  s \left( {
    \begin{tikzpicture}[baseline=-1mm]
      \node (r1) at (-4*\hh, -4*\hh) [blackdot]{};
      \node (r2) at ( 4*\hh, -4*\hh) [blackdot]{};
      \node (r3) at ( 4*\hh,  4*\hh) [blackdot]{};
      \node (r4) at (-4*\hh,  4*\hh) [blackdot]{};
      \draw (r1) -- (r2) -- (r3) -- (r4) -- (r1);
    \end{tikzpicture}
    } \right)
  = 8,
  \;\;
  s \left( {
    \begin{tikzpicture}[baseline=-1mm]
      \node (r1) at (-2.3*\hh, -4*\hh) [blackdot]{};
      \node (r2) at (-4.6*\hh,  0.0) [blackdot]{};
      \node (r3) at (-2.3*\hh,  4*\hh) [blackdot]{};
      \node (r4) at ( 2.3*\hh,  4*\hh) [blackdot]{};
      \node (r5) at ( 4.6*\hh,  0.0) [blackdot]{};
      \node (r6) at ( 2.3*\hh, -4*\hh) [blackdot]{};
      \draw (r1) -- (r2) -- (r3) -- (r4) -- (r5) -- (r6) -- (r1)
            (r1) -- (r5) (r1) -- (r4);
    \end{tikzpicture}
    } \right)
  = 1.
\end{equation*}
%
For a polygon graph $G$, $s(G)$ always divides $2n$,
  i.e.,
  the only permissible symmetry operations
  are rotations and reflections,
  and all other operations produce intersecting edges.
%
To summarize
%
%
%
\begin{lemm}
Under the PY-closure,
  $\rho^2 \int c(\vr) \, d\vr$ is a sum of
  all nonequivalent polygon packs $G$:
  %
  \begin{equation}
      \rho^2 \int c(\vr) \, d\vr
    = \sum_{G} \frac{ 2 \, n(G) \, I(G) }{ s(G) }.
  \label{eq:pykappasum}
  \end{equation}
  %
  where $n(G)$, $s(G)$ and $I(G)$ are
  the number of vertices,
  the symmetry number,
  and the integral of $G$,
  respectively.
  \label{thm:pykappasum}
\end{lemm}





\subsection*{Face decomposition of a polygon graph}



%\begin{lemm}
%A polygon graph of three or more vertices
%  is equivalent to
%  a cycle of three or more polygon graphs.
%\label{thm:pycatc}
%\end{lemm}
%
%\begin{proof}
%By removing the edge between the roots,
%  we get a pie graph,
%  which is a chain of polygon graphs
%  by Lemma \ref{thm:pycat}.
%%
%The chain is closed by the edge between the roots,
%  which is also a polygon graph,
%  to form a cycle.
%
%Conversely,
%  we can order the vertices in a manner similar to
%  that in the proof of Lemma \ref{thm:pycat},
%  and show that it produces a polygon graph.
%\end{proof}



A polygon graph or pack
  can always be decomposed as a cycle of small polygon graphs.
%
%removing the edge between the roots in a polygon graph
%  yields a chain of polygon graphs,
%  which can be closed
%  by the edge between the roots
%  to form a cycle.
%
%The cycle decomposition is, however, not unique.
%
Geometrically,
  each face of the polygon corresponds to a cycle decomposition,
%
  as illustrated below.
%
\begin{equation*}
  %
  \newcommand\sz{0.8}
  \newcommand\del{0.1}
  \newcommand\osa{3.5*\sz}
  \newcommand\osb{7*\sz}
  \newcommand\dd{0.2*\sz}
  %
  \begin{tikzpicture}
  %
  % part 1
  %
    \node (r1) at (-90+60.0*5.5 : \sz) [blackdot]{};
    \node (r2) at (-90+60.0*4.5 : \sz) [blackdot]{};
    \node (r3) at (-90+60.0*3.5 : \sz) [blackdot]{};
    \node (r4) at (-90+60.0*2.5 : \sz) [blackdot]{};
    \node (r5) at (-90+60.0*1.5 : \sz) [blackdot]{};
    \node (r6) at (-90+60.0*0.5 : \sz) [blackdot]{};
    \draw[thick] (r1) -- (r2) -- (r3) -- (r4) -- (r5) -- (r6) -- (r1);
    \draw[thick] (r2) -- (r4) (r5) -- (r1);
    \draw[blue!70, thick, dashed]
        (-\sz+\dd, 0) -- (-0.5*\sz+0.5*\dd, -0.866*\sz+0.866*\dd)
     -- ( \sz-\dd, 0) -- ( 0.5*\sz-0.5*\dd,  0.866*\sz-0.866*\dd) -- cycle;
  %
  % part 2
  %
    \node (r1r) at (\osa-0.5*\sz-\del, -0.866*\sz+.4*\del) [whitedot]{};
    \node (r2r) at (\osa-1.0*\sz, -\del) [whitedot]{};
    \draw[thick] (r1r) -- (r2r);

    \node (r4r) at (\osa+0.5*\sz+\del,  0.866*\sz-.4*\del) [whitedot]{};
    \node (r5r) at (\osa+1.0*\sz,  \del) [whitedot]{};
    \draw[thick] (r4r) -- (r5r);

    \node (r2p) at (\osa-1.0*\sz,  \del) [whitedot]{};
    \node (r3p) at (\osa-0.5*\sz,  0.866*\sz) [blackdot]{};
    \node (r4p) at (\osa+0.5*\sz-\del,  0.866*\sz) [whitedot]{};
    \draw[thick] (r2p) -- (r3p) -- (r4p) -- (r2p);

    \node (r5q) at (\osa+1.0*\sz, -\del) [whitedot]{};
    \node (r6q) at (\osa+0.5*\sz, -0.866*\sz) [blackdot]{};
    \node (r1q) at (\osa-0.5*\sz+\del, -0.866*\sz) [whitedot]{};
    \draw[thick] (r5q) -- (r6q) -- (r1q) -- (r5q);

    \draw[->,very thick] (1.2*\sz, 0) to (\osa-1.2*\sz, 0);
  \end{tikzpicture}
  %
\end{equation*}



If $G$ has $m(G)$ faces, then by counting the vertices, we get
%
\begin{equation}
  n(G) = 2 + \sum_{a = 1}^{m(G)} (l_a - 2)
       = 2 + \sum_{l = 3}^\infty (l - 2) \, m_l(G),
\label{eq:countvertices}
\end{equation}
%
where
  $l_a$ is the number of vertices in face $a$,
%
and
  $m_l(G)$ is the number of faces of $l$ vertices in $G$.
%
Similarly, the number of ordered intra-face vertex pairs
  $p(G)$ satisfies
%
\begin{align}
  p(G)  &= 2 + \sum_{a} \left[ l_a (l_a - 1) - 2 \right]
                        \notag \\
        &= 2 + \sum_{l = 3}^\infty m_l(G) \, [l(l-1) - 2],
\label{eq:countpairs}
\end{align}
%
where $l_a (l_a - 1)$ gives the number of pairs in face $a$,
  and the ``$-2$'' % in the square brackets
  offsets the double-counting
  for each edge shared by two adjacent faces.






Using \eqref{eq:countvertices} in \eqref{eq:pykappasum} yields
%
\begin{equation}
    \rho^2 \int c(\vr) \, d\vr
  = \sum_G \frac{ 4 \, I(G) }{ s(G) }
  + \sum_{l = 3}^\infty 2 (l - 2) \, C_l,
\label{eq:pyintgcr2sums}
\end{equation}
%
where $C_l$ is the cycle sum:
%
\begin{align}
      C_l
  =  \sum_G \frac{ m_l(G) \, I(G) } { s(G) }
%      \notag \\
  &=  \frac{1}{2 \, l}
      \int \rho^l (\underbrace{c*\cdots *c}_{l-1 \mbox{ times}})(\vr)
                        \, c(\vr) \, d\vr
      \notag \\
  &=  \frac{1}{2 \, l}
      \int \rho^l \tilde{c}^l(\vk) \dvk,
\label{eq:ccyclintg}
\end{align}
%
where the factor $2 \, l$ corresponds to the number of ways
  of cycling and reversing the elements in the $l$ cycle
  [also cf. \eqref{eq:cyclesp}].
%
Summing \eqref{eq:ccyclintg} over $l$ yields
%
\begin{align}
     \sum_{l=3}^{\infty} 2 \, C_l
  &= -\int \Big\{
              \log[ 1 - \rho \tilde{c}(\vk) ]
            + \rho \tilde{c}(\vk)
           \Big\}\, \dvk \notag \\
  & \hphantom{=}
     - \frac{\rho^2}{2} \int c^2(\vr) \, d\vr,
     \label{eq:Clsum} \\
  %
      \sum_{l=3}^{\infty} \, l \, C_l
  &=
      \frac{ \rho^2 }{2} \int t(\vr) \, c(\vr) \, d\vr,
      \label{eq:Clsuml} \\
  %
      \sum_{l=3}^{\infty} \, l \, (l - 3) \, C_l
  &=  \frac{ \rho^2 }{ 2 }
      \int t^2(\vr) \, d\vr,
\label{eq:Clsumll}
\end{align}
%
Note that \eqref{eq:Clsum}, \eqref{eq:Clsuml}, and \eqref{eq:Clsumll}
  are applicable to any integral equation (not just the PY one).




\subsection*{Thermodynamic quantities}


%We now derive Baxter's pressure formula
%\cite{baxterpressure}.
%
To obtain an expression of pressure,
  we start with\cite{hansen}
%
\begin{equation}
  -\partial (\beta P^{\mathrm{ex}}) / \partial \rho
  = \rho \int c(\vr) \, d\vr,
\label{eq:crcompr}
\end{equation}
%
where the superscript ``ex'' means to the excess, or non-ideal-gas, part of the contribution.
%
Note that
  the integral $I(G)$ of a polygon pack $G$ of $n$ vertices
  in \eqref{eq:pykappasum}
  is proportional to $\rho^n$.
%
Thus, an integration over $\rho$ yields\cite{baxterpressure}
%
\begin{align}
      -\beta \Pex
  =&  \sum_{G} \frac{ 2 \, I(G) }{ s(G) }
  =   \frac{ \rho^2 }{ 2 }
      \int [c(\vr) - h(\vr) c(\vr)] \, d\vr \notag \\
  &
      -\int \{ \log[1 - \rho \tilde{c}(\vk)] + \rho \tilde{c}(\vk) \} \dvk.
\label{eq:baxterpressure}
\end{align}
%
where we have used
\eqref{eq:pyintgcr2sums}, \eqref{eq:Clsum} and \eqref{eq:Clsuml}.


Similarly,
  by differentiating \eqref{eq:pykappasum} with respect to $\rho$,
  and assuming $p(G) \approx n(G) \, [n(G) - 1]$,
  we get
%
\begin{align}
           -\frac{\rho^2}{2}
            \frac{\partial^2 ( \beta \Pex ) }
                 {\partial \rho^2}
  &\approx   \sum_G \frac{ p(G) \, I(G) }{ s(G) }
    \notag \\
  &=
            \sum_G \frac{2 I(G) }{s(G)}
            + \sum_{l = 3}^\infty [l(l-1) - 2] \, C_l
    \notag \\
  &=         \frac{\rho^2}{2} \int [c(\vr) + t(\vr) \, h(\vr) ] \, d\vr,
\label{eq:pyddpressure}
\end{align}
%
where we have use \eqref{eq:countpairs}, \eqref{eq:Clsuml}, and \eqref{eq:Clsumll}.
%
Note that this relation is approximate
  and contains an error
  similar to that in the HNC approximation.





\section{\label{sec:hnc}HNC approximation}



The HNC closure includes
  more graphs than the PY closure.
%
For example, $c(\vr)$ contains
%
\begin{equation}
  \renewcommand{\hh}{0.22cm}
  \begin{tikzpicture}[baseline=1.2mm]
    \node (r1) at (-2.0*\hh,  2*\hh) [whitedot]{};
    \node (r2) at (   0,      4*\hh) [blackdot]{};
    \node (r5) at (   0,      0*\hh) [blackdot]{};
    \node (r6) at ( 2.0*\hh,  2*\hh) [whitedot]{};
    \draw[thick]
          (r1) -- (r2) -- (r6)
          (r1) -- (r5) -- (r6);
  \end{tikzpicture},
  %
  \;\;
  %
  \begin{tikzpicture}[baseline=1.2mm]
    \node (r1) at (-2.0*\hh,  1*\hh) [whitedot]{};
    \node (r2) at (   0,      4*\hh) [blackdot]{};
    \node (r3) at (   0,      2*\hh) [blackdot]{};
    \node (r5) at (   0,      0*\hh) [blackdot]{};
    \node (r6) at ( 2.0*\hh,  1*\hh) [whitedot]{};
    \draw[thick]
          (r1) -- (r2) -- (r6)
          (r1) -- (r3) -- (r6)
          (r1) -- (r5) -- (r6);
  \end{tikzpicture},
  %
  \;\;
  %
  \begin{tikzpicture}[baseline=1.2mm]
    \node (r1) at (-2.0*\hh,  2*\hh) [whitedot]{};
    \node (r2) at (   0,      4*\hh) [blackdot]{};
    \node (r3) at (   0,      3*\hh) [blackdot]{};
    \node (r4) at (   0,      1*\hh) [blackdot]{};
    \node (r5) at (   0,      0*\hh) [blackdot]{};
    \node (r6) at ( 2.0*\hh,  2*\hh) [whitedot]{};
    \draw[thick] (r1) -- (r6)
          (r1) -- (r2) -- (r6)
          (r1) -- (r3) -- (r6)
          (r1) -- (r4) -- (r6)
          (r1) -- (r5) -- (r6);
  \end{tikzpicture},
  %
  \;\;\mbox{and}\;\;
  %
  \begin{tikzpicture}[baseline=1.2mm]
    \node (r1) at (-1.2*\hh,  0) [whitedot]{};
    \node (r2) at (-2.8*\hh,  2.6*\hh) [blackdot]{};
    \node (r3) at (-1.8*\hh,  2.2*\hh) [blackdot]{};
    \node (r4) at (   0,      4*\hh) [blackdot]{};
    \node (r5) at ( 1.8*\hh,  2.2*\hh) [blackdot]{};
    \node (r6) at ( 2.8*\hh,  2.6*\hh) [blackdot]{};
    \node (r7) at ( 1.2*\hh,  0) [whitedot]{};
    \draw[thick] (r1) -- (r7)
                 (r1) -- (r2) (r1) -- (r3) (r1) -- (r4)
                 (r4) -- (r2) (r4) -- (r3)
                 (r4) -- (r5) (r4) -- (r6)
                 (r7) -- (r5) (r7) -- (r6);
  \end{tikzpicture},
  \label{eq:hnccrex}
\end{equation}
%
%
%
but not
%
%
%
\begin{equation}
  \renewcommand{\hh}{0.22cm}
  \begin{tikzpicture}[baseline=1.2mm]
    \node (r1) at (-2*\hh,  2*\hh) [whitedot]{};
    \node (r2) at (0*\hh,   0*\hh) [blackdot]{};
    \node (r3) at (0*\hh,   4*\hh) [blackdot]{};
    \node (r4) at ( 2*\hh,  2*\hh) [whitedot]{};
    \draw[thick] (r1) -- (r2) -- (r4) -- (r3) -- (r1)
                 (r2) -- (r3);
  \end{tikzpicture}
  \;\;\mbox{and}\;\;
  \begin{tikzpicture}[baseline=1.2mm]
    \node (r1) at (-2*\hh,  2*\hh) [whitedot]{};
    \node (r2) at (0*\hh,   0*\hh) [blackdot]{};
    \node (r3) at (0*\hh,   4*\hh) [blackdot]{};
    \node (r4) at ( 2*\hh,  2*\hh) [whitedot]{};
    \draw[thick] (r1) -- (r2) -- (r4) -- (r3) -- (r1)
                 (r2) -- (r3) (r1) -- (r4);
  \end{tikzpicture}.
  \label{eq:hnccrexnot}
\end{equation}
%
We use the following recursive definition
  to characterize them.
%
A \emph{$c$-graph} is either
%
1) an $f$-graph,
or
%
2) a cycle of three or more
  smaller $c$-graphs,
  with the roots being any two joints.
%
One can verify that the above definition
  includes all graphs in \eqref{eq:hnccrex},
  but none in \eqref{eq:hnccrexnot}.
%

Further, we define a \emph{$c$-chain}
  as a chain of $c$-graphs.
%
Then, similar to Lemma \ref{thm:pycrsum},
  we have

\begin{lemm}
Under the HNC closure,
%
$c(\vr)$
  is the sum of all nonequivalent $c$-graphs $G$
  each weighted by $1/s(G)$,
  where $s(G)$ is the number of ways of relabelling
  \emph{black} vertices that keep $G$ unchanged;
%
and $t(\vr)$ is the corresponding sum of all
  $c$-chains $H$, each weighted by $1/s(H)$.
\end{lemm}
%
\begin{proof}
%
We carry an induction on the number of vertices $n$.
%
The statement is true for $n \le 3$.
%
Suppose it is true for $n \le k$,
  we prove the $n = k + 1$ case below.

According to the OZ relation \eqref{eq:oz},
  every graph $H$ in $t(\vr)$ is
  a $c$-chain $G_1 * \cdots * G_l$.
%
Since the relabelling of the black vertices of $H$
  can occur only within each $G_i$ independently,
  the symmetry number is
  $s(H) = s(G_1) \cdots s(G_l)$,
  which is indeed the inverse weight of $H$
  given by \eqref{eq:oz}.

We now turn to $c(\vr)$.
%
Under the HNC closure \eqref{eq:hnc},
  an $n$-vertex graph $G$ in $c(\vr)$ is
  a parallel composition of
  $m$ $c$-chains $H_1$, \dots, $H_m$,
  and possibly also an $f$-graph,
  i.e., $G = H_1 \cdots H_m (\cdot f)$,
  if it is generated by the term
  $\big\{\llbra m \ge 2 \llket + f(\vr)\big\} \, t^m(\vr) / m!$
%
Let us first show that $G$ is a $c$-graph.
%
If $m \le 2$,
  $G$ is a cycle of $c$-graphs,
  hence a $c$-graph.
%
Otherwise,
  $G$ is a parallel composition of $H_m$
  and the graph
  $G' = H_1 \cdots H_{m-1} (\cdot f)$.
%
We can then show that $G$ is a $c$-graph by an induction on $m$.



We now show the converse:
  every $c$-graph $G$ can be generated by the closure.
%
By definition, $G$ is a cycle of $c$-graphs.
%
If the two roots are not consecutive joints of the cycle,
  then $G$ can be generated by the term $t^2(\vr)/2$.
%
Otherwise, $G$ can be written as a cycle
  $v_1 - \cdots - v_l - v_1$
  rooted at the two consecutive joints $v_1$ and $v_l$
  ($l \ge 3$),
%
or, equivalently, $G = G_l \cdot H_m$,
  with
    $G_l$ being the $c$-graph between $v_1$ and $v_l$,
  and
    $H_m \equiv v_1 - \cdots - v_l$.
%
By the induction hypothesis,
  $G_l$ can be generated by the term
  $\big\{ \llbra m \ge 3 \llket +f(\vr) \big\} t^{m - 1}(\vr) / (m - 1)!$
  of some $m$,
whereas
  the $H_m$ can be generated by $t(\vr)$.
%
It follows that
  $G$ can be generated by the term
  $\big\{ \llbra m \ge 2 \llket  + f(\vr)\big\} t^{m}(\vr) / m! $,
%



Now for the weight.
%
Suppose $G$ is generated by
  a parallel composition $G = H_1 \cdots H_m (\cdot f)$,
%
we sort the $m$ chains as \\
  \hphantom{~~~~}
    $m_1$ identical chains of type 1, \\
  \hphantom{~~~~}
    \dots, \\
  \hphantom{~~~~}
    $m_t$ identical chains of type $t$, \\
  with
    $m = m_1 + \cdots + m_t$.
%
The symmetry number is
  $s(G) = m_1! \cdots m_t! \, s(H_1) \cdots s(H_m)$,
  for there are $m_r!$ ways of
  permuting the chains of the same type $r$,
  and collectively relabelling the vertices within accordingly.
%
On the other hand,
  the number of times of $G$
  appearing in expansion of $t^m(\vr)$
  is equal to the number of ways
  of assigning the types to the $m$ chains,
  which can be computed from the multinomial coefficients
  $m!/(m_1! \cdots m_t!)$.
%
So the overall weight of $G$ is
%
\[
  \frac{ m! } { m_1! \cdots m_t! }
  \times
  \frac{ 1 } { m! }
  \frac{ 1 } { s(H_1) \cdots s(H_m) },
\]
%
which is indeed the inverse of $s(G)$.
\end{proof}





We call a $c$-graph without the marked roots a \emph{$c$-pack},
%
in which,
  an ordered pair of vertices forms a \emph{pivot}
  if marking them as the roots renders the $c$-pack to some $c$-graph.
%
For example,
  \begin{tikzpicture}[baseline=1.0mm]
    \node (r1) at (-2mm, 0) [blackdot,label=left:{\footnotesize$1$}]{};
    \node (r2) at ( 2mm, 0) [blackdot,label=right:{\footnotesize$2$}]{};
    \node (r3) at ( 2mm, 4mm) [blackdot,label=right:{\footnotesize$3$}]{};
    \node (r4) at (-2mm, 4mm) [blackdot,label=left:{\footnotesize$4$}]{};
    \draw (r1) -- (r2) -- (r3) -- (r4) -- (r1) (r1) -- (r3);
  \end{tikzpicture}
is a $c$-pack,
  $(1, 2)$ and $(1, 3)$ are pivots,
  but $(2, 4)$ is not.
%
Following an argument similar to the one leading to Lemma \ref{thm:pykappasum},
  we have

\begin{lemm}
Under the HNC closure,
%
$\rho^2 \int c(\vr) \, d\vr$
  is the sum of all nonequivalent $c$-packs $G$:
%
\begin{equation}
    \rho^2 \int c(\vr) \, d\vr
  = \sum_G \frac{ p(G) \, I(G) }{ s(G) },
  \label{eq:hnccrsum}
\end{equation}
%
where $p(G)$ and $s(G)$ are
  the number of pivots and
  the symmetry number
  of $G$,
  respectively.
\label{thm:hnccrsum}
\end{lemm}





\subsection*{Cycle decomposition}



We now generalize the face decomposition in the PY case
  to a cycle decomposition for the HNC case,
  which helps adapting the counting formulas
  \eqref{eq:countvertices} and \eqref{eq:countpairs}.


First, a cycle of $l$ ($l \ge 3$) $c$-graphs
  is \emph{simple}
  in which at least $(l-1)$ of the $c$-graphs are $f$-graphs.
%
We now show that
%
%
%
\begin{lemm}
There is at least one simple cycle
  in a $c$-pack $G$ of three or more vertices.
\end{lemm}
%
%
%
\begin{proof}
%
We prove this by giving an algorithm, \textbf{Algorithm L},
  for finding a simple cycle of $G$.
%
By definition,
  $G$ has at least one pivot $(v_1, v_{k})$,
  and can be decomposed to a cycle of $c$-graphs
  $K = v_1 - \cdots - v_k - \cdots - v_l - v_1 (\equiv v_{l+1})$,
  with $v_j$ being the $j$th joint.

If $K$ is simple, there is nothing to prove.
%
Otherwise,
  there is a $c$-graph $G_j$ between $v_j$ and $v_{j+1}$ in $K$
  that is not an $f$-graph,
%
  and thus can be decomposed to
  a cycle $J'$ (as shown below, blue) of $c$-graphs
  passing through $v'_1 \equiv v_j$
  and $v'_{k'} \equiv v_{j+1}$:
%
  $J' = v'_1 - v'_2 - \cdots - v'_{k'-1}
      - v'_{k'} - v'_{k'+1} - \cdots
      - v'_{l'} - v'_1$.
%
Without loss of generality,
  we can assume that
  the branch $v'_1, v'_2, \dots, v'_{k'}$
  contains at least three vertices,
  i.e., $k' \ge 3$.
%
Now $J = v'_1 (=v_j) - v'_{l'} - \cdots - v'_{k'+1} - v'_{k'} (= v_{j+1}) \
       - v_{j+2} - \cdots - v_l - v_1 - \cdots - v'_1$
  is also a cycle of $c$-graphs (red),
  and thus can be reduced to a $c$-graph
  rooted at $v'_1$ and $v'_{k'}$.
%
Thus, $G$ can be decomposed to a different cycle
  $K' = v'_1 - v'_2 - \cdots - v'_{k'} - v'_1$
  (green).
%
\[
  \newcommand{\sz}{4mm}
  \begin{tikzpicture}
    \node (v1)  at ( 0, 0) [blackdot,label=left:$v_1$]{};
    \node (v2)  at ( 0.2*\sz, 1.5*\sz) [blackdot,label=left:$v_2$]{}
      edge[thick, bend right=10] (v1);
    \node (vj)  at ( 2.0*\sz, 3.5*\sz) [blackdot,label=left:$v_j(v'_1)$]{}
      edge[dotted, thick, bend right=15] (v2);
    \node (vkm1) at (10.8*\sz, 1.5*\sz) [blackdot,label=right:$v_{k-1}$]{};
    \node (vj1) at ( 9.0*\sz, 3.5*\sz) [blackdot,label=right:$v_{j+1}(v'_{k'})$]{}
      edge[dotted, thick, bend left=15] (vkm1);
    \node (vk)  at (11.0*\sz, 0)       [blackdot,label=right:$v_{k}$]{}
      edge[thick, bend right=10] (vkm1);

    % beginning the inner J' simple cycle
    \node (u2) at ( 3.5*\sz, 6.0*\sz)
      [blackdot,blue,label={[label distance=-1mm]160:$v'_2$}]{}
      edge[blue, thick, bend right=30] (vj);
    \node (ukm1) at ( 7.5*\sz, 6.0*\sz)
      [blackdot,blue,label={[label distance=-1mm]20:$v'_{k'-1}$}]{}
      edge[blue, thick, bend left=30] (vj1)
      edge[blue, dotted, thick, bend right=10] (u2);
    \node (uk1) at ( 7.5*\sz, 1.5*\sz) [blackdot,blue,label=above:$v'_{k'+1}$]{}
      edge[blue, thick, bend right=30] (vj1);
    \node (ul) at  ( 3.5*\sz, 1.5*\sz) [blackdot,blue,label=above:$v'_{l'}$]{}
      edge[blue, thick, bend left=30] (vj)
      edge[blue, dotted, thick, bend right=10] (uk1);

    \node (Jp) at ( 9.5*\sz, 5.5*\sz) [blue] {$J'$};
    % end of the inner J' simple cycle

    % beginning of the K' simple cycle
    \draw[green!50!black, thick] plot [smooth cycle]
      coordinates{ ( 2.5*\sz, 3.9*\sz)
                   ( 3.5*\sz, 5.7*\sz)
                   ( 7.5*\sz, 5.7*\sz)
                   ( 8.5*\sz, 3.9*\sz) };

    \node (Kp) at ( 5.5*\sz, 5.0*\sz) [green!50!black] {$K'$};
    % end of the K' simple cycle

    \node (vb)  at ( 5.5*\sz,-1.9*\sz) [blackdot]{};

    \node (vk1) at ( 9.5*\sz,-1.2*\sz) [blackdot,label=below:$v_{k+1}$]{}
      edge[dotted, thick, bend left=7] (vb)
      edge[thick, bend right=20] (vk);

    \node (vl)  at ( 1.5*\sz,-1.2*\sz) [blackdot,label=below:$v_{l}$]{}
      edge[dotted, thick, bend right=7] (vb)
      edge[thick, bend left=20] (v1);

    \draw[dashed, very thick] (vj) -- (vj1);
    \node (K) at (11.0*\sz, -1.2*\sz) {$K$};

    % beginning of the J simple
    \draw[red!80!black, thick] plot [smooth cycle]
        coordinates{ ( 1.5*\sz, 2.5*\sz)
                     ( 0.7*\sz, 0.2*\sz)
                     ( 3.5*\sz,-1.2*\sz)
                     ( 7.5*\sz,-1.2*\sz)
                     (10.3*\sz, 0.2*\sz)
                     ( 9.5*\sz, 2.5*\sz)
                     ( 8.0*\sz, 1.2*\sz)
                     ( 5.5*\sz, 0.8*\sz)
                     ( 3.0*\sz, 1.2*\sz)
                   };
    \node (J) at ( 5.5*\sz, -0.2*\sz) [red!80!black] {$J$};
    % end of the J simple cycle

  \end{tikzpicture}
\]

If $K'$ is simple, we are done.
%
Otherwise,
  we replace the $c$-graph between $v'_1$ and $v'_{k'}$ in $K'$
  by an $f$-graph.
%
On the simplified graph $G'$,
  we can apply the above step
  to any link $v'_{j'} - v'_{j'+1}$ of $K'$
  that is not an $f$-graph.
%
One can readily show that
  the above replacement removes more edges than vertices,
%
such that the process always ends with a $G'$
  with equal numbers of vertices and edges.
\end{proof}



Algorithm L in above proof allows us to
  decompose a $c$-pack as simple cycles as follows.

\textbf{Algorithm D:}
\begin{enumerate}
  \item
    Given a $c$-pack $G$,
      repeat steps 2 and 3 until $G$ is an $f$-graph.
  \item
    Find a simple cycle in $G$,
      $v_1 - v_2 - \cdots - v_l - v_1$
      using Algorithm L,
      such that the $c$-graphs between $v_j$ and $v_{j+1}$
      are $f$-graphs $j = 1, \dots, l-1$.
  \item
    Remove $v_2, v_3, \dots, v_{l-1}$,
      and join $v_1$ and $v_l$ if they are not adjacent.
\end{enumerate}
%
It is readily shown that,
  Step 3 results in a new $c$-pack $G$
  with $(l - 2)$ fewer vertices,
  and it always ends up with an $f$-graph.
%
Thus,


\begin{lemm}
  A $c$-pack $G$ can be reduced
    by Algorithm D to an $f$-graph in $m(G)$ steps,
    where $m(G)$ is the number of ways of decomposing
    $G$ as a cycle of $c$-graphs,
    which is independent of the order of the vertex elimination
    in Algorithm D.
\label{thm:hncdecomp}
\end{lemm}


\begin{proof}
Let $J = u_1 - u_2 - \dots - u_j - u_1 (\equiv u_{j+1})$
  be a cycle that decomposes the original $c$-pack $G$,
%
and $L^{(s)} = v_1 - v_2 - \dots - v_l - v_1$
  be the simple cycle discovered
  in the $s$th round of Algorithm D.
%
We will show below that
  either
  (a) the vertices in $V_L = \{ v_2, \dots, v_{l-1} \}$
    are entirely contained in
    a $c$-graph between $u_i$ and $u_{i+1}$ for some $i$,
  or
  (b) $L^{(s)} = J$.
%
Since case (a) leaves $J$ intact,
  every cycle $J$ is discovered (and then eliminated)
  only in case (b),
  and the lemma follows.
%

If (a) is not true,
  there is at least one joint $u_i$ of $J$
  that belongs to $V_L$
  [for the vertices in $V_L$ are connected in $G^{(s)}$].
%
Consider now the $c$-pack $G^{(s)}$
  in Step 2 of the $s$th round of Algorithm D.
%
Since every vertex in $V_L$ is adjacent to only two vertices,
  the $c$-graph between $u_{i-1}$ and $u_i$
  and that between $u_i$ and $u_{i+1}$
  must both be $f$-graphs,
%
and $u_{i-1}$ and $u_{i+1}$ are the only two vertices
  adjacent to $u_i$ in $G^{(s)}$.
%
Now since the vertices in $V_L$ are connected,
  either $u_i$ is the only vertex in $V_L$,
  or $V_L$ contains at least one of $u_{i-1}$ and $u_{i+1}$.
%
Repeating the above argument shows that
  all the joints $v_1$, \dots $v_l$ of $L^{(s)}$
  are also consecutive joints of $J$.
%
This is possible only if the two cycles are the same,
  which is case (b).
\end{proof}




\subsection*{Thermodynamic quantities}


Given a $c$-pack $G$,
  Lemma \ref{thm:hncdecomp} allows us
  to order all cycles that decompose $G$
  according to the simple cycles
  discovered in Algorithm L.
%
Counting vertices and vertex pairs
  are readily established on the simple cycles.
%
First, each step of Algorithm L removes $(l - 2)$ vertices,
  with $l$ being the length of the simple cycle.
%
Thus, the total number of vertices $n(G)$
  is still given by \eqref{eq:countvertices},
  with $m_l(G)$ interpreted as
  the number of ways
  of decomposing $G$ as length-$l$ cycles.

A cycle of length $l$, by definition,
  contains $l (l - 1)$ pivots,
  and Step 3 of Algorithm D
  removes all but two of them.
%
Thus, \eqref{eq:countpairs}
  is also applicable, with $p(G)$ interpreted
  as the number of pivots of $G$.



The free energy can be computed
  as follows\cite{morita1958, *morita1959, *morita1960, singer1985}
%
\begin{align}
    - \frac{ 2 \beta \Fex } { V }
  &=
      \sum_G \frac{ 2 \, I(G) } { s(G) }
      \notag \\
  &=
      \rho^2 \int c(\vr) \, d\vr
    - \sum_{l = 3}^\infty \left[ l(l-1) - 2 \right] \, C_l
      \notag \\
  &=
      \rho^2 \int \left[ c(\vr) - \tfrac{1}{2} h^2(\vr) \right] \, d\vr
      \notag \\
  & \hphantom{=}
    - \int  \Big\{
              \log\left[ 1 - \rho \, \tilde{c}(\vk) \right]
                           + \rho \, \tilde{c}(\vk)
            \Big\}  \dvk,
\label{eq:hncF}
\end{align}
%
where,
  on the second line,
  we have used \eqref{eq:hnccrsum} and \eqref{eq:countpairs},
  and on the next lines,
  we have used \eqref{eq:Clsum}-\eqref{eq:Clsumll}.
%
Similarly, the chemical potential
  is given by\cite{morita1958, *morita1959, *morita1960, singer1985}
%
\begin{align}
    - \beta \muex
  &=
      \sum_G \frac{ n(G) \, I(G) } { s(G) }
  =
      \sum_G \frac{ 2 \, I(G) } { s(G) }
    + \sum_{l = 3}^\infty (l-2) \, C_l
      \notag \\
  &=
      \rho^2 \int c(\vr) \, d\vr
    - \sum_{l = 3}^\infty l \, (l-2) \, C_l
      \notag \\
  &=
      \rho^2 \int \left[ c(\vr) - \tfrac{1}{2} h(\vr) \, t(\vr) \right] \, d\vr.
\label{eq:hncmu}
\end{align}
%
Table \ref{tab:thermodyn} gives
  a comparison of the results from the PY and HNC closures.



\bibliography{ievir}
\end{document}

